import{e as x,s as E,o as l,g as o,j as i,v as p,m as s,q,H as T,I as ee,t as k,F as V,n as re,k as n,f as ae,l as te,G as le}from"./vue.esm-bundler-9f66a517.js";import{T as oe}from"./form-input-03ca1ad2.js";import{P as se}from"./progress-bar-bb6f1d31.js";import{r as ne,x as ie,d as ue}from"./icons-f79f8569.js";import{_ as de}from"./_plugin-vue_export-helper-c27b6911.js";const _=x({emits:{"update:modelValue":e=>!0,change:e=>!0,error:(e,r)=>!0,input:e=>!0,retry:e=>!0,previewFile:e=>!0},props:{allowClear:{required:!1,type:Boolean},disabled:{required:!1,type:Boolean},errorMessage:{required:!1,type:[String,Function]},format:{required:!0,type:Object},helperText:{required:!1,type:String},isError:{required:!1,type:Boolean},label:{required:!1,type:String},maxSize:{required:!1,type:Number},modelValue:{required:!1,type:Object},multi:{required:!1,type:Boolean},onDragText:{required:!1,type:String},readOnly:{required:!1,type:Boolean},required:{required:!1,type:Boolean},uploadState:{required:!1,type:Object},value:{required:!1,type:Object},viewFile:{required:!1,type:Boolean}},name:"sb-form-file-input",components:{"sb-input":oe,"sb-progress-bar":se},data(){return{icon:{onClick:null,onMouseLeave:null,onMouseOver:null,placement:"append"},iconSVG:null,localValue:this.modelValue||this.value||null,onDragOver:!1,onDragTimeout:null}},computed:{getFormatString(){return this.format.join(", ")},getIcon(){var e;if(this.localValue&&this.localValue.length>0){if(((e=this.uploadState)==null?void 0:e.status)==="ERROR")return ne();if(this.allowClear)return ie()}return ue()},getHumanFormats(){return this.format.map(e=>`*${e||""}`).join(", ")},getOnDragText(){return this.onDragText?this.onDragText:"Drag and drop your files here"},getProgressColor(){var e,r;if(((e=this.uploadState)==null?void 0:e.status)==="ERROR")return"danger";if(((r=this.uploadState)==null?void 0:r.status)==="SUCCESS")return"success"},isUploadVisible(){var e;return this.uploadState&&((e=this.uploadState)==null?void 0:e.status)!=="IDLE"}},methods:{doValidateFiles(e){const r=e||this.localValue;if(this.isFormatValid(r)){if(this.maxSize&&!this.isSizeValid(r))return this.$emit("error","INVALID SIZE"),!1}else return this.$emit("error","INVALID FORMAT",this.getHumanFormats),!1;return!0},handleClear(e,r){if(!this.readOnly&&!this.disabled){e.stopPropagation();const a=[...this.localValue];a.splice(r,1),a.length<1&&(this.$refs["input-file"].value=null),this.handleUpdateModelValue([...a])}},handleClickIcon(e){var r;e.stopPropagation(),!this.readOnly&&!this.disabled&&(this.allowClear&&this.localValue&&this.localValue.length>0?((r=this.uploadState)==null?void 0:r.status)==="ERROR"?this.$emit("retry",this.localValue):(this.$refs["input-file"].value=null,this.handleUpdateModelValue(null)):this.handleOpenInput())},handleDragEnter(){this.onDragOver=!0,this.onDragTimeout&&clearTimeout(this.onDragTimeout)},handleDragLeave(){this.onDragTimeout=setTimeout(()=>{this.onDragOver=!1},50)},handleDropFile(e){var r;if(this.handleDragLeave(),(r=e.dataTransfer)!=null&&r.files){const a=e.dataTransfer.files;if(this.doValidateFiles(a))return this.multi?this.handleUpdateModelValue([...this.localValue||[],...a]):this.handleUpdateModelValue([...a])}},handleOpenInput(){var e;!this.disabled&&!this.readOnly&&((e=this.uploadState)==null?void 0:e.status)!=="UPLOADING"&&this.$refs["input-file"].click()},handleSelectFile(e){var r;if((r=e.target)!=null&&r.value){const a=e.target.files;if(this.doValidateFiles(a))return this.multi?this.handleUpdateModelValue([...this.localValue||[],...a||[]]):this.handleUpdateModelValue([...a])}return this.handleUpdateModelValue(null)},handleUpdateModelValue(e){this.localValue=[...e||[]],this.$nextTick(()=>{this.$emit("update:modelValue",this.localValue),this.$emit("change",this.localValue),this.$emit("input",this.localValue)})},handleView(e,r){e.stopPropagation();const a=this.localValue[typeof r<"u"?r:0];this.$emit("previewFile",{file:a,type:a.type})},isFormatValid(e){return[...e].every(u=>{const b=u.name.split(".").pop();return b?this.format.indexOf(`.${b}`)>-1:!0})},isSizeValid(e){return[...e].every(u=>this.maxSize?+`${this.maxSize}000000`>u.size:!0)}},mounted(){this.icon.onClick=this.handleClickIcon,["dragenter","dragover","dragleave","drop"].forEach(r=>{document.body.addEventListener(r,a=>a.preventDefault())})},unmounted(){["dragenter","dragover","dragleave","drop"].forEach(r=>{document.body.removeEventListener(r,a=>a.preventDefault())})},watch:{localValue:{deep:!0,handler(){this.iconSVG=this.getIcon},immediate:!0},modelValue:{deep:!0,handler(e){e!=null&&e.length?this.localValue=[...e]:this.localValue=null}},uploadState:{deep:!0,handler(e){e&&((e==null?void 0:e.status)==="ERROR"||(e==null?void 0:e.status)==="SUCCESS")&&(this.iconSVG=this.getIcon)},immediate:!0},value:{deep:!0,handler(e){e!=null&&e.length?this.localValue=[...e]:this.localValue=null}}}});const pe={key:0,class:"drag-overlay"},me={class:"text"},ce={key:1,class:"helper-text"},ge={class:"input-group"},he=["accept"],fe={key:1,class:"value-wrapper"},ye=["onClick"],ve=["onClick"],be=["onClick"],Se={key:0,class:"upload-progress-percentage"};function Ve(e,r,a,u,J,b){var F,D,O,I,C;const Q=E("sb-input"),X=E("sb-progress-bar");return l(),o("div",{class:re(["file-input-wrapper",{"on-drag":e.onDragOver,"upload-error":((F=e.uploadState)==null?void 0:F.status)==="ERROR",uploaded:((D=e.uploadState)==null?void 0:D.status)==="SUCCESS",uploading:e.isUploadVisible}]),onDragenter:r[4]||(r[4]=n((...t)=>e.handleDragEnter&&e.handleDragEnter(...t),["prevent"])),onDragleave:r[5]||(r[5]=n((...t)=>e.handleDragLeave&&e.handleDragLeave(...t),["prevent"])),onDragover:r[6]||(r[6]=n((...t)=>e.handleDragEnter&&e.handleDragEnter(...t),["prevent"])),onDrop:r[7]||(r[7]=n((...t)=>e.handleDropFile&&e.handleDropFile(...t),["prevent"])),onInput:()=>!1,onBlur:()=>!1},[e.onDragOver?(l(),o("div",pe,[i("div",me,p(e.getOnDragText),1)])):s("",!0),e.helperText?(l(),o("label",ce,p(e.helperText),1)):s("",!0),i("div",ge,[i("input",q({accept:e.getFormatString,ref:"input-file",type:"file"},{multiple:e.multi},{onChange:r[0]||(r[0]=t=>e.handleSelectFile(t)),onInput:()=>!1,onBlur:()=>!1}),null,16,he),T(Q,q({class:{multi:e.multi},errorMessage:e.errorMessage,icon:e.icon,isError:e.isError,label:e.label},{disabled:e.disabled,readOnly:e.readOnly,required:e.required,...!e.readOnly&&!e.disabled&&{icon:e.icon}},{modelValue:e.localValue,"onUpdate:modelValue":r[2]||(r[2]=t=>e.localValue=t),onClick:r[3]||(r[3]=()=>e.handleOpenInput()),onInput:()=>!1,onBlur:()=>!1}),ee({"custom-input":k(()=>{var t;return[e.localValue&&e.localValue.length>0?(l(),o(V,{key:0},[e.multi?s("",!0):(l(),o("div",{key:0,class:"value-wrapper",onClick:r[1]||(r[1]=S=>e.viewFile&&e.handleView(S))},p((t=e.localValue[0])==null?void 0:t.name),1)),e.multi?(l(),o("div",fe,[(l(!0),o(V,null,le(e.localValue,(S,m)=>(l(),o("div",{class:"pill",key:`pill-${m}`,onClick:n(d=>!e.viewFile&&e.handleClear(d,m),["stop"])},[i("div",{class:"clear",onClick:n(d=>e.handleClear(d,m),["stop"])}," x ",8,ve),i("div",{class:"content",onClick:n(d=>e.handleView(d,m),["stop"])},[i("span",null,p(S.name),1)],8,be)],8,ye))),128))])):s("",!0)],64)):s("",!0)]}),_:2},[!e.readOnly&&!e.disabled?{name:"icon-slot",fn:k(()=>[(l(),ae(te(e.iconSVG)))]),key:"0"}:void 0]),1040,["class","errorMessage","icon","isError","label","modelValue"]),e.isUploadVisible?(l(),o(V,{key:0},[((O=e.uploadState)==null?void 0:O.status)==="UPLOADING"?(l(),o("span",Se,p(((I=e.uploadState)==null?void 0:I.progress)||0)+"% ",1)):s("",!0),T(X,{class:"upload-progress-bar",color:e.getProgressColor,height:4,progress:((C=e.uploadState)==null?void 0:C.progress)||0},null,8,["color","progress"])],64)):s("",!0)])],34)}const Fe=de(_,[["render",Ve]]);_.__docgenInfo={displayName:"sb-form-file-input",exportName:"default",description:"",tags:{},props:[{name:"allowClear",type:{name:"boolean"},required:!1},{name:"disabled",type:{name:"boolean"},required:!1},{name:"errorMessage",type:{name:"string|func"},required:!1},{name:"format",type:{name:"string[]"},required:!0},{name:"helperText",type:{name:"string"},required:!1},{name:"isError",type:{name:"boolean"},required:!1},{name:"label",type:{name:"string"},required:!1},{name:"maxSize",type:{name:"number"},required:!1},{name:"modelValue",type:{name:"File[] | null"},required:!1},{name:"multi",type:{name:"boolean"},required:!1},{name:"onDragText",type:{name:"string | null"},required:!1},{name:"readOnly",type:{name:"boolean"},required:!1},{name:"required",type:{name:"boolean"},required:!1},{name:"uploadState",type:{name:"IUploadState"},required:!1},{name:"value",type:{name:"File[] | null"},required:!1},{name:"viewFile",type:{name:"boolean"},required:!1}],events:[{name:"update:modelValue",type:{names:["undefined"]}},{name:"change",type:{names:["undefined"]}},{name:"error",type:{names:["undefined"]},properties:[{type:{names:["undefined"]},name:"<anonymous1>"}]},{name:"input",type:{names:["undefined"]}},{name:"retry",type:{names:["undefined"]}},{name:"previewFile",type:{names:["undefined"]}}],sourceFiles:["/Users/edgar/Documents/private-projects/vue-base-lib/src/components/form-file-input/form-file-input.vue"]};const{UPDATE_STORY_ARGS:De}=__STORYBOOK_MODULE_CORE_EVENTS__,Te={title:"Forms/File Input",component:Fe,tags:["autodocs"],argTypes:{"onUpdate:modelValue":{action:"change",control:!1,description:"This event fired when input value changed",table:{category:"events",type:{summary:"(value: File[] | null) => void"}},type:"function"},allowClear:{control:"boolean",description:"Clear input value"},disabled:{control:"boolean",description:"Is Input disabled"},errorMessage:{control:"text",description:"Input error message"},format:{control:"object",description:"Accept file formats. Example: [.jpg, .jpeg, .png]"},helperText:{control:"text",description:"File input helper text"},isError:{control:"boolean",description:"Is Input validation error"},label:{control:"text",description:"Input label"},maxSize:{control:"number",description:"File maximum size in MB"},modelValue:{control:"array",description:"Input value"},multi:{control:"boolean",description:"Multiple upload files"},onChange:{action:"change",control:!1,description:"This event fired when input value changed",table:{category:"events",type:{summary:"(value: File[] | null) => void"}},type:"function"},onDragText:{control:"text",description:"On-drag File drop area text"},onError:{action:"change",control:!1,description:"Fire when File validation error",table:{category:"events",type:{summary:'(errorType: "INVALID FORMAT" | "INVALID SIZE", format?: string) => void'}},type:"function"},onPreviewFile:{action:"click",control:!1,description:"Fire when users click on file name to view file",table:{category:"events",type:{summary:"(preview: IPreviewFile) => void"}},type:"function"},onRetry:{action:"click",control:!1,description:"Fire when File upload state error",table:{category:"events",type:{summary:"(value: File[] | null) => void"}},type:"function"},readOnly:{control:"boolean",description:"Is Input read-only"},required:{control:"boolean",description:"Is Input required"},value:{control:"array",description:"Input value"},viewFile:{control:"boolean",description:"Whether users can view file or not"}},args:{format:[".png",".jpg",".jpeg"],label:"Some File Input",modelValue:null,onDragText:null},decorators:[(e,r)=>(delete r.args.onChange,delete r.args.onInput,delete r.args["onUpdate:modelValue"],r.args.onChange=a=>{window.__STORYBOOK_ADDONS_CHANNEL__.emit(De,{storyId:r.id,updatedArgs:{modelValue:a}})},e())],parameters:{docs:{controls:{exclude:["change","error","previewFile","retry","update:modelValue"],sort:"requiredFirst"}}}},c={args:{}},g={args:{multi:!0}},h={args:{allowClear:!0}},f={args:{disabled:!0}},y={args:{readOnly:!0}},v={args:{errorMessage:"Some Error Message",isError:!0}};var M,R,U;c.parameters={...c.parameters,docs:{...(M=c.parameters)==null?void 0:M.docs,source:{originalSource:`{
  args: {}
}`,...(U=(R=c.parameters)==null?void 0:R.docs)==null?void 0:U.source}}};var w,B,$;g.parameters={...g.parameters,docs:{...(w=g.parameters)==null?void 0:w.docs,source:{originalSource:`{
  args: {
    multi: true
  }
}`,...($=(B=g.parameters)==null?void 0:B.docs)==null?void 0:$.source}}};var L,N,A;h.parameters={...h.parameters,docs:{...(L=h.parameters)==null?void 0:L.docs,source:{originalSource:`{
  args: {
    allowClear: true
  }
}`,...(A=(N=h.parameters)==null?void 0:N.docs)==null?void 0:A.source}}};var j,P,z;f.parameters={...f.parameters,docs:{...(j=f.parameters)==null?void 0:j.docs,source:{originalSource:`{
  args: {
    disabled: true
  }
}`,...(z=(P=f.parameters)==null?void 0:P.docs)==null?void 0:z.source}}};var G,H,Y;y.parameters={...y.parameters,docs:{...(G=y.parameters)==null?void 0:G.docs,source:{originalSource:`{
  args: {
    readOnly: true
  }
}`,...(Y=(H=y.parameters)==null?void 0:H.docs)==null?void 0:Y.source}}};var K,Z,W;v.parameters={...v.parameters,docs:{...(K=v.parameters)==null?void 0:K.docs,source:{originalSource:`{
  args: {
    errorMessage: 'Some Error Message',
    isError: true
  }
}`,...(W=(Z=v.parameters)==null?void 0:Z.docs)==null?void 0:W.source}}};const ke=["Default","Multiple","AllowClear","Disabled","ReadOnly","Error"];export{h as AllowClear,c as Default,f as Disabled,v as Error,g as Multiple,y as ReadOnly,ke as __namedExportsOrder,Te as default};

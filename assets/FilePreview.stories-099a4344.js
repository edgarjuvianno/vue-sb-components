var li=Object.defineProperty;var ci=(ot,o,at)=>o in ot?li(ot,o,{enumerable:!0,configurable:!0,writable:!0,value:at}):ot[o]=at;var Yt=(ot,o,at)=>(ci(ot,typeof o!="symbol"?o+"":o,at),at),Fe=(ot,o,at)=>{if(!o.has(ot))throw TypeError("Cannot "+at)};var t=(ot,o,at)=>(Fe(ot,o,"read from private field"),at?at.call(ot):o.get(ot)),I=(ot,o,at)=>{if(o.has(ot))throw TypeError("Cannot add the same private member more than once");o instanceof WeakSet?o.add(ot):o.set(ot,at)},it=(ot,o,at,l)=>(Fe(ot,o,"write to private field"),l?l.call(ot,at):o.set(ot,at),at);var he=(ot,o,at,l)=>({set _(R){it(ot,o,R,at)},get _(){return t(ot,o,l)}}),X=(ot,o,at)=>(Fe(ot,o,"access private method"),at);import{B as Button}from"./button-3147bba6.js";import{e as defineComponent,s as resolveComponent,o as openBlock,f as createBlock,t as withCtx,q as mergeProps,j as createBaseVNode,g as createElementBlock,m as createCommentVNode,F as Fragment,D as renderList,l as resolveDynamicComponent,n as normalizeClass,v as toDisplayString,u as normalizeStyle}from"./vue.esm-bundler-1a22c5b9.js";import{c as commonjsRequire}from"./_commonjs-dynamic-modules-302442b1.js";import{g as getAugmentedNamespace}from"./_commonjsHelpers-23102255.js";import{M as Modal}from"./modal-3f2be27d.js";import{f as angleLeft,b as angleRight}from"./icons-69f7cd3d.js";import{_ as _export_sfc}from"./_plugin-vue_export-helper-c27b6911.js";import"./tooltip-6a7924cb.js";var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(o,at){module.exports=o.pdfjsLib=at()})(globalThis,()=>(()=>{var __webpack_modules__=[,(ot,o)=>{var jt;Object.defineProperty(o,"__esModule",{value:!0}),o.VerbosityLevel=o.Util=o.UnknownErrorException=o.UnexpectedResponseException=o.TextRenderingMode=o.RenderingIntentFlag=o.PromiseCapability=o.PermissionFlag=o.PasswordResponses=o.PasswordException=o.PageActionEventType=o.OPS=o.MissingPDFException=o.MAX_IMAGE_SIZE_TO_CACHE=o.LINE_FACTOR=o.LINE_DESCENT_FACTOR=o.InvalidPDFException=o.ImageKind=o.IDENTITY_MATRIX=o.FormatError=o.FeatureTest=o.FONT_IDENTITY_MATRIX=o.DocumentActionEventType=o.CMapCompressionType=o.BaseException=o.BASELINE_FACTOR=o.AnnotationType=o.AnnotationReplyType=o.AnnotationMode=o.AnnotationFlag=o.AnnotationFieldFlag=o.AnnotationEditorType=o.AnnotationEditorPrefix=o.AnnotationEditorParamsType=o.AnnotationBorderStyleType=o.AnnotationActionEventType=o.AbortException=void 0,o.assert=L,o.bytesToString=K,o.createValidAbsoluteUrl=rt,o.getModificationDate=Mt,o.getUuid=Gt,o.getVerbosityLevel=z,o.info=nt,o.isArrayBuffer=gt,o.isArrayEqual=Ft,o.isNodeJS=void 0,o.normalizeUnicode=Dt,o.objectFromMap=pt,o.objectSize=dt,o.setVerbosityLevel=E,o.shadow=_t,o.string32=lt,o.stringToBytes=ft,o.stringToPDFString=Ct,o.stringToUTF8String=st,o.unreachable=u,o.utf8StringToString=tt,o.warn=ct;const at=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");o.isNodeJS=at;const l=[1,0,0,1,0,0];o.IDENTITY_MATRIX=l;const R=[.001,0,0,.001,0,0];o.FONT_IDENTITY_MATRIX=R;const ht=1e7;o.MAX_IMAGE_SIZE_TO_CACHE=ht;const q=1.35;o.LINE_FACTOR=q;const ut=.35;o.LINE_DESCENT_FACTOR=ut;const j=ut/q;o.BASELINE_FACTOR=j;const D={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};o.RenderingIntentFlag=D;const m={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};o.AnnotationMode=m;const O="pdfjs_internal_editor_";o.AnnotationEditorPrefix=O;const B={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};o.AnnotationEditorType=B;const M={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};o.AnnotationEditorParamsType=M;const S={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};o.PermissionFlag=S;const v={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};o.TextRenderingMode=v;const h={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};o.ImageKind=h;const _={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};o.AnnotationType=_;const w={GROUP:"Group",REPLY:"R"};o.AnnotationReplyType=w;const x={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};o.AnnotationFlag=x;const A={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};o.AnnotationFieldFlag=A;const n={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};o.AnnotationBorderStyleType=n;const r={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};o.AnnotationActionEventType=r;const F={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};o.DocumentActionEventType=F;const f={O:"PageOpen",C:"PageClose"};o.PageActionEventType=f;const i={ERRORS:0,WARNINGS:1,INFOS:5};o.VerbosityLevel=i;const P={NONE:0,BINARY:1};o.CMapCompressionType=P;const g={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};o.OPS=g;const W={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};o.PasswordResponses=W;let V=i.WARNINGS;function E(mt){Number.isInteger(mt)&&(V=mt)}function z(){return V}function nt(mt){V>=i.INFOS&&console.log(`Info: ${mt}`)}function ct(mt){V>=i.WARNINGS&&console.log(`Warning: ${mt}`)}function u(mt){throw new Error(mt)}function L(mt,G){mt||u(G)}function Y(mt){switch(mt==null?void 0:mt.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function rt(mt,G=null,J=null){if(!mt)return null;try{if(J&&typeof mt=="string"){if(J.addDefaultProtocol&&mt.startsWith("www.")){const Vt=mt.match(/\./g);(Vt==null?void 0:Vt.length)>=2&&(mt=`http://${mt}`)}if(J.tryConvertEncoding)try{mt=st(mt)}catch{}}const Tt=G?new URL(mt,G):new URL(mt);if(Y(Tt))return Tt}catch{}return null}function _t(mt,G,J,Tt=!1){return Object.defineProperty(mt,G,{value:J,enumerable:!Tt,configurable:!0,writable:!1}),J}const d=function(){function G(J,Tt){this.constructor===G&&u("Cannot initialize BaseException."),this.message=J,this.name=Tt}return G.prototype=new Error,G.constructor=G,G}();o.BaseException=d;class e extends d{constructor(G,J){super(G,"PasswordException"),this.code=J}}o.PasswordException=e;class s extends d{constructor(G,J){super(G,"UnknownErrorException"),this.details=J}}o.UnknownErrorException=s;class c extends d{constructor(G){super(G,"InvalidPDFException")}}o.InvalidPDFException=c;class C extends d{constructor(G){super(G,"MissingPDFException")}}o.MissingPDFException=C;class y extends d{constructor(G,J){super(G,"UnexpectedResponseException"),this.status=J}}o.UnexpectedResponseException=y;class N extends d{constructor(G){super(G,"FormatError")}}o.FormatError=N;class H extends d{constructor(G){super(G,"AbortException")}}o.AbortException=H;function K(mt){(typeof mt!="object"||(mt==null?void 0:mt.length)===void 0)&&u("Invalid argument for bytesToString");const G=mt.length,J=8192;if(G<J)return String.fromCharCode.apply(null,mt);const Tt=[];for(let Vt=0;Vt<G;Vt+=J){const Nt=Math.min(Vt+J,G),qt=mt.subarray(Vt,Nt);Tt.push(String.fromCharCode.apply(null,qt))}return Tt.join("")}function ft(mt){typeof mt!="string"&&u("Invalid argument for stringToBytes");const G=mt.length,J=new Uint8Array(G);for(let Tt=0;Tt<G;++Tt)J[Tt]=mt.charCodeAt(Tt)&255;return J}function lt(mt){return String.fromCharCode(mt>>24&255,mt>>16&255,mt>>8&255,mt&255)}function dt(mt){return Object.keys(mt).length}function pt(mt){const G=Object.create(null);for(const[J,Tt]of mt)G[J]=Tt;return G}function kt(){const mt=new Uint8Array(4);return mt[0]=1,new Uint32Array(mt.buffer,0,1)[0]===1}function wt(){try{return new Function(""),!0}catch{return!1}}class Lt{static get isLittleEndian(){return _t(this,"isLittleEndian",kt())}static get isEvalSupported(){return _t(this,"isEvalSupported",wt())}static get isOffscreenCanvasSupported(){return _t(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?_t(this,"platform",{isWin:!1,isMac:!1}):_t(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){var G,J;return _t(this,"isCSSRoundSupported",(J=(G=globalThis.CSS)==null?void 0:G.supports)==null?void 0:J.call(G,"width: round(1.5px, 1px)"))}}o.FeatureTest=Lt;const Ut=[...Array(256).keys()].map(mt=>mt.toString(16).padStart(2,"0"));class Pt{static makeHexColor(G,J,Tt){return`#${Ut[G]}${Ut[J]}${Ut[Tt]}`}static scaleMinMax(G,J){let Tt;G[0]?(G[0]<0&&(Tt=J[0],J[0]=J[1],J[1]=Tt),J[0]*=G[0],J[1]*=G[0],G[3]<0&&(Tt=J[2],J[2]=J[3],J[3]=Tt),J[2]*=G[3],J[3]*=G[3]):(Tt=J[0],J[0]=J[2],J[2]=Tt,Tt=J[1],J[1]=J[3],J[3]=Tt,G[1]<0&&(Tt=J[2],J[2]=J[3],J[3]=Tt),J[2]*=G[1],J[3]*=G[1],G[2]<0&&(Tt=J[0],J[0]=J[1],J[1]=Tt),J[0]*=G[2],J[1]*=G[2]),J[0]+=G[4],J[1]+=G[4],J[2]+=G[5],J[3]+=G[5]}static transform(G,J){return[G[0]*J[0]+G[2]*J[1],G[1]*J[0]+G[3]*J[1],G[0]*J[2]+G[2]*J[3],G[1]*J[2]+G[3]*J[3],G[0]*J[4]+G[2]*J[5]+G[4],G[1]*J[4]+G[3]*J[5]+G[5]]}static applyTransform(G,J){const Tt=G[0]*J[0]+G[1]*J[2]+J[4],Vt=G[0]*J[1]+G[1]*J[3]+J[5];return[Tt,Vt]}static applyInverseTransform(G,J){const Tt=J[0]*J[3]-J[1]*J[2],Vt=(G[0]*J[3]-G[1]*J[2]+J[2]*J[5]-J[4]*J[3])/Tt,Nt=(-G[0]*J[1]+G[1]*J[0]+J[4]*J[1]-J[5]*J[0])/Tt;return[Vt,Nt]}static getAxialAlignedBoundingBox(G,J){const Tt=this.applyTransform(G,J),Vt=this.applyTransform(G.slice(2,4),J),Nt=this.applyTransform([G[0],G[3]],J),qt=this.applyTransform([G[2],G[1]],J);return[Math.min(Tt[0],Vt[0],Nt[0],qt[0]),Math.min(Tt[1],Vt[1],Nt[1],qt[1]),Math.max(Tt[0],Vt[0],Nt[0],qt[0]),Math.max(Tt[1],Vt[1],Nt[1],qt[1])]}static inverseTransform(G){const J=G[0]*G[3]-G[1]*G[2];return[G[3]/J,-G[1]/J,-G[2]/J,G[0]/J,(G[2]*G[5]-G[4]*G[3])/J,(G[4]*G[1]-G[5]*G[0])/J]}static singularValueDecompose2dScale(G){const J=[G[0],G[2],G[1],G[3]],Tt=G[0]*J[0]+G[1]*J[2],Vt=G[0]*J[1]+G[1]*J[3],Nt=G[2]*J[0]+G[3]*J[2],qt=G[2]*J[1]+G[3]*J[3],Jt=(Tt+qt)/2,Q=Math.sqrt((Tt+qt)**2-4*(Tt*qt-Nt*Vt))/2,St=Jt+Q||1,Ot=Jt-Q||1;return[Math.sqrt(St),Math.sqrt(Ot)]}static normalizeRect(G){const J=G.slice(0);return G[0]>G[2]&&(J[0]=G[2],J[2]=G[0]),G[1]>G[3]&&(J[1]=G[3],J[3]=G[1]),J}static intersect(G,J){const Tt=Math.max(Math.min(G[0],G[2]),Math.min(J[0],J[2])),Vt=Math.min(Math.max(G[0],G[2]),Math.max(J[0],J[2]));if(Tt>Vt)return null;const Nt=Math.max(Math.min(G[1],G[3]),Math.min(J[1],J[3])),qt=Math.min(Math.max(G[1],G[3]),Math.max(J[1],J[3]));return Nt>qt?null:[Tt,Nt,Vt,qt]}static bezierBoundingBox(G,J,Tt,Vt,Nt,qt,Jt,Q){const St=[],Ot=[[],[]];let Et,p,a,k,T,U,Z,At;for(let vt=0;vt<2;++vt){if(vt===0?(p=6*G-12*Tt+6*Nt,Et=-3*G+9*Tt-9*Nt+3*Jt,a=3*Tt-3*G):(p=6*J-12*Vt+6*qt,Et=-3*J+9*Vt-9*qt+3*Q,a=3*Vt-3*J),Math.abs(Et)<1e-12){if(Math.abs(p)<1e-12)continue;k=-a/p,0<k&&k<1&&St.push(k);continue}Z=p*p-4*a*Et,At=Math.sqrt(Z),!(Z<0)&&(T=(-p+At)/(2*Et),0<T&&T<1&&St.push(T),U=(-p-At)/(2*Et),0<U&&U<1&&St.push(U))}let b=St.length,$;const et=b;for(;b--;)k=St[b],$=1-k,Ot[0][b]=$*$*$*G+3*$*$*k*Tt+3*$*k*k*Nt+k*k*k*Jt,Ot[1][b]=$*$*$*J+3*$*$*k*Vt+3*$*k*k*qt+k*k*k*Q;return Ot[0][et]=G,Ot[1][et]=J,Ot[0][et+1]=Jt,Ot[1][et+1]=Q,Ot[0].length=Ot[1].length=et+2,[Math.min(...Ot[0]),Math.min(...Ot[1]),Math.max(...Ot[0]),Math.max(...Ot[1])]}}o.Util=Pt;const Bt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function Ct(mt){if(mt[0]>="ï"){let J;if(mt[0]==="þ"&&mt[1]==="ÿ"?J="utf-16be":mt[0]==="ÿ"&&mt[1]==="þ"?J="utf-16le":mt[0]==="ï"&&mt[1]==="»"&&mt[2]==="¿"&&(J="utf-8"),J)try{const Tt=new TextDecoder(J,{fatal:!0}),Vt=ft(mt);return Tt.decode(Vt)}catch(Tt){ct(`stringToPDFString: "${Tt}".`)}}const G=[];for(let J=0,Tt=mt.length;J<Tt;J++){const Vt=Bt[mt.charCodeAt(J)];G.push(Vt?String.fromCharCode(Vt):mt.charAt(J))}return G.join("")}function st(mt){return decodeURIComponent(escape(mt))}function tt(mt){return unescape(encodeURIComponent(mt))}function gt(mt){return typeof mt=="object"&&(mt==null?void 0:mt.byteLength)!==void 0}function Ft(mt,G){if(mt.length!==G.length)return!1;for(let J=0,Tt=mt.length;J<Tt;J++)if(mt[J]!==G[J])return!1;return!0}function Mt(mt=new Date){return[mt.getUTCFullYear().toString(),(mt.getUTCMonth()+1).toString().padStart(2,"0"),mt.getUTCDate().toString().padStart(2,"0"),mt.getUTCHours().toString().padStart(2,"0"),mt.getUTCMinutes().toString().padStart(2,"0"),mt.getUTCSeconds().toString().padStart(2,"0")].join("")}class Ht{constructor(){I(this,jt,!1);this.promise=new Promise((G,J)=>{this.resolve=Tt=>{it(this,jt,!0),G(Tt)},this.reject=Tt=>{it(this,jt,!0),J(Tt)}})}get settled(){return t(this,jt)}}jt=new WeakMap,o.PromiseCapability=Ht;let Wt=null,Rt=null;function Dt(mt){return Wt||(Wt=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Rt=new Map([["ﬅ","ſt"]])),mt.replaceAll(Wt,(G,J,Tt)=>J?J.normalize("NFKC"):Rt.get(Tt))}function Gt(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const mt=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(mt);else for(let G=0;G<32;G++)mt[G]=Math.floor(Math.random()*255);return K(mt)}},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var ot,at,l,R,re,q,_e,j,D,m,O,B,M,S,v,h,Ae,w,x,Re,n,r;Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(f){if(typeof f=="string"||f instanceof URL?f={url:f}:(0,_util.isArrayBuffer)(f)&&(f={data:f}),typeof f!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!f.url&&!f.data&&!f.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const i=new PDFDocumentLoadingTask,{docId:P}=i,g=f.url?getUrlProp(f.url):null,W=f.data?getDataProp(f.data):null,V=f.httpHeaders||null,E=f.withCredentials===!0,z=f.password??null,nt=f.range instanceof PDFDataRangeTransport?f.range:null,ct=Number.isInteger(f.rangeChunkSize)&&f.rangeChunkSize>0?f.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let u=f.worker instanceof PDFWorker?f.worker:null;const L=f.verbosity,Y=typeof f.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(f.docBaseUrl)?f.docBaseUrl:null,rt=typeof f.cMapUrl=="string"?f.cMapUrl:null,_t=f.cMapPacked!==!1,d=f.CMapReaderFactory||DefaultCMapReaderFactory,e=typeof f.standardFontDataUrl=="string"?f.standardFontDataUrl:null,s=f.StandardFontDataFactory||DefaultStandardFontDataFactory,c=f.stopAtErrors!==!0,C=Number.isInteger(f.maxImageSize)&&f.maxImageSize>-1?f.maxImageSize:-1,y=f.isEvalSupported!==!1,N=typeof f.isOffscreenCanvasSupported=="boolean"?f.isOffscreenCanvasSupported:!_util.isNodeJS,H=Number.isInteger(f.canvasMaxAreaInBytes)?f.canvasMaxAreaInBytes:-1,K=typeof f.disableFontFace=="boolean"?f.disableFontFace:_util.isNodeJS,ft=f.fontExtraProperties===!0,lt=f.enableXfa===!0,dt=f.ownerDocument||globalThis.document,pt=f.disableRange===!0,kt=f.disableStream===!0,wt=f.disableAutoFetch===!0,Lt=f.pdfBug===!0,Ut=nt?nt.length:f.length??NaN,Pt=typeof f.useSystemFonts=="boolean"?f.useSystemFonts:!_util.isNodeJS&&!K,Bt=typeof f.useWorkerFetch=="boolean"?f.useWorkerFetch:d===_display_utils.DOMCMapReaderFactory&&s===_display_utils.DOMStandardFontDataFactory&&rt&&e&&(0,_display_utils.isValidFetchUrl)(rt,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(e,document.baseURI),Ct=f.canvasFactory||new DefaultCanvasFactory({ownerDocument:dt}),st=f.filterFactory||new DefaultFilterFactory({docId:P,ownerDocument:dt}),tt=null;(0,_util.setVerbosityLevel)(L);const gt={canvasFactory:Ct,filterFactory:st};if(Bt||(gt.cMapReaderFactory=new d({baseUrl:rt,isCompressed:_t}),gt.standardFontDataFactory=new s({baseUrl:e})),!u){const Ht={verbosity:L,port:_worker_options.GlobalWorkerOptions.workerPort};u=Ht.port?PDFWorker.fromPort(Ht):new PDFWorker(Ht),i._worker=u}const Ft={docId:P,apiVersion:"3.10.111",data:W,password:z,disableAutoFetch:wt,rangeChunkSize:ct,length:Ut,docBaseUrl:Y,enableXfa:lt,evaluatorOptions:{maxImageSize:C,disableFontFace:K,ignoreErrors:c,isEvalSupported:y,isOffscreenCanvasSupported:N,canvasMaxAreaInBytes:H,fontExtraProperties:ft,useSystemFonts:Pt,cMapUrl:Bt?rt:null,standardFontDataUrl:Bt?e:null}},Mt={ignoreErrors:c,isEvalSupported:y,disableFontFace:K,fontExtraProperties:ft,enableXfa:lt,ownerDocument:dt,disableAutoFetch:wt,pdfBug:Lt,styleElement:tt};return u.promise.then(function(){if(i.destroyed)throw new Error("Loading aborted");const Ht=_fetchDocument(u,Ft),Wt=new Promise(function(Rt){let Dt;nt?Dt=new _transport_stream.PDFDataTransportStream({length:Ut,initialData:nt.initialData,progressiveDone:nt.progressiveDone,contentDispositionFilename:nt.contentDispositionFilename,disableRange:pt,disableStream:kt},nt):W||(Dt=(jt=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(jt):(0,_display_utils.isValidFetchUrl)(jt.url)?new _displayFetch_stream.PDFFetchStream(jt):new _displayNetwork.PDFNetworkStream(jt))({url:g,length:Ut,httpHeaders:V,withCredentials:E,rangeChunkSize:ct,disableRange:pt,disableStream:kt})),Rt(Dt)});return Promise.all([Ht,Wt]).then(function([Rt,Dt]){if(i.destroyed)throw new Error("Loading aborted");const Gt=new _message_handler.MessageHandler(P,Rt,u.port),jt=new WorkerTransport(Gt,i,Dt,Mt,gt);i._transport=jt,Gt.send("Ready",null)})}).catch(i._capability.reject),i}async function _fetchDocument(f,i){if(f.destroyed)throw new Error("Worker was destroyed");const P=await f.messageHandler.sendWithPromise("GetDocRequest",i,i.data?[i.data.buffer]:null);if(f.destroyed)throw new Error("Worker was destroyed");return P}function getUrlProp(f){if(f instanceof URL)return f.href;try{return new URL(f,window.location).href}catch{if(_util.isNodeJS&&typeof f=="string")return f}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(f){if(_util.isNodeJS&&typeof Buffer<"u"&&f instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(f instanceof Uint8Array&&f.byteLength===f.buffer.byteLength)return f;if(typeof f=="string")return(0,_util.stringToBytes)(f);if(typeof f=="object"&&!isNaN(f==null?void 0:f.length)||(0,_util.isArrayBuffer)(f))return new Uint8Array(f);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const o=class o{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${he(o,ot)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var i,P,g;this.destroyed=!0;try{(i=this._worker)!=null&&i.port&&(this._worker._pendingDestroy=!0),await((P=this._transport)==null?void 0:P.destroy())}catch(W){throw(g=this._worker)!=null&&g.port&&delete this._worker._pendingDestroy,W}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};ot=new WeakMap,I(o,ot,0);let PDFDocumentLoadingTask=o;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(i,P,g=!1,W=null){this.length=i,this.initialData=P,this.progressiveDone=g,this.contentDispositionFilename=W,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(i){this._rangeListeners.push(i)}addProgressListener(i){this._progressListeners.push(i)}addProgressiveReadListener(i){this._progressiveReadListeners.push(i)}addProgressiveDoneListener(i){this._progressiveDoneListeners.push(i)}onDataRange(i,P){for(const g of this._rangeListeners)g(i,P)}onDataProgress(i,P){this._readyCapability.promise.then(()=>{for(const g of this._progressListeners)g(i,P)})}onDataProgressiveRead(i){this._readyCapability.promise.then(()=>{for(const P of this._progressiveReadListeners)P(i)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const i of this._progressiveDoneListeners)i()})}transportReady(){this._readyCapability.resolve()}requestDataRange(i,P){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(i,P){this._pdfInfo=i,this._transport=P,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(g=>{if(!g)return g;const W=[];for(const V in g)W.push(...g[V]);return W}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(i){return this._transport.getPage(i)}getPageIndex(i){return this._transport.getPageIndex(i)}getDestinations(){return this._transport.getDestinations()}getDestination(i){return this._transport.getDestination(i)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(i=!1){return this._transport.startCleanup(i||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(i,P,g,W=!1){I(this,R);I(this,q);I(this,at,null);I(this,l,!1);this._pageIndex=i,this._pageInfo=P,this._transport=g,this._stats=W?new _display_utils.StatTimer:null,this._pdfBug=W,this.commonObjs=g.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:i,rotation:P=this.rotate,offsetX:g=0,offsetY:W=0,dontFlip:V=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:i,rotation:P,offsetX:g,offsetY:W,dontFlip:V})}getAnnotations({intent:i="display"}={}){const P=this._transport.getRenderingIntent(i);return this._transport.getAnnotations(this._pageIndex,P.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var i;return((i=this._transport._htmlForXfa)==null?void 0:i.children[this._pageIndex])||null}render({canvasContext:i,viewport:P,intent:g="display",annotationMode:W=_util.AnnotationMode.ENABLE,transform:V=null,background:E=null,optionalContentConfigPromise:z=null,annotationCanvasMap:nt=null,pageColors:ct=null,printAnnotationStorage:u=null}){var s,c;(s=this._stats)==null||s.time("Overall");const L=this._transport.getRenderingIntent(g,W,u);it(this,l,!1),X(this,q,_e).call(this),z||(z=this._transport.getOptionalContentConfig());let Y=this._intentStates.get(L.cacheKey);Y||(Y=Object.create(null),this._intentStates.set(L.cacheKey,Y)),Y.streamReaderCancelTimeout&&(clearTimeout(Y.streamReaderCancelTimeout),Y.streamReaderCancelTimeout=null);const rt=!!(L.renderingIntent&_util.RenderingIntentFlag.PRINT);Y.displayReadyCapability||(Y.displayReadyCapability=new _util.PromiseCapability,Y.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(c=this._stats)==null||c.time("Page Request"),this._pumpOperatorList(L));const _t=C=>{var y,N;Y.renderTasks.delete(d),(this._maybeCleanupAfterRender||rt)&&it(this,l,!0),X(this,R,re).call(this,!rt),C?(d.capability.reject(C),this._abortOperatorList({intentState:Y,reason:C instanceof Error?C:new Error(C)})):d.capability.resolve(),(y=this._stats)==null||y.timeEnd("Rendering"),(N=this._stats)==null||N.timeEnd("Overall")},d=new InternalRenderTask({callback:_t,params:{canvasContext:i,viewport:P,transform:V,background:E},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:nt,operatorList:Y.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!rt,pdfBug:this._pdfBug,pageColors:ct});(Y.renderTasks||(Y.renderTasks=new Set)).add(d);const e=d.task;return Promise.all([Y.displayReadyCapability.promise,z]).then(([C,y])=>{var N;if(this.destroyed){_t();return}(N=this._stats)==null||N.time("Rendering"),d.initializeGraphics({transparency:C,optionalContentConfig:y}),d.operatorListChanged()}).catch(_t),e}getOperatorList({intent:i="display",annotationMode:P=_util.AnnotationMode.ENABLE,printAnnotationStorage:g=null}={}){var nt;function W(){E.operatorList.lastChunk&&(E.opListReadCapability.resolve(E.operatorList),E.renderTasks.delete(z))}const V=this._transport.getRenderingIntent(i,P,g,!0);let E=this._intentStates.get(V.cacheKey);E||(E=Object.create(null),this._intentStates.set(V.cacheKey,E));let z;return E.opListReadCapability||(z=Object.create(null),z.operatorListChanged=W,E.opListReadCapability=new _util.PromiseCapability,(E.renderTasks||(E.renderTasks=new Set)).add(z),E.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(nt=this._stats)==null||nt.time("Page Request"),this._pumpOperatorList(V)),E.opListReadCapability.promise}streamTextContent({includeMarkedContent:i=!1,disableNormalization:P=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:i===!0,disableNormalization:P===!0},{highWaterMark:100,size(W){return W.items.length}})}getTextContent(i={}){if(this._transport._htmlForXfa)return this.getXfa().then(g=>_xfa_text.XfaText.textContent(g));const P=this.streamTextContent(i);return new Promise(function(g,W){function V(){E.read().then(function({value:nt,done:ct}){if(ct){g(z);return}Object.assign(z.styles,nt.styles),z.items.push(...nt.items),V()},W)}const E=P.getReader(),z={items:[],styles:Object.create(null)};V()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const i=[];for(const P of this._intentStates.values())if(this._abortOperatorList({intentState:P,reason:new Error("Page was destroyed."),force:!0}),!P.opListReadCapability)for(const g of P.renderTasks)i.push(g.completed),g.cancel();return this.objs.clear(),it(this,l,!1),X(this,q,_e).call(this),Promise.all(i)}cleanup(i=!1){it(this,l,!0);const P=X(this,R,re).call(this,!1);return i&&P&&this._stats&&(this._stats=new _display_utils.StatTimer),P}_startRenderPage(i,P){var W,V;const g=this._intentStates.get(P);g&&((W=this._stats)==null||W.timeEnd("Page Request"),(V=g.displayReadyCapability)==null||V.resolve(i))}_renderPageChunk(i,P){for(let g=0,W=i.length;g<W;g++)P.operatorList.fnArray.push(i.fnArray[g]),P.operatorList.argsArray.push(i.argsArray[g]);P.operatorList.lastChunk=i.lastChunk,P.operatorList.separateAnnots=i.separateAnnots;for(const g of P.renderTasks)g.operatorListChanged();i.lastChunk&&X(this,R,re).call(this,!0)}_pumpOperatorList({renderingIntent:i,cacheKey:P,annotationStorageSerializable:g}){const{map:W,transfers:V}=g,z=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:i,cacheKey:P,annotationStorage:W},V).getReader(),nt=this._intentStates.get(P);nt.streamReader=z;const ct=()=>{z.read().then(({value:u,done:L})=>{if(L){nt.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(u,nt),ct())},u=>{if(nt.streamReader=null,!this._transport.destroyed){if(nt.operatorList){nt.operatorList.lastChunk=!0;for(const L of nt.renderTasks)L.operatorListChanged();X(this,R,re).call(this,!0)}if(nt.displayReadyCapability)nt.displayReadyCapability.reject(u);else if(nt.opListReadCapability)nt.opListReadCapability.reject(u);else throw u}})};ct()}_abortOperatorList({intentState:i,reason:P,force:g=!1}){if(i.streamReader){if(i.streamReaderCancelTimeout&&(clearTimeout(i.streamReaderCancelTimeout),i.streamReaderCancelTimeout=null),!g){if(i.renderTasks.size>0)return;if(P instanceof _display_utils.RenderingCancelledException){let W=RENDERING_CANCELLED_TIMEOUT;P.extraDelay>0&&P.extraDelay<1e3&&(W+=P.extraDelay),i.streamReaderCancelTimeout=setTimeout(()=>{i.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:i,reason:P,force:!0})},W);return}}if(i.streamReader.cancel(new _util.AbortException(P.message)).catch(()=>{}),i.streamReader=null,!this._transport.destroyed){for(const[W,V]of this._intentStates)if(V===i){this._intentStates.delete(W);break}this.cleanup()}}}get stats(){return this._stats}}at=new WeakMap,l=new WeakMap,R=new WeakSet,re=function(i=!1){if(X(this,q,_e).call(this),!t(this,l)||this.destroyed)return!1;if(i)return it(this,at,setTimeout(()=>{it(this,at,null),X(this,R,re).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:P,operatorList:g}of this._intentStates.values())if(P.size>0||!g.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),it(this,l,!1),!0},q=new WeakSet,_e=function(){t(this,at)&&(clearTimeout(t(this,at)),it(this,at,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){I(this,j,new Set);I(this,D,Promise.resolve())}postMessage(i,P){const g={data:structuredClone(i,P?{transfer:P}:null)};t(this,D).then(()=>{for(const W of t(this,j))W.call(this,g)})}addEventListener(i,P){t(this,j).add(P)}removeEventListener(i,P){t(this,j).delete(P)}terminate(){t(this,j).clear()}}j=new WeakMap,D=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const f=(m=document==null?void 0:document.currentScript)==null?void 0:m.src;f&&(PDFWorkerUtil.fallbackWorkerSrc=f.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(f,i){let P;try{if(P=new URL(f),!P.origin||P.origin==="null")return!1}catch{return!1}const g=new URL(i,P);return P.origin===g.origin},PDFWorkerUtil.createCDNWrapper=function(f){const i=`importScripts("${f}");`;return URL.createObjectURL(new Blob([i]))}}const _PDFWorker=class _PDFWorker{constructor({name:f=null,port:i=null,verbosity:P=(0,_util.getVerbosityLevel)()}={}){var g;if(this.name=f,this.destroyed=!1,this.verbosity=P,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,i){if((g=t(_PDFWorker,O))!=null&&g.has(i))throw new Error("Cannot use more than one PDFWorker per port.");(t(_PDFWorker,O)||it(_PDFWorker,O,new WeakMap)).set(i,this),this._initializeFromPort(i);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(f){this._port=f,this._messageHandler=new _message_handler.MessageHandler("main","worker",f),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:f}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,f)||(f=PDFWorkerUtil.createCDNWrapper(new URL(f,window.location).href));const i=new Worker(f),P=new _message_handler.MessageHandler("main","worker",i),g=()=>{i.removeEventListener("error",W),P.destroy(),i.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},W=()=>{this._webWorker||g()};i.addEventListener("error",W),P.on("test",E=>{if(i.removeEventListener("error",W),this.destroyed){g();return}E?(this._messageHandler=P,this._port=i,this._webWorker=i,this._readyCapability.resolve(),P.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),P.destroy(),i.terminate())}),P.on("ready",E=>{if(i.removeEventListener("error",W),this.destroyed){g();return}try{V()}catch{this._setupFakeWorker()}});const V=()=>{const E=new Uint8Array;P.send("test",E,[E.buffer])};V();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(f=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const i=new LoopbackPort;this._port=i;const P=`fake${PDFWorkerUtil.fakeWorkerId++}`,g=new _message_handler.MessageHandler(P+"_worker",P,i);f.setup(g,i);const W=new _message_handler.MessageHandler(P,P+"_worker",i);this._messageHandler=W,this._readyCapability.resolve(),W.send("configure",{verbosity:this.verbosity})}).catch(f=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${f.message}".`))})}destroy(){var f;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(f=t(_PDFWorker,O))==null||f.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(f){var P;if(!(f!=null&&f.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const i=(P=t(this,O))==null?void 0:P.get(f.port);if(i){if(i._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return i}return new _PDFWorker(f)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var f;try{return((f=globalThis.pdfjsWorker)==null?void 0:f.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};O=new WeakMap,I(_PDFWorker,O,void 0);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(i,P,g,W,V){I(this,h);I(this,B,new Map);I(this,M,new Map);I(this,S,new Map);I(this,v,null);this.messageHandler=i,this.loadingTask=P,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:W.ownerDocument,styleElement:W.styleElement}),this._params=W,this.canvasFactory=V.canvasFactory,this.filterFactory=V.filterFactory,this.cMapReaderFactory=V.cMapReaderFactory,this.standardFontDataFactory=V.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=g,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(i,P=_util.AnnotationMode.ENABLE,g=null,W=!1){let V=_util.RenderingIntentFlag.DISPLAY,E=_annotation_storage.SerializableEmpty;switch(i){case"any":V=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":V=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${i}`)}switch(P){case _util.AnnotationMode.DISABLE:V+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:V+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:V+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,E=(V&_util.RenderingIntentFlag.PRINT&&g instanceof _annotation_storage.PrintAnnotationStorage?g:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${P}`)}return W&&(V+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:V,cacheKey:`${V}_${E.hash}`,annotationStorageSerializable:E}}destroy(){var g;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,(g=t(this,v))==null||g.reject(new Error("Worker was destroyed during onPassword callback"));const i=[];for(const W of t(this,M).values())i.push(W._destroy());t(this,M).clear(),t(this,S).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const P=this.messageHandler.sendWithPromise("Terminate",null);return i.push(P),Promise.all(i).then(()=>{var W;this.commonObjs.clear(),this.fontLoader.clear(),t(this,B).clear(),this.filterFactory.destroy(),(W=this._networkStream)==null||W.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:i,loadingTask:P}=this;i.on("GetReader",(g,W)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=V=>{this._lastProgress={loaded:V.loaded,total:V.total}},W.onPull=()=>{this._fullReader.read().then(function({value:V,done:E}){if(E){W.close();return}(0,_util.assert)(V instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),W.enqueue(new Uint8Array(V),1,[V])}).catch(V=>{W.error(V)})},W.onCancel=V=>{this._fullReader.cancel(V),W.ready.catch(E=>{if(!this.destroyed)throw E})}}),i.on("ReaderHeadersReady",g=>{const W=new _util.PromiseCapability,V=this._fullReader;return V.headersReady.then(()=>{var E;(!V.isStreamingSupported||!V.isRangeSupported)&&(this._lastProgress&&((E=P.onProgress)==null||E.call(P,this._lastProgress)),V.onProgress=z=>{var nt;(nt=P.onProgress)==null||nt.call(P,{loaded:z.loaded,total:z.total})}),W.resolve({isStreamingSupported:V.isStreamingSupported,isRangeSupported:V.isRangeSupported,contentLength:V.contentLength})},W.reject),W.promise}),i.on("GetRangeReader",(g,W)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const V=this._networkStream.getRangeReader(g.begin,g.end);if(!V){W.close();return}W.onPull=()=>{V.read().then(function({value:E,done:z}){if(z){W.close();return}(0,_util.assert)(E instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),W.enqueue(new Uint8Array(E),1,[E])}).catch(E=>{W.error(E)})},W.onCancel=E=>{V.cancel(E),W.ready.catch(z=>{if(!this.destroyed)throw z})}}),i.on("GetDoc",({pdfInfo:g})=>{this._numPages=g.numPages,this._htmlForXfa=g.htmlForXfa,delete g.htmlForXfa,P._capability.resolve(new PDFDocumentProxy(g,this))}),i.on("DocException",function(g){let W;switch(g.name){case"PasswordException":W=new _util.PasswordException(g.message,g.code);break;case"InvalidPDFException":W=new _util.InvalidPDFException(g.message);break;case"MissingPDFException":W=new _util.MissingPDFException(g.message);break;case"UnexpectedResponseException":W=new _util.UnexpectedResponseException(g.message,g.status);break;case"UnknownErrorException":W=new _util.UnknownErrorException(g.message,g.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}P._capability.reject(W)}),i.on("PasswordRequest",g=>{if(it(this,v,new _util.PromiseCapability),P.onPassword){const W=V=>{V instanceof Error?t(this,v).reject(V):t(this,v).resolve({password:V})};try{P.onPassword(W,g.code)}catch(V){t(this,v).reject(V)}}else t(this,v).reject(new _util.PasswordException(g.message,g.code));return t(this,v).promise}),i.on("DataLoaded",g=>{var W;(W=P.onProgress)==null||W.call(P,{loaded:g.length,total:g.length}),this.downloadInfoCapability.resolve(g)}),i.on("StartRenderPage",g=>{if(this.destroyed)return;t(this,M).get(g.pageIndex)._startRenderPage(g.transparency,g.cacheKey)}),i.on("commonobj",([g,W,V])=>{var E;if(!this.destroyed&&!this.commonObjs.has(g))switch(W){case"Font":const z=this._params;if("error"in V){const u=V.error;(0,_util.warn)(`Error during font loading: ${u}`),this.commonObjs.resolve(g,u);break}const nt=z.pdfBug&&((E=globalThis.FontInspector)!=null&&E.enabled)?(u,L)=>globalThis.FontInspector.fontAdded(u,L):null,ct=new _font_loader.FontFaceObject(V,{isEvalSupported:z.isEvalSupported,disableFontFace:z.disableFontFace,ignoreErrors:z.ignoreErrors,inspectFont:nt});this.fontLoader.bind(ct).catch(u=>i.sendWithPromise("FontFallback",{id:g})).finally(()=>{!z.fontExtraProperties&&ct.data&&(ct.data=null),this.commonObjs.resolve(g,ct)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(g,V);break;default:throw new Error(`Got unknown common object type ${W}`)}}),i.on("obj",([g,W,V,E])=>{var nt;if(this.destroyed)return;const z=t(this,M).get(W);if(!z.objs.has(g))switch(V){case"Image":if(z.objs.resolve(g,E),E){let ct;if(E.bitmap){const{width:u,height:L}=E;ct=u*L*4}else ct=((nt=E.data)==null?void 0:nt.length)||0;ct>_util.MAX_IMAGE_SIZE_TO_CACHE&&(z._maybeCleanupAfterRender=!0)}break;case"Pattern":z.objs.resolve(g,E);break;default:throw new Error(`Got unknown object type ${V}`)}}),i.on("DocProgress",g=>{var W;this.destroyed||(W=P.onProgress)==null||W.call(P,{loaded:g.loaded,total:g.total})}),i.on("FetchBuiltInCMap",g=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(g):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),i.on("FetchStandardFontData",g=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(g):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var g;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:i,transfers:P}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:i,filename:((g=this._fullReader)==null?void 0:g.filename)??null},P).finally(()=>{this.annotationStorage.resetModified()})}getPage(i){if(!Number.isInteger(i)||i<=0||i>this._numPages)return Promise.reject(new Error("Invalid page request."));const P=i-1,g=t(this,S).get(P);if(g)return g;const W=this.messageHandler.sendWithPromise("GetPage",{pageIndex:P}).then(V=>{if(this.destroyed)throw new Error("Transport destroyed");const E=new PDFPageProxy(P,V,this,this._params.pdfBug);return t(this,M).set(P,E),E});return t(this,S).set(P,W),W}getPageIndex(i){return typeof i!="object"||i===null||!Number.isInteger(i.num)||i.num<0||!Number.isInteger(i.gen)||i.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:i.num,gen:i.gen})}getAnnotations(i,P){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:i,intent:P})}getFieldObjects(){return X(this,h,Ae).call(this,"GetFieldObjects")}hasJSActions(){return X(this,h,Ae).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(i){return typeof i!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:i})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return X(this,h,Ae).call(this,"GetDocJSActions")}getPageJSActions(i){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:i})}getStructTree(i){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:i})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(i=>new _optional_content_config.OptionalContentConfig(i))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const i="GetMetadata",P=t(this,B).get(i);if(P)return P;const g=this.messageHandler.sendWithPromise(i,null).then(W=>{var V,E;return{info:W[0],metadata:W[1]?new _metadata.Metadata(W[1]):null,contentDispositionFilename:((V=this._fullReader)==null?void 0:V.filename)??null,contentLength:((E=this._fullReader)==null?void 0:E.contentLength)??null}});return t(this,B).set(i,g),g}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(i=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const P of t(this,M).values())if(!P.cleanup())throw new Error(`startCleanup: Page ${P.pageNumber} is currently rendering.`);this.commonObjs.clear(),i||this.fontLoader.clear(),t(this,B).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:i,enableXfa:P}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:i,enableXfa:P})}}B=new WeakMap,M=new WeakMap,S=new WeakMap,v=new WeakMap,h=new WeakSet,Ae=function(i,P=null){const g=t(this,B).get(i);if(g)return g;const W=this.messageHandler.sendWithPromise(i,P);return t(this,B).set(i,W),W};class PDFObjects{constructor(){I(this,x);I(this,w,Object.create(null))}get(i,P=null){if(P){const W=X(this,x,Re).call(this,i);return W.capability.promise.then(()=>P(W.data)),null}const g=t(this,w)[i];if(!(g!=null&&g.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${i}.`);return g.data}has(i){const P=t(this,w)[i];return(P==null?void 0:P.capability.settled)||!1}resolve(i,P=null){const g=X(this,x,Re).call(this,i);g.data=P,g.capability.resolve()}clear(){var i;for(const P in t(this,w)){const{data:g}=t(this,w)[P];(i=g==null?void 0:g.bitmap)==null||i.close()}it(this,w,Object.create(null))}}w=new WeakMap,x=new WeakSet,Re=function(i){var P;return(P=t(this,w))[i]||(P[i]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(i){I(this,n,null);it(this,n,i),this.onContinue=null}get promise(){return t(this,n).capability.promise}cancel(i=0){t(this,n).cancel(null,i)}get separateAnnots(){const{separateAnnots:i}=t(this,n).operatorList;if(!i)return!1;const{annotationCanvasMap:P}=t(this,n);return i.form||i.canvas&&(P==null?void 0:P.size)>0}}n=new WeakMap,exports.RenderTask=RenderTask;const F=class F{constructor({callback:i,params:P,objs:g,commonObjs:W,annotationCanvasMap:V,operatorList:E,pageIndex:z,canvasFactory:nt,filterFactory:ct,useRequestAnimationFrame:u=!1,pdfBug:L=!1,pageColors:Y=null}){this.callback=i,this.params=P,this.objs=g,this.commonObjs=W,this.annotationCanvasMap=V,this.operatorListIdx=null,this.operatorList=E,this._pageIndex=z,this.canvasFactory=nt,this.filterFactory=ct,this._pdfBug=L,this.pageColors=Y,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=u===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=P.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:i=!1,optionalContentConfig:P}){var z,nt;if(this.cancelled)return;if(this._canvas){if(t(F,r).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");t(F,r).add(this._canvas)}this._pdfBug&&((z=globalThis.StepperManager)!=null&&z.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:g,viewport:W,transform:V,background:E}=this.params;this.gfx=new _canvas.CanvasGraphics(g,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:P},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:V,viewport:W,transparency:i,background:E}),this.operatorListIdx=0,this.graphicsReady=!0,(nt=this.graphicsReadyCallback)==null||nt.call(this)}cancel(i=null,P=0){var g;this.running=!1,this.cancelled=!0,(g=this.gfx)==null||g.endDrawing(),this._canvas&&t(F,r).delete(this._canvas),this.callback(i||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,P))}operatorListChanged(){var i;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(i=this.stepper)==null||i.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(this.pageColors),this._canvas&&t(F,r).delete(this._canvas),this.callback())))}};r=new WeakMap,I(F,r,new WeakSet);let InternalRenderTask=F;const version="3.10.111";exports.version=version;const build="e142baecb";exports.build=build},(ot,o,at)=>{var D,m,O,ws,M;Object.defineProperty(o,"__esModule",{value:!0}),o.SerializableEmpty=o.PrintAnnotationStorage=o.AnnotationStorage=void 0;var l=at(1),R=at(4),ht=at(8);const q=Object.freeze({map:null,hash:"",transfers:void 0});o.SerializableEmpty=q;class ut{constructor(){I(this,O);I(this,D,!1);I(this,m,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(v,h){const _=t(this,m).get(v);return _===void 0?h:Object.assign(h,_)}getRawValue(v){return t(this,m).get(v)}remove(v){if(t(this,m).delete(v),t(this,m).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const h of t(this,m).values())if(h instanceof R.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(v,h){const _=t(this,m).get(v);let w=!1;if(_!==void 0)for(const[x,A]of Object.entries(h))_[x]!==A&&(w=!0,_[x]=A);else w=!0,t(this,m).set(v,h);w&&X(this,O,ws).call(this),h instanceof R.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(h.constructor._type)}has(v){return t(this,m).has(v)}getAll(){return t(this,m).size>0?(0,l.objectFromMap)(t(this,m)):null}setAll(v){for(const[h,_]of Object.entries(v))this.setValue(h,_)}get size(){return t(this,m).size}resetModified(){t(this,D)&&(it(this,D,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new j(this)}get serializable(){if(t(this,m).size===0)return q;const v=new Map,h=new ht.MurmurHash3_64,_=[],w=Object.create(null);let x=!1;for(const[A,n]of t(this,m)){const r=n instanceof R.AnnotationEditor?n.serialize(!1,w):n;r&&(v.set(A,r),h.update(`${A}:${JSON.stringify(r)}`),x||(x=!!r.bitmap))}if(x)for(const A of v.values())A.bitmap&&_.push(A.bitmap);return v.size>0?{map:v,hash:h.hexdigest(),transfers:_}:q}}D=new WeakMap,m=new WeakMap,O=new WeakSet,ws=function(){t(this,D)||(it(this,D,!0),typeof this.onSetModified=="function"&&this.onSetModified())},o.AnnotationStorage=ut;class j extends ut{constructor(h){super();I(this,M,void 0);const{map:_,hash:w,transfers:x}=h.serializable,A=structuredClone(_,x?{transfer:x}:null);it(this,M,{map:A,hash:w,transfers:x})}get print(){(0,l.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return t(this,M)}}M=new WeakMap,o.PrintAnnotationStorage=j},(ot,o,at)=>{var ut,j,D,m,O,B,M,S,v,h,Me,w,De,A,Ie,r,Cs,f,Ts,P,Ps,W,xs,E,ks;Object.defineProperty(o,"__esModule",{value:!0}),o.AnnotationEditor=void 0;var l=at(5),R=at(1);const nt=class nt{constructor(u){I(this,h);I(this,A);I(this,f);I(this,P);I(this,W);I(this,E);I(this,ut,!1);I(this,j,null);I(this,D,this.focusin.bind(this));I(this,m,this.focusout.bind(this));I(this,O,!1);I(this,B,!1);I(this,M,!1);Yt(this,"_initialOptions",Object.create(null));Yt(this,"_uiManager",null);Yt(this,"_focusEventsAllowed",!0);I(this,S,!1);I(this,v,nt._zIndex++);this.constructor===nt&&(0,R.unreachable)("Cannot initialize AnnotationEditor."),this.parent=u.parent,this.id=u.id,this.width=this.height=null,this.pageIndex=u.parent.pageIndex,this.name=u.name,this.div=null,this._uiManager=u.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=u.isCentered;const{rotation:L,rawDims:{pageWidth:Y,pageHeight:rt,pageX:_t,pageY:d}}=this.parent.viewport;this.rotation=L,this.pageRotation=(360+L-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[Y,rt],this.pageTranslation=[_t,d];const[e,s]=this.parentDimensions;this.x=u.x/e,this.y=u.y/s,this.isAttachedToDOM=!1,this.deleted=!1}static get _defaultLineColor(){return(0,R.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(u){const L=new q({id:u.parent.getNextId(),parent:u.parent,uiManager:u._uiManager});L.annotationElementId=u.annotationElementId,L.deleted=!0,L._uiManager.addToAnnotationStorage(L)}static initialize(u){}static updateDefaultParams(u,L){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(u){return!1}static paste(u,L){(0,R.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return t(this,S)}set _isDraggable(u){var L;it(this,S,u),(L=this.div)==null||L.classList.toggle("draggable",u)}center(){const[u,L]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*L/(u*2),this.y+=this.width*u/(L*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*L/(u*2),this.y-=this.width*u/(L*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(u){this._uiManager.addCommands(u)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=t(this,v)}setParent(u){u!==null&&(this.pageIndex=u.pageIndex,this.pageDimensions=u.pageDimensions),this.parent=u}focusin(u){this._focusEventsAllowed&&(t(this,O)?it(this,O,!1):this.parent.setSelected(this))}focusout(u){var Y;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const L=u.relatedTarget;L!=null&&L.closest(`#${this.id}`)||(u.preventDefault(),(Y=this.parent)!=null&&Y.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(u,L,Y,rt){const[_t,d]=this.parentDimensions;[Y,rt]=this.screenToPageTranslation(Y,rt),this.x=(u+Y)/_t,this.y=(L+rt)/d,this.fixAndSetPosition()}translate(u,L){X(this,h,Me).call(this,this.parentDimensions,u,L)}translateInPage(u,L){X(this,h,Me).call(this,this.pageDimensions,u,L),this.moveInDOM(),this.div.scrollIntoView({block:"nearest"})}drag(u,L){const[Y,rt]=this.parentDimensions;if(this.x+=u/Y,this.y+=L/rt,this.x<0||this.x>1||this.y<0||this.y>1){const{x:_t,y:d}=this.div.getBoundingClientRect();this.parent.findNewParent(this,_t,d)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}this.div.style.left=`${(100*this.x).toFixed(2)}%`,this.div.style.top=`${(100*this.y).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[u,L]=this.pageDimensions;let{x:Y,y:rt,width:_t,height:d}=this;switch(_t*=u,d*=L,Y*=u,rt*=L,this.rotation){case 0:Y=Math.max(0,Math.min(u-_t,Y)),rt=Math.max(0,Math.min(L-d,rt));break;case 90:Y=Math.max(0,Math.min(u-d,Y)),rt=Math.min(L,Math.max(_t,rt));break;case 180:Y=Math.min(u,Math.max(_t,Y)),rt=Math.min(L,Math.max(d,rt));break;case 270:Y=Math.min(u,Math.max(d,Y)),rt=Math.max(0,Math.min(L-_t,rt));break}this.x=Y/u,this.y=rt/L,this.div.style.left=`${(100*this.x).toFixed(2)}%`,this.div.style.top=`${(100*this.y).toFixed(2)}%`}screenToPageTranslation(u,L){var Y;return X(Y=nt,w,De).call(Y,u,L,this.parentRotation)}pageTranslationToScreen(u,L){var Y;return X(Y=nt,w,De).call(Y,u,L,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:u,pageDimensions:[L,Y]}=this,rt=L*u,_t=Y*u;return R.FeatureTest.isCSSRoundSupported?[Math.round(rt),Math.round(_t)]:[rt,_t]}setDims(u,L){const[Y,rt]=this.parentDimensions;this.div.style.width=`${(100*u/Y).toFixed(2)}%`,t(this,ut)||(this.div.style.height=`${(100*L/rt).toFixed(2)}%`)}fixDims(){const{style:u}=this.div,{height:L,width:Y}=u,rt=Y.endsWith("%"),_t=!t(this,ut)&&L.endsWith("%");if(rt&&_t)return;const[d,e]=this.parentDimensions;rt||(u.width=`${(100*parseFloat(Y)/d).toFixed(2)}%`),!t(this,ut)&&!_t&&(u.height=`${(100*parseFloat(L)/e).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",t(this,D)),this.div.addEventListener("focusout",t(this,m));const[u,L]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*L/u).toFixed(2)}%`,this.div.style.maxHeight=`${(100*u/L).toFixed(2)}%`);const[Y,rt]=this.getInitialTranslation();return this.translate(Y,rt),(0,l.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(u){const{isMac:L}=R.FeatureTest.platform;if(u.button!==0||u.ctrlKey&&L){u.preventDefault();return}it(this,O,!0),X(this,E,ks).call(this,u)}moveInDOM(){this.parent.moveEditorInDOM(this)}_setParentAndPosition(u,L,Y){u.changeParent(this),this.x=L,this.y=Y,this.fixAndSetPosition(),this.moveInDOM()}getRect(u,L){const Y=this.parentScale,[rt,_t]=this.pageDimensions,[d,e]=this.pageTranslation,s=u/Y,c=L/Y,C=this.x*rt,y=this.y*_t,N=this.width*rt,H=this.height*_t;switch(this.rotation){case 0:return[C+s+d,_t-y-c-H+e,C+s+N+d,_t-y-c+e];case 90:return[C+c+d,_t-y+s+e,C+c+H+d,_t-y+s+N+e];case 180:return[C-s-N+d,_t-y+c+e,C-s+d,_t-y+c+H+e];case 270:return[C-c-H+d,_t-y-s-N+e,C-c+d,_t-y-s+e];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(u,L){const[Y,rt,_t,d]=u,e=_t-Y,s=d-rt;switch(this.rotation){case 0:return[Y,L-d,e,s];case 90:return[Y,L-rt,s,e];case 180:return[_t,L-rt,e,s];case 270:return[_t,L-d,s,e];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){it(this,M,!0)}disableEditMode(){it(this,M,!1)}isInEditMode(){return t(this,M)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var u,L;(u=this.div)==null||u.addEventListener("focusin",t(this,D)),(L=this.div)==null||L.addEventListener("focusout",t(this,m))}serialize(u=!1,L=null){(0,R.unreachable)("An editor must be serializable")}static deserialize(u,L,Y){const rt=new this.prototype.constructor({parent:L,id:L.getNextId(),uiManager:Y});rt.rotation=u.rotation;const[_t,d]=rt.pageDimensions,[e,s,c,C]=rt.getRectInCurrentCoords(u.rect,d);return rt.x=e/_t,rt.y=s/d,rt.width=c/_t,rt.height=C/d,rt}remove(){this.div.removeEventListener("focusin",t(this,D)),this.div.removeEventListener("focusout",t(this,m)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this)}get isResizable(){return!1}makeResizable(){this.isResizable&&(X(this,f,Ts).call(this),t(this,j).classList.remove("hidden"))}select(){var u;this.makeResizable(),(u=this.div)==null||u.classList.add("selectedEditor")}unselect(){var u,L,Y;(u=t(this,j))==null||u.classList.add("hidden"),(L=this.div)==null||L.classList.remove("selectedEditor"),(Y=this.div)!=null&&Y.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(u,L){}disableEditing(){}enableEditing(){}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return t(this,B)}set isEditing(u){it(this,B,u),this.parent&&(u?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(u,L){it(this,ut,!0);const Y=u/L,{style:rt}=this.div;rt.aspectRatio=Y,rt.height="auto"}static get MIN_SIZE(){return 16}};ut=new WeakMap,j=new WeakMap,D=new WeakMap,m=new WeakMap,O=new WeakMap,B=new WeakMap,M=new WeakMap,S=new WeakMap,v=new WeakMap,h=new WeakSet,Me=function([u,L],Y,rt){[Y,rt]=this.screenToPageTranslation(Y,rt),this.x+=Y/u,this.y+=rt/L,this.fixAndSetPosition()},w=new WeakSet,De=function(u,L,Y){switch(Y){case 90:return[L,-u];case 180:return[-u,-L];case 270:return[-L,u];default:return[u,L]}},A=new WeakSet,Ie=function(u){switch(u){case 90:{const[L,Y]=this.pageDimensions;return[0,-L/Y,Y/L,0]}case 180:return[-1,0,0,-1];case 270:{const[L,Y]=this.pageDimensions;return[0,L/Y,-Y/L,0]}default:return[1,0,0,1]}},r=new WeakSet,Cs=function(u){u.preventDefault()},f=new WeakSet,Ts=function(){if(t(this,j))return;it(this,j,document.createElement("div")),t(this,j).classList.add("resizers");const u=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||u.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const L of u){const Y=document.createElement("div");t(this,j).append(Y),Y.classList.add("resizer",L),Y.addEventListener("pointerdown",X(this,P,Ps).bind(this,L)),Y.addEventListener("contextmenu",X(nt,r,Cs))}this.div.prepend(t(this,j))},P=new WeakSet,Ps=function(u,L){L.preventDefault();const{isMac:Y}=R.FeatureTest.platform;if(L.button!==0||L.ctrlKey&&Y)return;const rt=X(this,W,xs).bind(this,u),_t=this._isDraggable;this._isDraggable=!1;const d={passive:!0,capture:!0};window.addEventListener("pointermove",rt,d);const e=this.x,s=this.y,c=this.width,C=this.height,y=this.parent.div.style.cursor,N=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(L.target).cursor;const H=()=>{this._isDraggable=_t,window.removeEventListener("pointerup",H),window.removeEventListener("blur",H),window.removeEventListener("pointermove",rt,d),this.parent.div.style.cursor=y,this.div.style.cursor=N;const K=this.x,ft=this.y,lt=this.width,dt=this.height;K===e&&ft===s&&lt===c&&dt===C||this.addCommands({cmd:()=>{this.width=lt,this.height=dt,this.x=K,this.y=ft;const[pt,kt]=this.parentDimensions;this.setDims(pt*lt,kt*dt),this.fixAndSetPosition(),this.moveInDOM()},undo:()=>{this.width=c,this.height=C,this.x=e,this.y=s;const[pt,kt]=this.parentDimensions;this.setDims(pt*c,kt*C),this.fixAndSetPosition(),this.moveInDOM()},mustExec:!0})};window.addEventListener("pointerup",H),window.addEventListener("blur",H)},W=new WeakSet,xs=function(u,L){const[Y,rt]=this.parentDimensions,_t=this.x,d=this.y,e=this.width,s=this.height,c=nt.MIN_SIZE/Y,C=nt.MIN_SIZE/rt,y=Rt=>Math.round(Rt*1e4)/1e4,N=X(this,A,Ie).call(this,this.rotation),H=(Rt,Dt)=>[N[0]*Rt+N[2]*Dt,N[1]*Rt+N[3]*Dt],K=X(this,A,Ie).call(this,360-this.rotation),ft=(Rt,Dt)=>[K[0]*Rt+K[2]*Dt,K[1]*Rt+K[3]*Dt];let lt,dt,pt=!1,kt=!1;switch(u){case"topLeft":pt=!0,lt=(Rt,Dt)=>[0,0],dt=(Rt,Dt)=>[Rt,Dt];break;case"topMiddle":lt=(Rt,Dt)=>[Rt/2,0],dt=(Rt,Dt)=>[Rt/2,Dt];break;case"topRight":pt=!0,lt=(Rt,Dt)=>[Rt,0],dt=(Rt,Dt)=>[0,Dt];break;case"middleRight":kt=!0,lt=(Rt,Dt)=>[Rt,Dt/2],dt=(Rt,Dt)=>[0,Dt/2];break;case"bottomRight":pt=!0,lt=(Rt,Dt)=>[Rt,Dt],dt=(Rt,Dt)=>[0,0];break;case"bottomMiddle":lt=(Rt,Dt)=>[Rt/2,Dt],dt=(Rt,Dt)=>[Rt/2,0];break;case"bottomLeft":pt=!0,lt=(Rt,Dt)=>[0,Dt],dt=(Rt,Dt)=>[Rt,0];break;case"middleLeft":kt=!0,lt=(Rt,Dt)=>[0,Dt/2],dt=(Rt,Dt)=>[Rt,Dt/2];break}const wt=lt(e,s),Lt=dt(e,s);let Ut=H(...Lt);const Pt=y(_t+Ut[0]),Bt=y(d+Ut[1]);let Ct=1,st=1,[tt,gt]=this.screenToPageTranslation(L.movementX,L.movementY);if([tt,gt]=ft(tt/Y,gt/rt),pt){const Rt=Math.hypot(e,s);Ct=st=Math.max(Math.min(Math.hypot(Lt[0]-wt[0]-tt,Lt[1]-wt[1]-gt)/Rt,1/e,1/s),c/e,C/s)}else kt?Ct=Math.max(c,Math.min(1,Math.abs(Lt[0]-wt[0]-tt)))/e:st=Math.max(C,Math.min(1,Math.abs(Lt[1]-wt[1]-gt)))/s;const Ft=y(e*Ct),Mt=y(s*st);Ut=H(...dt(Ft,Mt));const Ht=Pt-Ut[0],Wt=Bt-Ut[1];this.width=Ft,this.height=Mt,this.x=Ht,this.y=Wt,this.setDims(Y*Ft,rt*Mt),this.fixAndSetPosition()},E=new WeakSet,ks=function(u){if(!this._isDraggable)return;const L=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let Y,rt;L&&(Y={passive:!0,capture:!0},rt=d=>{const[e,s]=this.screenToPageTranslation(d.movementX,d.movementY);this._uiManager.dragSelectedEditors(e,s)},window.addEventListener("pointermove",rt,Y));const _t=()=>{if(window.removeEventListener("pointerup",_t),window.removeEventListener("blur",_t),L&&window.removeEventListener("pointermove",rt,Y),it(this,O,!1),!this._uiManager.endDragSession()){const{isMac:d}=R.FeatureTest.platform;u.ctrlKey&&!d||u.shiftKey||u.metaKey&&d?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",_t),window.addEventListener("blur",_t)},I(nt,w),I(nt,r),Yt(nt,"_colorManager",new l.ColorManager),Yt(nt,"_zIndex",1);let ht=nt;o.AnnotationEditor=ht;class q extends ht{constructor(u){super(u),this.annotationElementId=u.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(ot,o,at)=>{var M,S,v,h,_,Le,A,n,r,F,f,Fs,g,W,V,E,z,nt,ct,u,L,Y,rt,_t,d,e,s,c,C,y,N,H,K,ft,lt,dt,pt,kt,wt,Lt,Ut,Pt,Bt,Ct,st,tt,gt,Rs,Mt,Oe,Wt,Ms,Dt,Ne,jt,Ds,G,Is,Tt,ee,Nt,de,Jt,Ls,St,Os,Et,Be,a,ue,T,Ue;Object.defineProperty(o,"__esModule",{value:!0}),o.KeyboardManager=o.CommandManager=o.ColorManager=o.AnnotationEditorUIManager=void 0,o.bindEvents=ht,o.opacityToHex=q;var l=at(1),R=at(6);function ht(At,b,$){for(const et of $)b.addEventListener(et,At[et].bind(At))}function q(At){return Math.round(Math.min(255,Math.max(1,255*At))).toString(16).padStart(2,"0")}class ut{constructor(){I(this,M,0)}getId(){return`${l.AnnotationEditorPrefix}${he(this,M)._++}`}}M=new WeakMap;const x=class x{constructor(){I(this,_);I(this,S,(0,l.getUuid)());I(this,v,0);I(this,h,null)}static get _isSVGFittingCanvas(){const b='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',et=new OffscreenCanvas(1,3).getContext("2d"),vt=new Image;vt.src=b;const bt=vt.decode().then(()=>(et.drawImage(vt,0,0,1,1,0,0,1,3),new Uint32Array(et.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,l.shadow)(this,"_isSVGFittingCanvas",bt)}async getFromFile(b){const{lastModified:$,name:et,size:vt,type:bt}=b;return X(this,_,Le).call(this,`${$}_${et}_${vt}_${bt}`,b)}async getFromUrl(b){return X(this,_,Le).call(this,b,b)}async getFromId(b){t(this,h)||it(this,h,new Map);const $=t(this,h).get(b);return $?$.bitmap?($.refCounter+=1,$):$.file?this.getFromFile($.file):this.getFromUrl($.url):null}getSvgUrl(b){const $=t(this,h).get(b);return $!=null&&$.isSvg?$.svgUrl:null}deleteId(b){t(this,h)||it(this,h,new Map);const $=t(this,h).get(b);$&&($.refCounter-=1,$.refCounter===0&&($.bitmap=null))}isValidId(b){return b.startsWith(`image_${t(this,S)}_`)}};S=new WeakMap,v=new WeakMap,h=new WeakMap,_=new WeakSet,Le=async function(b,$){t(this,h)||it(this,h,new Map);let et=t(this,h).get(b);if(et===null)return null;if(et!=null&&et.bitmap)return et.refCounter+=1,et;try{et||(et={bitmap:null,id:`image_${t(this,S)}_${he(this,v)._++}`,refCounter:0,isSvg:!1});let vt;if(typeof $=="string"){et.url=$;const bt=await fetch($);if(!bt.ok)throw new Error(bt.statusText);vt=await bt.blob()}else vt=et.file=$;if(vt.type==="image/svg+xml"){const bt=x._isSVGFittingCanvas,yt=new FileReader,xt=new Image,It=new Promise((zt,$t)=>{xt.onload=()=>{et.bitmap=xt,et.isSvg=!0,zt()},yt.onload=async()=>{const Kt=et.svgUrl=yt.result;xt.src=await bt?`${Kt}#svgView(preserveAspectRatio(none))`:Kt},xt.onerror=yt.onerror=$t});yt.readAsDataURL(vt),await It}else et.bitmap=await createImageBitmap(vt);et.refCounter=1}catch(vt){console.error(vt),et=null}return t(this,h).set(b,et),et&&t(this,h).set(et.id,et),et};let j=x;class D{constructor(b=128){I(this,A,[]);I(this,n,!1);I(this,r,void 0);I(this,F,-1);it(this,r,b)}add({cmd:b,undo:$,mustExec:et,type:vt=NaN,overwriteIfSameType:bt=!1,keepUndo:yt=!1}){if(et&&b(),t(this,n))return;const xt={cmd:b,undo:$,type:vt};if(t(this,F)===-1){t(this,A).length>0&&(t(this,A).length=0),it(this,F,0),t(this,A).push(xt);return}if(bt&&t(this,A)[t(this,F)].type===vt){yt&&(xt.undo=t(this,A)[t(this,F)].undo),t(this,A)[t(this,F)]=xt;return}const It=t(this,F)+1;It===t(this,r)?t(this,A).splice(0,1):(it(this,F,It),It<t(this,A).length&&t(this,A).splice(It)),t(this,A).push(xt)}undo(){t(this,F)!==-1&&(it(this,n,!0),t(this,A)[t(this,F)].undo(),it(this,n,!1),it(this,F,t(this,F)-1))}redo(){t(this,F)<t(this,A).length-1&&(it(this,F,t(this,F)+1),it(this,n,!0),t(this,A)[t(this,F)].cmd(),it(this,n,!1))}hasSomethingToUndo(){return t(this,F)!==-1}hasSomethingToRedo(){return t(this,F)<t(this,A).length-1}destroy(){it(this,A,null)}}A=new WeakMap,n=new WeakMap,r=new WeakMap,F=new WeakMap,o.CommandManager=D;class m{constructor(b){I(this,f);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:$}=l.FeatureTest.platform;for(const[et,vt,bt={}]of b)for(const yt of et){const xt=yt.startsWith("mac+");$&&xt?(this.callbacks.set(yt.slice(4),{callback:vt,options:bt}),this.allKeys.add(yt.split("+").at(-1))):!$&&!xt&&(this.callbacks.set(yt,{callback:vt,options:bt}),this.allKeys.add(yt.split("+").at(-1)))}}exec(b,$){if(!this.allKeys.has($.key))return;const et=this.callbacks.get(X(this,f,Fs).call(this,$));if(!et)return;const{callback:vt,options:{bubbles:bt=!1,args:yt=[],checker:xt=null}}=et;xt&&!xt(b,$)||(vt.bind(b,...yt)(),bt||($.stopPropagation(),$.preventDefault()))}}f=new WeakSet,Fs=function(b){b.altKey&&this.buffer.push("alt"),b.ctrlKey&&this.buffer.push("ctrl"),b.metaKey&&this.buffer.push("meta"),b.shiftKey&&this.buffer.push("shift"),this.buffer.push(b.key);const $=this.buffer.join("+");return this.buffer.length=0,$},o.KeyboardManager=m;const P=class P{get _colors(){const b=new Map([["CanvasText",null],["Canvas",null]]);return(0,R.getColorValues)(b),(0,l.shadow)(this,"_colors",b)}convert(b){const $=(0,R.getRGB)(b);if(!window.matchMedia("(forced-colors: active)").matches)return $;for(const[et,vt]of this._colors)if(vt.every((bt,yt)=>bt===$[yt]))return P._colorsMapping.get(et);return $}getHexCode(b){const $=this._colors.get(b);return $?l.Util.makeHexColor(...$):b}};Yt(P,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let O=P;o.ColorManager=O;const Z=class Z{constructor(b,$,et,vt,bt){I(this,gt);I(this,Mt);I(this,Wt);I(this,Dt);I(this,jt);I(this,G);I(this,Tt);I(this,Nt);I(this,Jt);I(this,St);I(this,Et);I(this,a);I(this,T);I(this,g,null);I(this,W,new Map);I(this,V,new Map);I(this,E,null);I(this,z,new D);I(this,nt,0);I(this,ct,new Set);I(this,u,null);I(this,L,null);I(this,Y,new Set);I(this,rt,null);I(this,_t,null);I(this,d,new ut);I(this,e,!1);I(this,s,!1);I(this,c,null);I(this,C,l.AnnotationEditorType.NONE);I(this,y,new Set);I(this,N,null);I(this,H,this.blur.bind(this));I(this,K,this.focus.bind(this));I(this,ft,this.copy.bind(this));I(this,lt,this.cut.bind(this));I(this,dt,this.paste.bind(this));I(this,pt,this.keydown.bind(this));I(this,kt,this.onEditingAction.bind(this));I(this,wt,this.onPageChanging.bind(this));I(this,Lt,this.onScaleChanging.bind(this));I(this,Ut,this.onRotationChanging.bind(this));I(this,Pt,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});I(this,Bt,[0,0]);I(this,Ct,null);I(this,st,null);I(this,tt,null);it(this,st,b),it(this,tt,$),it(this,rt,et),t(this,rt)._on("editingaction",t(this,kt)),t(this,rt)._on("pagechanging",t(this,wt)),t(this,rt)._on("scalechanging",t(this,Lt)),t(this,rt)._on("rotationchanging",t(this,Ut)),it(this,E,vt.annotationStorage),it(this,_t,vt.filterFactory),it(this,N,bt),this.viewParameters={realScale:R.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const b=Z.prototype,$=bt=>{const{activeElement:yt}=document;return yt&&t(bt,st).contains(yt)&&bt.hasSomethingToControl()},et=this.TRANSLATE_SMALL,vt=this.TRANSLATE_BIG;return(0,l.shadow)(this,"_keyboardManager",new m([[["ctrl+a","mac+meta+a"],b.selectAll],[["ctrl+z","mac+meta+z"],b.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],b.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],b.delete],[["Escape","mac+Escape"],b.unselectAll],[["ArrowLeft","mac+ArrowLeft"],b.translateSelectedEditors,{args:[-et,0],checker:$}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],b.translateSelectedEditors,{args:[-vt,0],checker:$}],[["ArrowRight","mac+ArrowRight"],b.translateSelectedEditors,{args:[et,0],checker:$}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],b.translateSelectedEditors,{args:[vt,0],checker:$}],[["ArrowUp","mac+ArrowUp"],b.translateSelectedEditors,{args:[0,-et],checker:$}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],b.translateSelectedEditors,{args:[0,-vt],checker:$}],[["ArrowDown","mac+ArrowDown"],b.translateSelectedEditors,{args:[0,et],checker:$}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],b.translateSelectedEditors,{args:[0,vt],checker:$}]]))}destroy(){X(this,Dt,Ne).call(this),X(this,Mt,Oe).call(this),t(this,rt)._off("editingaction",t(this,kt)),t(this,rt)._off("pagechanging",t(this,wt)),t(this,rt)._off("scalechanging",t(this,Lt)),t(this,rt)._off("rotationchanging",t(this,Ut));for(const b of t(this,V).values())b.destroy();t(this,V).clear(),t(this,W).clear(),t(this,Y).clear(),it(this,g,null),t(this,y).clear(),t(this,z).destroy()}get hcmFilter(){return(0,l.shadow)(this,"hcmFilter",t(this,N)?t(this,_t).addHCMFilter(t(this,N).foreground,t(this,N).background):"none")}onPageChanging({pageNumber:b}){it(this,nt,b-1)}focusMainContainer(){t(this,st).focus()}findParent(b,$){for(const et of t(this,V).values()){const{x:vt,y:bt,width:yt,height:xt}=et.div.getBoundingClientRect();if(b>=vt&&b<=vt+yt&&$>=bt&&$<=bt+xt)return et}return null}disableUserSelect(b=!1){t(this,tt).classList.toggle("noUserSelect",b)}addShouldRescale(b){t(this,Y).add(b)}removeShouldRescale(b){t(this,Y).delete(b)}onScaleChanging({scale:b}){this.commitOrRemove(),this.viewParameters.realScale=b*R.PixelsPerInch.PDF_TO_CSS_UNITS;for(const $ of t(this,Y))$.onScaleChanging()}onRotationChanging({pagesRotation:b}){this.commitOrRemove(),this.viewParameters.rotation=b}addToAnnotationStorage(b){!b.isEmpty()&&t(this,E)&&!t(this,E).has(b.id)&&t(this,E).setValue(b.id,b)}blur(){if(!this.hasSelection)return;const{activeElement:b}=document;for(const $ of t(this,y))if($.div.contains(b)){it(this,c,[$,b]),$._focusEventsAllowed=!1;break}}focus(){if(!t(this,c))return;const[b,$]=t(this,c);it(this,c,null),$.addEventListener("focusin",()=>{b._focusEventsAllowed=!0},{once:!0}),$.focus()}copy(b){var et;if(b.preventDefault(),(et=t(this,g))==null||et.commitOrRemove(),!this.hasSelection)return;const $=[];for(const vt of t(this,y)){const bt=vt.serialize(!0);bt&&$.push(bt)}$.length!==0&&b.clipboardData.setData("application/pdfjs",JSON.stringify($))}cut(b){this.copy(b),this.delete()}paste(b){b.preventDefault();const{clipboardData:$}=b;for(const bt of $.items)for(const yt of t(this,L))if(yt.isHandlingMimeForPasting(bt.type)){yt.paste(bt,this.currentLayer);return}let et=$.getData("application/pdfjs");if(!et)return;try{et=JSON.parse(et)}catch(bt){(0,l.warn)(`paste: "${bt.message}".`);return}if(!Array.isArray(et))return;this.unselectAll();const vt=this.currentLayer;try{const bt=[];for(const It of et){const zt=vt.deserialize(It);if(!zt)return;bt.push(zt)}const yt=()=>{for(const It of bt)X(this,Et,Be).call(this,It);X(this,T,Ue).call(this,bt)},xt=()=>{for(const It of bt)It.remove()};this.addCommands({cmd:yt,undo:xt,mustExec:!0})}catch(bt){(0,l.warn)(`paste: "${bt.message}".`)}}keydown(b){var $;($=this.getActive())!=null&&$.shouldGetKeyboardEvents()||Z._keyboardManager.exec(this,b)}onEditingAction(b){["undo","redo","delete","selectAll"].includes(b.name)&&this[b.name]()}setEditingState(b){b?(X(this,gt,Rs).call(this),X(this,Wt,Ms).call(this),X(this,jt,Ds).call(this),X(this,Tt,ee).call(this,{isEditing:t(this,C)!==l.AnnotationEditorType.NONE,isEmpty:X(this,a,ue).call(this),hasSomethingToUndo:t(this,z).hasSomethingToUndo(),hasSomethingToRedo:t(this,z).hasSomethingToRedo(),hasSelectedEditor:!1})):(X(this,Mt,Oe).call(this),X(this,Dt,Ne).call(this),X(this,G,Is).call(this),X(this,Tt,ee).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(b){if(!t(this,L)){it(this,L,b);for(const $ of t(this,L))X(this,Nt,de).call(this,$.defaultPropertiesToUpdate)}}getId(){return t(this,d).getId()}get currentLayer(){return t(this,V).get(t(this,nt))}getLayer(b){return t(this,V).get(b)}get currentPageIndex(){return t(this,nt)}addLayer(b){t(this,V).set(b.pageIndex,b),t(this,e)?b.enable():b.disable()}removeLayer(b){t(this,V).delete(b.pageIndex)}updateMode(b,$=null){if(t(this,C)!==b){if(it(this,C,b),b===l.AnnotationEditorType.NONE){this.setEditingState(!1),X(this,St,Os).call(this);return}this.setEditingState(!0),X(this,Jt,Ls).call(this),this.unselectAll();for(const et of t(this,V).values())et.updateMode(b);if($){for(const et of t(this,W).values())if(et.annotationElementId===$){this.setSelected(et),et.enterInEditMode();break}}}}updateToolbar(b){b!==t(this,C)&&t(this,rt).dispatch("switchannotationeditormode",{source:this,mode:b})}updateParams(b,$){if(t(this,L)){if(b===l.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(b);return}for(const et of t(this,y))et.updateParams(b,$);for(const et of t(this,L))et.updateDefaultParams(b,$)}}enableWaiting(b=!1){if(t(this,s)!==b){it(this,s,b);for(const $ of t(this,V).values())b?$.disableClick():$.enableClick(),$.div.classList.toggle("waiting",b)}}getEditors(b){const $=[];for(const et of t(this,W).values())et.pageIndex===b&&$.push(et);return $}getEditor(b){return t(this,W).get(b)}addEditor(b){t(this,W).set(b.id,b)}removeEditor(b){var $;t(this,W).delete(b.id),this.unselect(b),(!b.annotationElementId||!t(this,ct).has(b.annotationElementId))&&(($=t(this,E))==null||$.remove(b.id))}addDeletedAnnotationElement(b){t(this,ct).add(b.annotationElementId),b.deleted=!0}isDeletedAnnotationElement(b){return t(this,ct).has(b)}removeDeletedAnnotationElement(b){t(this,ct).delete(b.annotationElementId),b.deleted=!1}setActiveEditor(b){t(this,g)!==b&&(it(this,g,b),b&&X(this,Nt,de).call(this,b.propertiesToUpdate))}toggleSelected(b){if(t(this,y).has(b)){t(this,y).delete(b),b.unselect(),X(this,Tt,ee).call(this,{hasSelectedEditor:this.hasSelection});return}t(this,y).add(b),b.select(),X(this,Nt,de).call(this,b.propertiesToUpdate),X(this,Tt,ee).call(this,{hasSelectedEditor:!0})}setSelected(b){for(const $ of t(this,y))$!==b&&$.unselect();t(this,y).clear(),t(this,y).add(b),b.select(),X(this,Nt,de).call(this,b.propertiesToUpdate),X(this,Tt,ee).call(this,{hasSelectedEditor:!0})}isSelected(b){return t(this,y).has(b)}unselect(b){b.unselect(),t(this,y).delete(b),X(this,Tt,ee).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return t(this,y).size!==0}undo(){t(this,z).undo(),X(this,Tt,ee).call(this,{hasSomethingToUndo:t(this,z).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:X(this,a,ue).call(this)})}redo(){t(this,z).redo(),X(this,Tt,ee).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:t(this,z).hasSomethingToRedo(),isEmpty:X(this,a,ue).call(this)})}addCommands(b){t(this,z).add(b),X(this,Tt,ee).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:X(this,a,ue).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const b=[...t(this,y)],$=()=>{for(const vt of b)vt.remove()},et=()=>{for(const vt of b)X(this,Et,Be).call(this,vt)};this.addCommands({cmd:$,undo:et,mustExec:!0})}commitOrRemove(){var b;(b=t(this,g))==null||b.commitOrRemove()}hasSomethingToControl(){return t(this,g)||this.hasSelection}selectAll(){for(const b of t(this,y))b.commit();X(this,T,Ue).call(this,t(this,W).values())}unselectAll(){if(t(this,g)){t(this,g).commitOrRemove();return}if(this.hasSelection){for(const b of t(this,y))b.unselect();t(this,y).clear(),X(this,Tt,ee).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(b,$,et=!1){if(et||this.commitOrRemove(),!this.hasSelection)return;t(this,Bt)[0]+=b,t(this,Bt)[1]+=$;const[vt,bt]=t(this,Bt),yt=[...t(this,y)],xt=1e3;t(this,Ct)&&clearTimeout(t(this,Ct)),it(this,Ct,setTimeout(()=>{it(this,Ct,null),t(this,Bt)[0]=t(this,Bt)[1]=0,this.addCommands({cmd:()=>{for(const It of yt)t(this,W).has(It.id)&&It.translateInPage(vt,bt)},undo:()=>{for(const It of yt)t(this,W).has(It.id)&&It.translateInPage(-vt,-bt)},mustExec:!1})},xt));for(const It of yt)It.translateInPage(b,$)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),it(this,u,new Map);for(const b of t(this,y))t(this,u).set(b,{savedX:b.x,savedY:b.y,savedPageIndex:b.parent.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!t(this,u))return!1;this.disableUserSelect(!1);const b=t(this,u);it(this,u,null);let $=!1;for(const[{x:vt,y:bt,parent:yt},xt]of b)xt.newX=vt,xt.newY=bt,xt.newPageIndex=yt.pageIndex,$||($=vt!==xt.savedX||bt!==xt.savedY||yt.pageIndex!==xt.savedPageIndex);if(!$)return!1;const et=(vt,bt,yt,xt)=>{if(t(this,W).has(vt.id)){const It=t(this,V).get(xt);It?vt._setParentAndPosition(It,bt,yt):(vt.pageIndex=xt,vt.x=bt,vt.y=yt)}};return this.addCommands({cmd:()=>{for(const[vt,{newX:bt,newY:yt,newPageIndex:xt}]of b)et(vt,bt,yt,xt)},undo:()=>{for(const[vt,{savedX:bt,savedY:yt,savedPageIndex:xt}]of b)et(vt,bt,yt,xt)},mustExec:!0}),!0}dragSelectedEditors(b,$){if(t(this,u))for(const et of t(this,u).keys())et.drag(b,$)}rebuild(b){if(b.parent===null){const $=this.getLayer(b.pageIndex);$?($.changeParent(b),$.addOrRebuild(b)):(this.addEditor(b),this.addToAnnotationStorage(b),b.rebuild())}else b.parent.addOrRebuild(b)}isActive(b){return t(this,g)===b}getActive(){return t(this,g)}getMode(){return t(this,C)}get imageManager(){return(0,l.shadow)(this,"imageManager",new j)}};g=new WeakMap,W=new WeakMap,V=new WeakMap,E=new WeakMap,z=new WeakMap,nt=new WeakMap,ct=new WeakMap,u=new WeakMap,L=new WeakMap,Y=new WeakMap,rt=new WeakMap,_t=new WeakMap,d=new WeakMap,e=new WeakMap,s=new WeakMap,c=new WeakMap,C=new WeakMap,y=new WeakMap,N=new WeakMap,H=new WeakMap,K=new WeakMap,ft=new WeakMap,lt=new WeakMap,dt=new WeakMap,pt=new WeakMap,kt=new WeakMap,wt=new WeakMap,Lt=new WeakMap,Ut=new WeakMap,Pt=new WeakMap,Bt=new WeakMap,Ct=new WeakMap,st=new WeakMap,tt=new WeakMap,gt=new WeakSet,Rs=function(){window.addEventListener("focus",t(this,K)),window.addEventListener("blur",t(this,H))},Mt=new WeakSet,Oe=function(){window.removeEventListener("focus",t(this,K)),window.removeEventListener("blur",t(this,H))},Wt=new WeakSet,Ms=function(){window.addEventListener("keydown",t(this,pt),{capture:!0})},Dt=new WeakSet,Ne=function(){window.removeEventListener("keydown",t(this,pt),{capture:!0})},jt=new WeakSet,Ds=function(){document.addEventListener("copy",t(this,ft)),document.addEventListener("cut",t(this,lt)),document.addEventListener("paste",t(this,dt))},G=new WeakSet,Is=function(){document.removeEventListener("copy",t(this,ft)),document.removeEventListener("cut",t(this,lt)),document.removeEventListener("paste",t(this,dt))},Tt=new WeakSet,ee=function(b){Object.entries(b).some(([et,vt])=>t(this,Pt)[et]!==vt)&&t(this,rt).dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(t(this,Pt),b)})},Nt=new WeakSet,de=function(b){t(this,rt).dispatch("annotationeditorparamschanged",{source:this,details:b})},Jt=new WeakSet,Ls=function(){if(!t(this,e)){it(this,e,!0);for(const b of t(this,V).values())b.enable()}},St=new WeakSet,Os=function(){if(this.unselectAll(),t(this,e)){it(this,e,!1);for(const b of t(this,V).values())b.disable()}},Et=new WeakSet,Be=function(b){const $=t(this,V).get(b.pageIndex);$?$.addOrRebuild(b):this.addEditor(b)},a=new WeakSet,ue=function(){if(t(this,W).size===0)return!0;if(t(this,W).size===1)for(const b of t(this,W).values())return b.isEmpty();return!1},T=new WeakSet,Ue=function(b){t(this,y).clear();for(const $ of b)$.isEmpty()||(t(this,y).add($),$.select());X(this,Tt,ee).call(this,{hasSelectedEditor:!0})},Yt(Z,"TRANSLATE_SMALL",1),Yt(Z,"TRANSLATE_BIG",10);let B=Z;o.AnnotationEditorUIManager=B},(ot,o,at)=>{var ct,u,L,Y,rt,_t,d,e,s,c,C,y,ae,H,oe,ft,je,dt,ye,kt,ve,Lt,fe,Pt,pe;Object.defineProperty(o,"__esModule",{value:!0}),o.StatTimer=o.RenderingCancelledException=o.PixelsPerInch=o.PageViewport=o.PDFDateString=o.DOMStandardFontDataFactory=o.DOMSVGFactory=o.DOMFilterFactory=o.DOMCanvasFactory=o.DOMCMapReaderFactory=o.AnnotationPrefix=void 0,o.deprecated=F,o.getColorValues=W,o.getCurrentTransform=V,o.getCurrentTransformInverse=E,o.getFilenameFromUrl=w,o.getPdfFilenameFromUrl=x,o.getRGB=g,o.getXfaPageViewport=P,o.isDataScheme=h,o.isPdfFile=_,o.isValidFetchUrl=n,o.loadScript=r,o.setLayerDimensions=z;var l=at(7),R=at(1);const ht="http://www.w3.org/2000/svg",q="pdfjs_internal_id_";o.AnnotationPrefix=q;const nt=class nt{};Yt(nt,"CSS",96),Yt(nt,"PDF",72),Yt(nt,"PDF_TO_CSS_UNITS",nt.CSS/nt.PDF);let ut=nt;o.PixelsPerInch=ut;class j extends l.BaseFilterFactory{constructor({docId:tt,ownerDocument:gt=globalThis.document}={}){super();I(this,y);I(this,H);I(this,ft);I(this,dt);I(this,kt);I(this,Lt);I(this,Pt);I(this,ct,void 0);I(this,u,void 0);I(this,L,void 0);I(this,Y,void 0);I(this,rt,void 0);I(this,_t,void 0);I(this,d,void 0);I(this,e,void 0);I(this,s,void 0);I(this,c,void 0);I(this,C,0);it(this,L,tt),it(this,Y,gt)}addFilter(tt){if(!tt)return"none";let gt=t(this,y,ae).get(tt);if(gt)return gt;let Ft,Mt,Ht,Wt;if(tt.length===1){const jt=tt[0],mt=new Array(256);for(let G=0;G<256;G++)mt[G]=jt[G]/255;Wt=Ft=Mt=Ht=mt.join(",")}else{const[jt,mt,G]=tt,J=new Array(256),Tt=new Array(256),Vt=new Array(256);for(let Nt=0;Nt<256;Nt++)J[Nt]=jt[Nt]/255,Tt[Nt]=mt[Nt]/255,Vt[Nt]=G[Nt]/255;Ft=J.join(","),Mt=Tt.join(","),Ht=Vt.join(","),Wt=`${Ft}${Mt}${Ht}`}if(gt=t(this,y,ae).get(Wt),gt)return t(this,y,ae).set(tt,gt),gt;const Rt=`g_${t(this,L)}_transfer_map_${he(this,C)._++}`,Dt=`url(#${Rt})`;t(this,y,ae).set(tt,Dt),t(this,y,ae).set(Wt,Dt);const Gt=X(this,dt,ye).call(this,Rt);return X(this,Lt,fe).call(this,Ft,Mt,Ht,Gt),Dt}addHCMFilter(tt,gt){var mt;const Ft=`${tt}-${gt}`;if(t(this,_t)===Ft)return t(this,d);if(it(this,_t,Ft),it(this,d,"none"),(mt=t(this,rt))==null||mt.remove(),!tt||!gt)return t(this,d);const Mt=X(this,Pt,pe).call(this,tt);tt=R.Util.makeHexColor(...Mt);const Ht=X(this,Pt,pe).call(this,gt);if(gt=R.Util.makeHexColor(...Ht),t(this,H,oe).style.color="",tt==="#000000"&&gt==="#ffffff"||tt===gt)return t(this,d);const Wt=new Array(256);for(let G=0;G<=255;G++){const J=G/255;Wt[G]=J<=.03928?J/12.92:((J+.055)/1.055)**2.4}const Rt=Wt.join(","),Dt=`g_${t(this,L)}_hcm_filter`,Gt=it(this,e,X(this,dt,ye).call(this,Dt));X(this,Lt,fe).call(this,Rt,Rt,Rt,Gt),X(this,ft,je).call(this,Gt);const jt=(G,J)=>{const Tt=Mt[G]/255,Vt=Ht[G]/255,Nt=new Array(J+1);for(let qt=0;qt<=J;qt++)Nt[qt]=Tt+qt/J*(Vt-Tt);return Nt.join(",")};return X(this,Lt,fe).call(this,jt(0,5),jt(1,5),jt(2,5),Gt),it(this,d,`url(#${Dt})`),t(this,d)}addHighlightHCMFilter(tt,gt,Ft,Mt){var Vt;const Ht=`${tt}-${gt}-${Ft}-${Mt}`;if(t(this,s)===Ht)return t(this,c);if(it(this,s,Ht),it(this,c,"none"),(Vt=t(this,e))==null||Vt.remove(),!tt||!gt)return t(this,c);const[Wt,Rt]=[tt,gt].map(X(this,Pt,pe).bind(this));let Dt=Math.round(.2126*Wt[0]+.7152*Wt[1]+.0722*Wt[2]),Gt=Math.round(.2126*Rt[0]+.7152*Rt[1]+.0722*Rt[2]),[jt,mt]=[Ft,Mt].map(X(this,Pt,pe).bind(this));Gt<Dt&&([Dt,Gt,jt,mt]=[Gt,Dt,mt,jt]),t(this,H,oe).style.color="";const G=(Nt,qt,Jt)=>{const Q=new Array(256),St=(Gt-Dt)/Jt,Ot=Nt/255,Et=(qt-Nt)/(255*Jt);let p=0;for(let a=0;a<=Jt;a++){const k=Math.round(Dt+a*St),T=Ot+a*Et;for(let U=p;U<=k;U++)Q[U]=T;p=k+1}for(let a=p;a<256;a++)Q[a]=Q[p-1];return Q.join(",")},J=`g_${t(this,L)}_hcm_highlight_filter`,Tt=it(this,e,X(this,dt,ye).call(this,J));return X(this,ft,je).call(this,Tt),X(this,Lt,fe).call(this,G(jt[0],mt[0],5),G(jt[1],mt[1],5),G(jt[2],mt[2],5),Tt),it(this,c,`url(#${J})`),t(this,c)}destroy(tt=!1){tt&&(t(this,d)||t(this,c))||(t(this,u)&&(t(this,u).parentNode.parentNode.remove(),it(this,u,null)),t(this,ct)&&(t(this,ct).clear(),it(this,ct,null)),it(this,C,0))}}ct=new WeakMap,u=new WeakMap,L=new WeakMap,Y=new WeakMap,rt=new WeakMap,_t=new WeakMap,d=new WeakMap,e=new WeakMap,s=new WeakMap,c=new WeakMap,C=new WeakMap,y=new WeakSet,ae=function(){return t(this,ct)||it(this,ct,new Map)},H=new WeakSet,oe=function(){if(!t(this,u)){const tt=t(this,Y).createElement("div"),{style:gt}=tt;gt.visibility="hidden",gt.contain="strict",gt.width=gt.height=0,gt.position="absolute",gt.top=gt.left=0,gt.zIndex=-1;const Ft=t(this,Y).createElementNS(ht,"svg");Ft.setAttribute("width",0),Ft.setAttribute("height",0),it(this,u,t(this,Y).createElementNS(ht,"defs")),tt.append(Ft),Ft.append(t(this,u)),t(this,Y).body.append(tt)}return t(this,u)},ft=new WeakSet,je=function(tt){const gt=t(this,Y).createElementNS(ht,"feColorMatrix");gt.setAttribute("type","matrix"),gt.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),tt.append(gt)},dt=new WeakSet,ye=function(tt){const gt=t(this,Y).createElementNS(ht,"filter");return gt.setAttribute("color-interpolation-filters","sRGB"),gt.setAttribute("id",tt),t(this,H,oe).append(gt),gt},kt=new WeakSet,ve=function(tt,gt,Ft){const Mt=t(this,Y).createElementNS(ht,gt);Mt.setAttribute("type","discrete"),Mt.setAttribute("tableValues",Ft),tt.append(Mt)},Lt=new WeakSet,fe=function(tt,gt,Ft,Mt){const Ht=t(this,Y).createElementNS(ht,"feComponentTransfer");Mt.append(Ht),X(this,kt,ve).call(this,Ht,"feFuncR",tt),X(this,kt,ve).call(this,Ht,"feFuncG",gt),X(this,kt,ve).call(this,Ht,"feFuncB",Ft)},Pt=new WeakSet,pe=function(tt){return t(this,H,oe).style.color=tt,g(getComputedStyle(t(this,H,oe)).getPropertyValue("color"))},o.DOMFilterFactory=j;class D extends l.BaseCanvasFactory{constructor({ownerDocument:st=globalThis.document}={}){super(),this._document=st}_createCanvas(st,tt){const gt=this._document.createElement("canvas");return gt.width=st,gt.height=tt,gt}}o.DOMCanvasFactory=D;async function m(Ct,st=!1){if(n(Ct,document.baseURI)){const tt=await fetch(Ct);if(!tt.ok)throw new Error(tt.statusText);return st?new Uint8Array(await tt.arrayBuffer()):(0,R.stringToBytes)(await tt.text())}return new Promise((tt,gt)=>{const Ft=new XMLHttpRequest;Ft.open("GET",Ct,!0),st&&(Ft.responseType="arraybuffer"),Ft.onreadystatechange=()=>{if(Ft.readyState===XMLHttpRequest.DONE){if(Ft.status===200||Ft.status===0){let Mt;if(st&&Ft.response?Mt=new Uint8Array(Ft.response):!st&&Ft.responseText&&(Mt=(0,R.stringToBytes)(Ft.responseText)),Mt){tt(Mt);return}}gt(new Error(Ft.statusText))}},Ft.send(null)})}class O extends l.BaseCMapReaderFactory{_fetchData(st,tt){return m(st,this.isCompressed).then(gt=>({cMapData:gt,compressionType:tt}))}}o.DOMCMapReaderFactory=O;class B extends l.BaseStandardFontDataFactory{_fetchData(st){return m(st,!0)}}o.DOMStandardFontDataFactory=B;class M extends l.BaseSVGFactory{_createSVG(st){return document.createElementNS(ht,st)}}o.DOMSVGFactory=M;class S{constructor({viewBox:st,scale:tt,rotation:gt,offsetX:Ft=0,offsetY:Mt=0,dontFlip:Ht=!1}){this.viewBox=st,this.scale=tt,this.rotation=gt,this.offsetX=Ft,this.offsetY=Mt;const Wt=(st[2]+st[0])/2,Rt=(st[3]+st[1])/2;let Dt,Gt,jt,mt;switch(gt%=360,gt<0&&(gt+=360),gt){case 180:Dt=-1,Gt=0,jt=0,mt=1;break;case 90:Dt=0,Gt=1,jt=1,mt=0;break;case 270:Dt=0,Gt=-1,jt=-1,mt=0;break;case 0:Dt=1,Gt=0,jt=0,mt=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}Ht&&(jt=-jt,mt=-mt);let G,J,Tt,Vt;Dt===0?(G=Math.abs(Rt-st[1])*tt+Ft,J=Math.abs(Wt-st[0])*tt+Mt,Tt=(st[3]-st[1])*tt,Vt=(st[2]-st[0])*tt):(G=Math.abs(Wt-st[0])*tt+Ft,J=Math.abs(Rt-st[1])*tt+Mt,Tt=(st[2]-st[0])*tt,Vt=(st[3]-st[1])*tt),this.transform=[Dt*tt,Gt*tt,jt*tt,mt*tt,G-Dt*tt*Wt-jt*tt*Rt,J-Gt*tt*Wt-mt*tt*Rt],this.width=Tt,this.height=Vt}get rawDims(){const{viewBox:st}=this;return(0,R.shadow)(this,"rawDims",{pageWidth:st[2]-st[0],pageHeight:st[3]-st[1],pageX:st[0],pageY:st[1]})}clone({scale:st=this.scale,rotation:tt=this.rotation,offsetX:gt=this.offsetX,offsetY:Ft=this.offsetY,dontFlip:Mt=!1}={}){return new S({viewBox:this.viewBox.slice(),scale:st,rotation:tt,offsetX:gt,offsetY:Ft,dontFlip:Mt})}convertToViewportPoint(st,tt){return R.Util.applyTransform([st,tt],this.transform)}convertToViewportRectangle(st){const tt=R.Util.applyTransform([st[0],st[1]],this.transform),gt=R.Util.applyTransform([st[2],st[3]],this.transform);return[tt[0],tt[1],gt[0],gt[1]]}convertToPdfPoint(st,tt){return R.Util.applyInverseTransform([st,tt],this.transform)}}o.PageViewport=S;class v extends R.BaseException{constructor(st,tt=0){super(st,"RenderingCancelledException"),this.extraDelay=tt}}o.RenderingCancelledException=v;function h(Ct){const st=Ct.length;let tt=0;for(;tt<st&&Ct[tt].trim()==="";)tt++;return Ct.substring(tt,tt+5).toLowerCase()==="data:"}function _(Ct){return typeof Ct=="string"&&/\.pdf$/i.test(Ct)}function w(Ct,st=!1){return st||([Ct]=Ct.split(/[#?]/,1)),Ct.substring(Ct.lastIndexOf("/")+1)}function x(Ct,st="document.pdf"){if(typeof Ct!="string")return st;if(h(Ct))return(0,R.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),st;const tt=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,gt=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,Ft=tt.exec(Ct);let Mt=gt.exec(Ft[1])||gt.exec(Ft[2])||gt.exec(Ft[3]);if(Mt&&(Mt=Mt[0],Mt.includes("%")))try{Mt=gt.exec(decodeURIComponent(Mt))[0]}catch{}return Mt||st}class A{constructor(){Yt(this,"started",Object.create(null));Yt(this,"times",[])}time(st){st in this.started&&(0,R.warn)(`Timer is already running for ${st}`),this.started[st]=Date.now()}timeEnd(st){st in this.started||(0,R.warn)(`Timer has not been started for ${st}`),this.times.push({name:st,start:this.started[st],end:Date.now()}),delete this.started[st]}toString(){const st=[];let tt=0;for(const{name:gt}of this.times)tt=Math.max(gt.length,tt);for(const{name:gt,start:Ft,end:Mt}of this.times)st.push(`${gt.padEnd(tt)} ${Mt-Ft}ms
`);return st.join("")}}o.StatTimer=A;function n(Ct,st){try{const{protocol:tt}=st?new URL(Ct,st):new URL(Ct);return tt==="http:"||tt==="https:"}catch{return!1}}function r(Ct,st=!1){return new Promise((tt,gt)=>{const Ft=document.createElement("script");Ft.src=Ct,Ft.onload=function(Mt){st&&Ft.remove(),tt(Mt)},Ft.onerror=function(){gt(new Error(`Cannot load script at: ${Ft.src}`))},(document.head||document.documentElement).append(Ft)})}function F(Ct){console.log("Deprecated API usage: "+Ct)}let f;class i{static toDateObject(st){if(!st||typeof st!="string")return null;f||(f=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const tt=f.exec(st);if(!tt)return null;const gt=parseInt(tt[1],10);let Ft=parseInt(tt[2],10);Ft=Ft>=1&&Ft<=12?Ft-1:0;let Mt=parseInt(tt[3],10);Mt=Mt>=1&&Mt<=31?Mt:1;let Ht=parseInt(tt[4],10);Ht=Ht>=0&&Ht<=23?Ht:0;let Wt=parseInt(tt[5],10);Wt=Wt>=0&&Wt<=59?Wt:0;let Rt=parseInt(tt[6],10);Rt=Rt>=0&&Rt<=59?Rt:0;const Dt=tt[7]||"Z";let Gt=parseInt(tt[8],10);Gt=Gt>=0&&Gt<=23?Gt:0;let jt=parseInt(tt[9],10)||0;return jt=jt>=0&&jt<=59?jt:0,Dt==="-"?(Ht+=Gt,Wt+=jt):Dt==="+"&&(Ht-=Gt,Wt-=jt),new Date(Date.UTC(gt,Ft,Mt,Ht,Wt,Rt))}}o.PDFDateString=i;function P(Ct,{scale:st=1,rotation:tt=0}){const{width:gt,height:Ft}=Ct.attributes.style,Mt=[0,0,parseInt(gt),parseInt(Ft)];return new S({viewBox:Mt,scale:st,rotation:tt})}function g(Ct){if(Ct.startsWith("#")){const st=parseInt(Ct.slice(1),16);return[(st&16711680)>>16,(st&65280)>>8,st&255]}return Ct.startsWith("rgb(")?Ct.slice(4,-1).split(",").map(st=>parseInt(st)):Ct.startsWith("rgba(")?Ct.slice(5,-1).split(",").map(st=>parseInt(st)).slice(0,3):((0,R.warn)(`Not a valid color format: "${Ct}"`),[0,0,0])}function W(Ct){const st=document.createElement("span");st.style.visibility="hidden",document.body.append(st);for(const tt of Ct.keys()){st.style.color=tt;const gt=window.getComputedStyle(st).color;Ct.set(tt,g(gt))}st.remove()}function V(Ct){const{a:st,b:tt,c:gt,d:Ft,e:Mt,f:Ht}=Ct.getTransform();return[st,tt,gt,Ft,Mt,Ht]}function E(Ct){const{a:st,b:tt,c:gt,d:Ft,e:Mt,f:Ht}=Ct.getTransform().invertSelf();return[st,tt,gt,Ft,Mt,Ht]}function z(Ct,st,tt=!1,gt=!0){if(st instanceof S){const{pageWidth:Ft,pageHeight:Mt}=st.rawDims,{style:Ht}=Ct,Wt=R.FeatureTest.isCSSRoundSupported,Rt=`var(--scale-factor) * ${Ft}px`,Dt=`var(--scale-factor) * ${Mt}px`,Gt=Wt?`round(${Rt}, 1px)`:`calc(${Rt})`,jt=Wt?`round(${Dt}, 1px)`:`calc(${Dt})`;!tt||st.rotation%180===0?(Ht.width=Gt,Ht.height=jt):(Ht.width=jt,Ht.height=Gt)}gt&&Ct.setAttribute("data-main-rotation",st.rotation)}},(ot,o,at)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.BaseStandardFontDataFactory=o.BaseSVGFactory=o.BaseFilterFactory=o.BaseCanvasFactory=o.BaseCMapReaderFactory=void 0;var l=at(1);class R{constructor(){this.constructor===R&&(0,l.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(m){return"none"}addHCMFilter(m,O){return"none"}addHighlightHCMFilter(m,O,B,M){return"none"}destroy(m=!1){}}o.BaseFilterFactory=R;class ht{constructor(){this.constructor===ht&&(0,l.unreachable)("Cannot initialize BaseCanvasFactory.")}create(m,O){if(m<=0||O<=0)throw new Error("Invalid canvas size");const B=this._createCanvas(m,O);return{canvas:B,context:B.getContext("2d")}}reset(m,O,B){if(!m.canvas)throw new Error("Canvas is not specified");if(O<=0||B<=0)throw new Error("Invalid canvas size");m.canvas.width=O,m.canvas.height=B}destroy(m){if(!m.canvas)throw new Error("Canvas is not specified");m.canvas.width=0,m.canvas.height=0,m.canvas=null,m.context=null}_createCanvas(m,O){(0,l.unreachable)("Abstract method `_createCanvas` called.")}}o.BaseCanvasFactory=ht;class q{constructor({baseUrl:m=null,isCompressed:O=!0}){this.constructor===q&&(0,l.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=m,this.isCompressed=O}async fetch({name:m}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!m)throw new Error("CMap name must be specified.");const O=this.baseUrl+m+(this.isCompressed?".bcmap":""),B=this.isCompressed?l.CMapCompressionType.BINARY:l.CMapCompressionType.NONE;return this._fetchData(O,B).catch(M=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${O}`)})}_fetchData(m,O){(0,l.unreachable)("Abstract method `_fetchData` called.")}}o.BaseCMapReaderFactory=q;class ut{constructor({baseUrl:m=null}){this.constructor===ut&&(0,l.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=m}async fetch({filename:m}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!m)throw new Error("Font filename must be specified.");const O=`${this.baseUrl}${m}`;return this._fetchData(O).catch(B=>{throw new Error(`Unable to load font data at: ${O}`)})}_fetchData(m){(0,l.unreachable)("Abstract method `_fetchData` called.")}}o.BaseStandardFontDataFactory=ut;class j{constructor(){this.constructor===j&&(0,l.unreachable)("Cannot initialize BaseSVGFactory.")}create(m,O,B=!1){if(m<=0||O<=0)throw new Error("Invalid SVG dimensions");const M=this._createSVG("svg:svg");return M.setAttribute("version","1.1"),B||(M.setAttribute("width",`${m}px`),M.setAttribute("height",`${O}px`)),M.setAttribute("preserveAspectRatio","none"),M.setAttribute("viewBox",`0 0 ${m} ${O}`),M}createElement(m){if(typeof m!="string")throw new Error("Invalid SVG element type");return this._createSVG(m)}_createSVG(m){(0,l.unreachable)("Abstract method `_createSVG` called.")}}o.BaseSVGFactory=j},(ot,o,at)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.MurmurHash3_64=void 0;var l=at(1);const R=3285377520,ht=4294901760,q=65535;class ut{constructor(D){this.h1=D?D&4294967295:R,this.h2=D?D&4294967295:R}update(D){let m,O;if(typeof D=="string"){m=new Uint8Array(D.length*2),O=0;for(let F=0,f=D.length;F<f;F++){const i=D.charCodeAt(F);i<=255?m[O++]=i:(m[O++]=i>>>8,m[O++]=i&255)}}else if((0,l.isArrayBuffer)(D))m=D.slice(),O=m.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const B=O>>2,M=O-B*4,S=new Uint32Array(m.buffer,0,B);let v=0,h=0,_=this.h1,w=this.h2;const x=3432918353,A=461845907,n=x&q,r=A&q;for(let F=0;F<B;F++)F&1?(v=S[F],v=v*x&ht|v*n&q,v=v<<15|v>>>17,v=v*A&ht|v*r&q,_^=v,_=_<<13|_>>>19,_=_*5+3864292196):(h=S[F],h=h*x&ht|h*n&q,h=h<<15|h>>>17,h=h*A&ht|h*r&q,w^=h,w=w<<13|w>>>19,w=w*5+3864292196);switch(v=0,M){case 3:v^=m[B*4+2]<<16;case 2:v^=m[B*4+1]<<8;case 1:v^=m[B*4],v=v*x&ht|v*n&q,v=v<<15|v>>>17,v=v*A&ht|v*r&q,B&1?_^=v:w^=v}this.h1=_,this.h2=w}hexdigest(){let D=this.h1,m=this.h2;return D^=m>>>1,D=D*3981806797&ht|D*36045&q,m=m*4283543511&ht|((m<<16|D>>>16)*2950163797&ht)>>>16,D^=m>>>1,D=D*444984403&ht|D*60499&q,m=m*3301882366&ht|((m<<16|D>>>16)*3120437893&ht)>>>16,D^=m>>>1,(D>>>0).toString(16).padStart(8,"0")+(m>>>0).toString(16).padStart(8,"0")}}o.MurmurHash3_64=ut},(ot,o,at)=>{var q;Object.defineProperty(o,"__esModule",{value:!0}),o.FontLoader=o.FontFaceObject=void 0;var l=at(1);class R{constructor({ownerDocument:j=globalThis.document,styleElement:D=null}){I(this,q,new Set);this._document=j,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(j){this.nativeFontFaces.add(j),this._document.fonts.add(j)}removeNativeFontFace(j){this.nativeFontFaces.delete(j),this._document.fonts.delete(j)}insertRule(j){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const D=this.styleElement.sheet;D.insertRule(j,D.cssRules.length)}clear(){for(const j of this.nativeFontFaces)this._document.fonts.delete(j);this.nativeFontFaces.clear(),t(this,q).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(j){if(!(!j||t(this,q).has(j.loadedName))){if((0,l.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:D,src:m,style:O}=j,B=new FontFace(D,m,O);this.addNativeFontFace(B);try{await B.load(),t(this,q).add(D)}catch{(0,l.warn)(`Cannot load system font: ${j.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(B)}return}(0,l.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(j){if(j.attached||j.missingFile&&!j.systemFontInfo)return;if(j.attached=!0,j.systemFontInfo){await this.loadSystemFont(j.systemFontInfo);return}if(this.isFontLoadingAPISupported){const m=j.createNativeFontFace();if(m){this.addNativeFontFace(m);try{await m.loaded}catch(O){throw(0,l.warn)(`Failed to load font '${m.family}': '${O}'.`),j.disableFontFace=!0,O}}return}const D=j.createFontFaceRule();if(D){if(this.insertRule(D),this.isSyncFontLoadingSupported)return;await new Promise(m=>{const O=this._queueLoadingCallback(m);this._prepareFontLoadEvent(j,O)})}}get isFontLoadingAPISupported(){var D;const j=!!((D=this._document)!=null&&D.fonts);return(0,l.shadow)(this,"isFontLoadingAPISupported",j)}get isSyncFontLoadingSupported(){let j=!1;return(l.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(j=!0),(0,l.shadow)(this,"isSyncFontLoadingSupported",j)}_queueLoadingCallback(j){function D(){for((0,l.assert)(!O.done,"completeRequest() cannot be called twice."),O.done=!0;m.length>0&&m[0].done;){const B=m.shift();setTimeout(B.callback,0)}}const{loadingRequests:m}=this,O={done:!1,complete:D,callback:j};return m.push(O),O}get _loadTestFont(){const j=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,l.shadow)(this,"_loadTestFont",j)}_prepareFontLoadEvent(j,D){function m(g,W){return g.charCodeAt(W)<<24|g.charCodeAt(W+1)<<16|g.charCodeAt(W+2)<<8|g.charCodeAt(W+3)&255}function O(g,W,V,E){const z=g.substring(0,W),nt=g.substring(W+V);return z+E+nt}let B,M;const S=this._document.createElement("canvas");S.width=1,S.height=1;const v=S.getContext("2d");let h=0;function _(g,W){if(++h>30){(0,l.warn)("Load test font never loaded."),W();return}if(v.font="30px "+g,v.fillText(".",0,20),v.getImageData(0,0,1,1).data[3]>0){W();return}setTimeout(_.bind(null,g,W))}const w=`lt${Date.now()}${this.loadTestFontId++}`;let x=this._loadTestFont;x=O(x,976,w.length,w);const n=16,r=1482184792;let F=m(x,n);for(B=0,M=w.length-3;B<M;B+=4)F=F-r+m(w,B)|0;B<w.length&&(F=F-r+m(w+"XXX",B)|0),x=O(x,n,4,(0,l.string32)(F));const f=`url(data:font/opentype;base64,${btoa(x)});`,i=`@font-face {font-family:"${w}";src:${f}}`;this.insertRule(i);const P=this._document.createElement("div");P.style.visibility="hidden",P.style.width=P.style.height="10px",P.style.position="absolute",P.style.top=P.style.left="0px";for(const g of[j.loadedName,w]){const W=this._document.createElement("span");W.textContent="Hi",W.style.fontFamily=g,P.append(W)}this._document.body.append(P),_(w,()=>{P.remove(),D.complete()})}}q=new WeakMap,o.FontLoader=R;class ht{constructor(j,{isEvalSupported:D=!0,disableFontFace:m=!1,ignoreErrors:O=!1,inspectFont:B=null}){this.compiledGlyphs=Object.create(null);for(const M in j)this[M]=j[M];this.isEvalSupported=D!==!1,this.disableFontFace=m===!0,this.ignoreErrors=O===!0,this._inspectFont=B}createNativeFontFace(){var D;if(!this.data||this.disableFontFace)return null;let j;if(!this.cssFontInfo)j=new FontFace(this.loadedName,this.data,{});else{const m={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(m.style=`oblique ${this.cssFontInfo.italicAngle}deg`),j=new FontFace(this.cssFontInfo.fontFamily,this.data,m)}return(D=this._inspectFont)==null||D.call(this,this),j}createFontFaceRule(){var O;if(!this.data||this.disableFontFace)return null;const j=(0,l.bytesToString)(this.data),D=`url(data:${this.mimetype};base64,${btoa(j)});`;let m;if(!this.cssFontInfo)m=`@font-face {font-family:"${this.loadedName}";src:${D}}`;else{let B=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(B+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),m=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${B}src:${D}}`}return(O=this._inspectFont)==null||O.call(this,this,D),m}getPathGenerator(j,D){if(this.compiledGlyphs[D]!==void 0)return this.compiledGlyphs[D];let m;try{m=j.get(this.loadedName+"_path_"+D)}catch(O){if(!this.ignoreErrors)throw O;return(0,l.warn)(`getPathGenerator - ignoring character: "${O}".`),this.compiledGlyphs[D]=function(B,M){}}if(this.isEvalSupported&&l.FeatureTest.isEvalSupported){const O=[];for(const B of m){const M=B.args!==void 0?B.args.join(","):"";O.push("c.",B.cmd,"(",M,`);
`)}return this.compiledGlyphs[D]=new Function("c","size",O.join(""))}return this.compiledGlyphs[D]=function(O,B){for(const M of m)M.cmd==="scale"&&(M.args=[B,-B]),O[M.cmd].apply(O,M.args)}}}o.FontFaceObject=ht},(ot,o,at)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.NodeStandardFontDataFactory=o.NodeFilterFactory=o.NodeCanvasFactory=o.NodeCMapReaderFactory=void 0;var l=at(7);at(1);const R=function(D){return new Promise((m,O)=>{require$$5.readFile(D,(M,S)=>{if(M||!S){O(new Error(M));return}m(new Uint8Array(S))})})};class ht extends l.BaseFilterFactory{}o.NodeFilterFactory=ht;class q extends l.BaseCanvasFactory{_createCanvas(m,O){return require$$5.createCanvas(m,O)}}o.NodeCanvasFactory=q;class ut extends l.BaseCMapReaderFactory{_fetchData(m,O){return R(m).then(B=>({cMapData:B,compressionType:O}))}}o.NodeCMapReaderFactory=ut;class j extends l.BaseStandardFontDataFactory{_fetchData(m){return R(m)}}o.NodeStandardFontDataFactory=j},(ot,o,at)=>{var u,He,Y,We;Object.defineProperty(o,"__esModule",{value:!0}),o.CanvasGraphics=void 0;var l=at(1),R=at(6),ht=at(12),q=at(13);const ut=16,j=100,D=4096,m=15,O=10,B=1e3,M=16;function S(d,e){if(d._removeMirroring)throw new Error("Context is already forwarding operations.");d.__originalSave=d.save,d.__originalRestore=d.restore,d.__originalRotate=d.rotate,d.__originalScale=d.scale,d.__originalTranslate=d.translate,d.__originalTransform=d.transform,d.__originalSetTransform=d.setTransform,d.__originalResetTransform=d.resetTransform,d.__originalClip=d.clip,d.__originalMoveTo=d.moveTo,d.__originalLineTo=d.lineTo,d.__originalBezierCurveTo=d.bezierCurveTo,d.__originalRect=d.rect,d.__originalClosePath=d.closePath,d.__originalBeginPath=d.beginPath,d._removeMirroring=()=>{d.save=d.__originalSave,d.restore=d.__originalRestore,d.rotate=d.__originalRotate,d.scale=d.__originalScale,d.translate=d.__originalTranslate,d.transform=d.__originalTransform,d.setTransform=d.__originalSetTransform,d.resetTransform=d.__originalResetTransform,d.clip=d.__originalClip,d.moveTo=d.__originalMoveTo,d.lineTo=d.__originalLineTo,d.bezierCurveTo=d.__originalBezierCurveTo,d.rect=d.__originalRect,d.closePath=d.__originalClosePath,d.beginPath=d.__originalBeginPath,delete d._removeMirroring},d.save=function(){e.save(),this.__originalSave()},d.restore=function(){e.restore(),this.__originalRestore()},d.translate=function(c,C){e.translate(c,C),this.__originalTranslate(c,C)},d.scale=function(c,C){e.scale(c,C),this.__originalScale(c,C)},d.transform=function(c,C,y,N,H,K){e.transform(c,C,y,N,H,K),this.__originalTransform(c,C,y,N,H,K)},d.setTransform=function(c,C,y,N,H,K){e.setTransform(c,C,y,N,H,K),this.__originalSetTransform(c,C,y,N,H,K)},d.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},d.rotate=function(c){e.rotate(c),this.__originalRotate(c)},d.clip=function(c){e.clip(c),this.__originalClip(c)},d.moveTo=function(s,c){e.moveTo(s,c),this.__originalMoveTo(s,c)},d.lineTo=function(s,c){e.lineTo(s,c),this.__originalLineTo(s,c)},d.bezierCurveTo=function(s,c,C,y,N,H){e.bezierCurveTo(s,c,C,y,N,H),this.__originalBezierCurveTo(s,c,C,y,N,H)},d.rect=function(s,c,C,y){e.rect(s,c,C,y),this.__originalRect(s,c,C,y)},d.closePath=function(){e.closePath(),this.__originalClosePath()},d.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class v{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,s,c){let C;return this.cache[e]!==void 0?(C=this.cache[e],this.canvasFactory.reset(C,s,c)):(C=this.canvasFactory.create(s,c),this.cache[e]=C),C}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const s=this.cache[e];this.canvasFactory.destroy(s),delete this.cache[e]}}}function h(d,e,s,c,C,y,N,H,K,ft){const[lt,dt,pt,kt,wt,Lt]=(0,R.getCurrentTransform)(d);if(dt===0&&pt===0){const Bt=N*lt+wt,Ct=Math.round(Bt),st=H*kt+Lt,tt=Math.round(st),gt=(N+K)*lt+wt,Ft=Math.abs(Math.round(gt)-Ct)||1,Mt=(H+ft)*kt+Lt,Ht=Math.abs(Math.round(Mt)-tt)||1;return d.setTransform(Math.sign(lt),0,0,Math.sign(kt),Ct,tt),d.drawImage(e,s,c,C,y,0,0,Ft,Ht),d.setTransform(lt,dt,pt,kt,wt,Lt),[Ft,Ht]}if(lt===0&&kt===0){const Bt=H*pt+wt,Ct=Math.round(Bt),st=N*dt+Lt,tt=Math.round(st),gt=(H+ft)*pt+wt,Ft=Math.abs(Math.round(gt)-Ct)||1,Mt=(N+K)*dt+Lt,Ht=Math.abs(Math.round(Mt)-tt)||1;return d.setTransform(0,Math.sign(dt),Math.sign(pt),0,Ct,tt),d.drawImage(e,s,c,C,y,0,0,Ht,Ft),d.setTransform(lt,dt,pt,kt,wt,Lt),[Ht,Ft]}d.drawImage(e,s,c,C,y,N,H,K,ft);const Ut=Math.hypot(lt,dt),Pt=Math.hypot(pt,kt);return[Ut*K,Pt*ft]}function _(d){const{width:e,height:s}=d;if(e>B||s>B)return null;const c=1e3,C=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),y=e+1;let N=new Uint8Array(y*(s+1)),H,K,ft;const lt=e+7&-8;let dt=new Uint8Array(lt*s),pt=0;for(const Pt of d.data){let Bt=128;for(;Bt>0;)dt[pt++]=Pt&Bt?0:255,Bt>>=1}let kt=0;for(pt=0,dt[pt]!==0&&(N[0]=1,++kt),K=1;K<e;K++)dt[pt]!==dt[pt+1]&&(N[K]=dt[pt]?2:1,++kt),pt++;for(dt[pt]!==0&&(N[K]=2,++kt),H=1;H<s;H++){pt=H*lt,ft=H*y,dt[pt-lt]!==dt[pt]&&(N[ft]=dt[pt]?1:8,++kt);let Pt=(dt[pt]?4:0)+(dt[pt-lt]?8:0);for(K=1;K<e;K++)Pt=(Pt>>2)+(dt[pt+1]?4:0)+(dt[pt-lt+1]?8:0),C[Pt]&&(N[ft+K]=C[Pt],++kt),pt++;if(dt[pt-lt]!==dt[pt]&&(N[ft+K]=dt[pt]?2:4,++kt),kt>c)return null}for(pt=lt*(s-1),ft=H*y,dt[pt]!==0&&(N[ft]=8,++kt),K=1;K<e;K++)dt[pt]!==dt[pt+1]&&(N[ft+K]=dt[pt]?4:8,++kt),pt++;if(dt[pt]!==0&&(N[ft+K]=4,++kt),kt>c)return null;const wt=new Int32Array([0,y,-1,0,-y,0,0,0,1]),Lt=new Path2D;for(H=0;kt&&H<=s;H++){let Pt=H*y;const Bt=Pt+e;for(;Pt<Bt&&!N[Pt];)Pt++;if(Pt===Bt)continue;Lt.moveTo(Pt%y,H);const Ct=Pt;let st=N[Pt];do{const tt=wt[st];do Pt+=tt;while(!N[Pt]);const gt=N[Pt];gt!==5&&gt!==10?(st=gt,N[Pt]=0):(st=gt&51*st>>4,N[Pt]&=st>>2|st<<2),Lt.lineTo(Pt%y,Pt/y|0),N[Pt]||--kt}while(Ct!==Pt);--H}return dt=null,N=null,function(Pt){Pt.save(),Pt.scale(1/e,-1/s),Pt.translate(0,-s),Pt.fill(Lt),Pt.beginPath(),Pt.restore()}}class w{constructor(e,s){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=l.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=l.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=l.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,e,s])}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,s){this.x=e,this.y=s}updatePathMinMax(e,s,c){[s,c]=l.Util.applyTransform([s,c],e),this.minX=Math.min(this.minX,s),this.minY=Math.min(this.minY,c),this.maxX=Math.max(this.maxX,s),this.maxY=Math.max(this.maxY,c)}updateRectMinMax(e,s){const c=l.Util.applyTransform(s,e),C=l.Util.applyTransform(s.slice(2),e);this.minX=Math.min(this.minX,c[0],C[0]),this.minY=Math.min(this.minY,c[1],C[1]),this.maxX=Math.max(this.maxX,c[0],C[0]),this.maxY=Math.max(this.maxY,c[1],C[1])}updateScalingPathMinMax(e,s){l.Util.scaleMinMax(e,s),this.minX=Math.min(this.minX,s[0]),this.maxX=Math.max(this.maxX,s[1]),this.minY=Math.min(this.minY,s[2]),this.maxY=Math.max(this.maxY,s[3])}updateCurvePathMinMax(e,s,c,C,y,N,H,K,ft,lt){const dt=l.Util.bezierBoundingBox(s,c,C,y,N,H,K,ft);if(lt){lt[0]=Math.min(lt[0],dt[0],dt[2]),lt[1]=Math.max(lt[1],dt[0],dt[2]),lt[2]=Math.min(lt[2],dt[1],dt[3]),lt[3]=Math.max(lt[3],dt[1],dt[3]);return}this.updateRectMinMax(e,dt)}getPathBoundingBox(e=ht.PathType.FILL,s=null){const c=[this.minX,this.minY,this.maxX,this.maxY];if(e===ht.PathType.STROKE){s||(0,l.unreachable)("Stroke bounding box must include transform.");const C=l.Util.singularValueDecompose2dScale(s),y=C[0]*this.lineWidth/2,N=C[1]*this.lineWidth/2;c[0]-=y,c[1]-=N,c[2]+=y,c[3]+=N}return c}updateClipFromPath(){const e=l.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(e=ht.PathType.FILL,s=null){return l.Util.intersect(this.clipBox,this.getPathBoundingBox(e,s))}}function x(d,e){if(typeof ImageData<"u"&&e instanceof ImageData){d.putImageData(e,0,0);return}const s=e.height,c=e.width,C=s%M,y=(s-C)/M,N=C===0?y:y+1,H=d.createImageData(c,M);let K=0,ft;const lt=e.data,dt=H.data;let pt,kt,wt,Lt;if(e.kind===l.ImageKind.GRAYSCALE_1BPP){const Ut=lt.byteLength,Pt=new Uint32Array(dt.buffer,0,dt.byteLength>>2),Bt=Pt.length,Ct=c+7>>3,st=4294967295,tt=l.FeatureTest.isLittleEndian?4278190080:255;for(pt=0;pt<N;pt++){for(wt=pt<y?M:C,ft=0,kt=0;kt<wt;kt++){const gt=Ut-K;let Ft=0;const Mt=gt>Ct?c:gt*8-7,Ht=Mt&-8;let Wt=0,Rt=0;for(;Ft<Ht;Ft+=8)Rt=lt[K++],Pt[ft++]=Rt&128?st:tt,Pt[ft++]=Rt&64?st:tt,Pt[ft++]=Rt&32?st:tt,Pt[ft++]=Rt&16?st:tt,Pt[ft++]=Rt&8?st:tt,Pt[ft++]=Rt&4?st:tt,Pt[ft++]=Rt&2?st:tt,Pt[ft++]=Rt&1?st:tt;for(;Ft<Mt;Ft++)Wt===0&&(Rt=lt[K++],Wt=128),Pt[ft++]=Rt&Wt?st:tt,Wt>>=1}for(;ft<Bt;)Pt[ft++]=0;d.putImageData(H,0,pt*M)}}else if(e.kind===l.ImageKind.RGBA_32BPP){for(kt=0,Lt=c*M*4,pt=0;pt<y;pt++)dt.set(lt.subarray(K,K+Lt)),K+=Lt,d.putImageData(H,0,kt),kt+=M;pt<N&&(Lt=c*C*4,dt.set(lt.subarray(K,K+Lt)),d.putImageData(H,0,kt))}else if(e.kind===l.ImageKind.RGB_24BPP)for(wt=M,Lt=c*wt,pt=0;pt<N;pt++){for(pt>=y&&(wt=C,Lt=c*wt),ft=0,kt=Lt;kt--;)dt[ft++]=lt[K++],dt[ft++]=lt[K++],dt[ft++]=lt[K++],dt[ft++]=255;d.putImageData(H,0,pt*M)}else throw new Error(`bad image kind: ${e.kind}`)}function A(d,e){if(e.bitmap){d.drawImage(e.bitmap,0,0);return}const s=e.height,c=e.width,C=s%M,y=(s-C)/M,N=C===0?y:y+1,H=d.createImageData(c,M);let K=0;const ft=e.data,lt=H.data;for(let dt=0;dt<N;dt++){const pt=dt<y?M:C;({srcPos:K}=(0,q.convertBlackAndWhiteToRGBA)({src:ft,srcPos:K,dest:lt,width:c,height:pt,nonBlackColor:0})),d.putImageData(H,0,dt*M)}}function n(d,e){const s=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const c of s)d[c]!==void 0&&(e[c]=d[c]);d.setLineDash!==void 0&&(e.setLineDash(d.getLineDash()),e.lineDashOffset=d.lineDashOffset)}function r(d){if(d.strokeStyle=d.fillStyle="#000000",d.fillRule="nonzero",d.globalAlpha=1,d.lineWidth=1,d.lineCap="butt",d.lineJoin="miter",d.miterLimit=10,d.globalCompositeOperation="source-over",d.font="10px sans-serif",d.setLineDash!==void 0&&(d.setLineDash([]),d.lineDashOffset=0),!l.isNodeJS){const{filter:e}=d;e!=="none"&&e!==""&&(d.filter="none")}}function F(d,e,s,c){const C=d.length;for(let y=3;y<C;y+=4){const N=d[y];if(N===0)d[y-3]=e,d[y-2]=s,d[y-1]=c;else if(N<255){const H=255-N;d[y-3]=d[y-3]*N+e*H>>8,d[y-2]=d[y-2]*N+s*H>>8,d[y-1]=d[y-1]*N+c*H>>8}}}function f(d,e,s){const c=d.length,C=1/255;for(let y=3;y<c;y+=4){const N=s?s[d[y]]:d[y];e[y]=e[y]*N*C|0}}function i(d,e,s){const c=d.length;for(let C=3;C<c;C+=4){const y=d[C-3]*77+d[C-2]*152+d[C-1]*28;e[C]=s?e[C]*s[y>>8]>>8:e[C]*y>>16}}function P(d,e,s,c,C,y,N,H,K,ft,lt){const dt=!!y,pt=dt?y[0]:0,kt=dt?y[1]:0,wt=dt?y[2]:0,Lt=C==="Luminosity"?i:f,Pt=Math.min(c,Math.ceil(1048576/s));for(let Bt=0;Bt<c;Bt+=Pt){const Ct=Math.min(Pt,c-Bt),st=d.getImageData(H-ft,Bt+(K-lt),s,Ct),tt=e.getImageData(H,Bt+K,s,Ct);dt&&F(st.data,pt,kt,wt),Lt(st.data,tt.data,N),e.putImageData(tt,H,Bt+K)}}function g(d,e,s,c){const C=c[0],y=c[1],N=c[2]-C,H=c[3]-y;N===0||H===0||(P(e.context,s,N,H,e.subtype,e.backdrop,e.transferMap,C,y,e.offsetX,e.offsetY),d.save(),d.globalAlpha=1,d.globalCompositeOperation="source-over",d.setTransform(1,0,0,1,0,0),d.drawImage(s.canvas,0,0),d.restore())}function W(d,e){const s=l.Util.singularValueDecompose2dScale(d);s[0]=Math.fround(s[0]),s[1]=Math.fround(s[1]);const c=Math.fround((globalThis.devicePixelRatio||1)*R.PixelsPerInch.PDF_TO_CSS_UNITS);return e!==void 0?e:s[0]<=c||s[1]<=c}const V=["butt","round","square"],E=["miter","round","bevel"],z={},nt={},_t=class _t{constructor(e,s,c,C,y,{optionalContentConfig:N,markedContentStack:H=null},K,ft){I(this,u);I(this,Y);this.ctx=e,this.current=new w(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=s,this.objs=c,this.canvasFactory=C,this.filterFactory=y,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=H||[],this.optionalContentConfig=N,this.cachedCanvases=new v(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=K,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=ft,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,s=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):s}beginDrawing({transform:e,viewport:s,transparency:c=!1,background:C=null}){const y=this.ctx.canvas.width,N=this.ctx.canvas.height,H=this.ctx.fillStyle;if(this.ctx.fillStyle=C||"#ffffff",this.ctx.fillRect(0,0,y,N),this.ctx.fillStyle=H,c){const K=this.cachedCanvases.getCanvas("transparent",y,N);this.compositeCtx=this.ctx,this.transparentCanvas=K.canvas,this.ctx=K.context,this.ctx.save(),this.ctx.transform(...(0,R.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),r(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...s.transform),this.viewportScale=s.scale,this.baseTransform=(0,R.getCurrentTransform)(this.ctx)}executeOperatorList(e,s,c,C){const y=e.argsArray,N=e.fnArray;let H=s||0;const K=y.length;if(K===H)return H;const ft=K-H>O&&typeof c=="function",lt=ft?Date.now()+m:0;let dt=0;const pt=this.commonObjs,kt=this.objs;let wt;for(;;){if(C!==void 0&&H===C.nextBreakPoint)return C.breakIt(H,c),H;if(wt=N[H],wt!==l.OPS.dependency)this[wt].apply(this,y[H]);else for(const Lt of y[H]){const Ut=Lt.startsWith("g_")?pt:kt;if(!Ut.has(Lt))return Ut.get(Lt,c),H}if(H++,H===K)return H;if(ft&&++dt>O){if(Date.now()>lt)return c(),H;dt=0}}}endDrawing(){X(this,u,He).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const s of e.values())typeof HTMLCanvasElement<"u"&&s instanceof HTMLCanvasElement&&(s.width=s.height=0);e.clear()}this._cachedBitmapsMap.clear(),X(this,Y,We).call(this)}_scaleImage(e,s){const c=e.width,C=e.height;let y=Math.max(Math.hypot(s[0],s[1]),1),N=Math.max(Math.hypot(s[2],s[3]),1),H=c,K=C,ft="prescale1",lt,dt;for(;y>2&&H>1||N>2&&K>1;){let pt=H,kt=K;y>2&&H>1&&(pt=H>=16384?Math.floor(H/2)-1||1:Math.ceil(H/2),y/=H/pt),N>2&&K>1&&(kt=K>=16384?Math.floor(K/2)-1||1:Math.ceil(K)/2,N/=K/kt),lt=this.cachedCanvases.getCanvas(ft,pt,kt),dt=lt.context,dt.clearRect(0,0,pt,kt),dt.drawImage(e,0,0,H,K,0,0,pt,kt),e=lt.canvas,H=pt,K=kt,ft=ft==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:H,paintHeight:K}}_createMaskCanvas(e){const s=this.ctx,{width:c,height:C}=e,y=this.current.fillColor,N=this.current.patternFill,H=(0,R.getCurrentTransform)(s);let K,ft,lt,dt;if((e.bitmap||e.data)&&e.count>1){const Ft=e.bitmap||e.data.buffer;ft=JSON.stringify(N?H:[H.slice(0,4),y]),K=this._cachedBitmapsMap.get(Ft),K||(K=new Map,this._cachedBitmapsMap.set(Ft,K));const Mt=K.get(ft);if(Mt&&!N){const Ht=Math.round(Math.min(H[0],H[2])+H[4]),Wt=Math.round(Math.min(H[1],H[3])+H[5]);return{canvas:Mt,offsetX:Ht,offsetY:Wt}}lt=Mt}lt||(dt=this.cachedCanvases.getCanvas("maskCanvas",c,C),A(dt.context,e));let pt=l.Util.transform(H,[1/c,0,0,-1/C,0,0]);pt=l.Util.transform(pt,[1,0,0,1,0,-C]);const kt=l.Util.applyTransform([0,0],pt),wt=l.Util.applyTransform([c,C],pt),Lt=l.Util.normalizeRect([kt[0],kt[1],wt[0],wt[1]]),Ut=Math.round(Lt[2]-Lt[0])||1,Pt=Math.round(Lt[3]-Lt[1])||1,Bt=this.cachedCanvases.getCanvas("fillCanvas",Ut,Pt),Ct=Bt.context,st=Math.min(kt[0],wt[0]),tt=Math.min(kt[1],wt[1]);Ct.translate(-st,-tt),Ct.transform(...pt),lt||(lt=this._scaleImage(dt.canvas,(0,R.getCurrentTransformInverse)(Ct)),lt=lt.img,K&&N&&K.set(ft,lt)),Ct.imageSmoothingEnabled=W((0,R.getCurrentTransform)(Ct),e.interpolate),h(Ct,lt,0,0,lt.width,lt.height,0,0,c,C),Ct.globalCompositeOperation="source-in";const gt=l.Util.transform((0,R.getCurrentTransformInverse)(Ct),[1,0,0,1,-st,-tt]);return Ct.fillStyle=N?y.getPattern(s,this,gt,ht.PathType.FILL):y,Ct.fillRect(0,0,c,C),K&&!N&&(this.cachedCanvases.delete("fillCanvas"),K.set(ft,Bt.canvas)),{canvas:Bt.canvas,offsetX:Math.round(st),offsetY:Math.round(tt)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=V[e]}setLineJoin(e){this.ctx.lineJoin=E[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,s){const c=this.ctx;c.setLineDash!==void 0&&(c.setLineDash(e),c.lineDashOffset=s)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[s,c]of e)switch(s){case"LW":this.setLineWidth(c);break;case"LC":this.setLineCap(c);break;case"LJ":this.setLineJoin(c);break;case"ML":this.setMiterLimit(c);break;case"D":this.setDash(c[0],c[1]);break;case"RI":this.setRenderingIntent(c);break;case"FL":this.setFlatness(c);break;case"Font":this.setFont(c[0],c[1]);break;case"CA":this.current.strokeAlpha=c;break;case"ca":this.current.fillAlpha=c,this.ctx.globalAlpha=c;break;case"BM":this.ctx.globalCompositeOperation=c;break;case"SMask":this.current.activeSMask=c?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(c);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,s=this.ctx.canvas.height,c="smaskGroupAt"+this.groupLevel,C=this.cachedCanvases.getCanvas(c,e,s);this.suspendedCtx=this.ctx,this.ctx=C.context;const y=this.ctx;y.setTransform(...(0,R.getCurrentTransform)(this.suspendedCtx)),n(this.suspendedCtx,y),S(y,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),n(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const s=this.current.activeSMask,c=this.suspendedCtx;g(c,s,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(n(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),n(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(e,s,c,C,y,N){this.ctx.transform(e,s,c,C,y,N),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,s,c){const C=this.ctx,y=this.current;let N=y.x,H=y.y,K,ft;const lt=(0,R.getCurrentTransform)(C),dt=lt[0]===0&&lt[3]===0||lt[1]===0&&lt[2]===0,pt=dt?c.slice(0):null;for(let kt=0,wt=0,Lt=e.length;kt<Lt;kt++)switch(e[kt]|0){case l.OPS.rectangle:N=s[wt++],H=s[wt++];const Ut=s[wt++],Pt=s[wt++],Bt=N+Ut,Ct=H+Pt;C.moveTo(N,H),Ut===0||Pt===0?C.lineTo(Bt,Ct):(C.lineTo(Bt,H),C.lineTo(Bt,Ct),C.lineTo(N,Ct)),dt||y.updateRectMinMax(lt,[N,H,Bt,Ct]),C.closePath();break;case l.OPS.moveTo:N=s[wt++],H=s[wt++],C.moveTo(N,H),dt||y.updatePathMinMax(lt,N,H);break;case l.OPS.lineTo:N=s[wt++],H=s[wt++],C.lineTo(N,H),dt||y.updatePathMinMax(lt,N,H);break;case l.OPS.curveTo:K=N,ft=H,N=s[wt+4],H=s[wt+5],C.bezierCurveTo(s[wt],s[wt+1],s[wt+2],s[wt+3],N,H),y.updateCurvePathMinMax(lt,K,ft,s[wt],s[wt+1],s[wt+2],s[wt+3],N,H,pt),wt+=6;break;case l.OPS.curveTo2:K=N,ft=H,C.bezierCurveTo(N,H,s[wt],s[wt+1],s[wt+2],s[wt+3]),y.updateCurvePathMinMax(lt,K,ft,N,H,s[wt],s[wt+1],s[wt+2],s[wt+3],pt),N=s[wt+2],H=s[wt+3],wt+=4;break;case l.OPS.curveTo3:K=N,ft=H,N=s[wt+2],H=s[wt+3],C.bezierCurveTo(s[wt],s[wt+1],N,H,N,H),y.updateCurvePathMinMax(lt,K,ft,s[wt],s[wt+1],N,H,N,H,pt),wt+=4;break;case l.OPS.closePath:C.closePath();break}dt&&y.updateScalingPathMinMax(lt,pt),y.setCurrentPoint(N,H)}closePath(){this.ctx.closePath()}stroke(e=!0){const s=this.ctx,c=this.current.strokeColor;s.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof c=="object"&&(c!=null&&c.getPattern)?(s.save(),s.strokeStyle=c.getPattern(s,this,(0,R.getCurrentTransformInverse)(s),ht.PathType.STROKE),this.rescaleAndStroke(!1),s.restore()):this.rescaleAndStroke(!0)),e&&this.consumePath(this.current.getClippedPathBoundingBox()),s.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(e=!0){const s=this.ctx,c=this.current.fillColor,C=this.current.patternFill;let y=!1;C&&(s.save(),s.fillStyle=c.getPattern(s,this,(0,R.getCurrentTransformInverse)(s),ht.PathType.FILL),y=!0);const N=this.current.getClippedPathBoundingBox();this.contentVisible&&N!==null&&(this.pendingEOFill?(s.fill("evenodd"),this.pendingEOFill=!1):s.fill()),y&&s.restore(),e&&this.consumePath(N)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=z}eoClip(){this.pendingClip=nt}beginText(){this.current.textMatrix=l.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,s=this.ctx;if(e===void 0){s.beginPath();return}s.save(),s.beginPath();for(const c of e)s.setTransform(...c.transform),s.translate(c.x,c.y),c.addToPath(s,c.fontSize);s.restore(),s.clip(),s.beginPath(),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,s){var lt;const c=this.commonObjs.get(e),C=this.current;if(!c)throw new Error(`Can't find font for ${e}`);if(C.fontMatrix=c.fontMatrix||l.FONT_IDENTITY_MATRIX,(C.fontMatrix[0]===0||C.fontMatrix[3]===0)&&(0,l.warn)("Invalid font matrix for font "+e),s<0?(s=-s,C.fontDirection=-1):C.fontDirection=1,this.current.font=c,this.current.fontSize=s,c.isType3Font)return;const y=c.loadedName||"sans-serif",N=((lt=c.systemFontInfo)==null?void 0:lt.css)||`"${y}", ${c.fallbackName}`;let H="normal";c.black?H="900":c.bold&&(H="bold");const K=c.italic?"italic":"normal";let ft=s;s<ut?ft=ut:s>j&&(ft=j),this.current.fontSizeScale=s/ft,this.ctx.font=`${K} ${H} ${ft}px ${N}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,s){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=s}setLeadingMoveText(e,s){this.setLeading(-s),this.moveText(e,s)}setTextMatrix(e,s,c,C,y,N){this.current.textMatrix=[e,s,c,C,y,N],this.current.textMatrixScale=Math.hypot(e,s),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,s,c,C){const y=this.ctx,N=this.current,H=N.font,K=N.textRenderingMode,ft=N.fontSize/N.fontSizeScale,lt=K&l.TextRenderingMode.FILL_STROKE_MASK,dt=!!(K&l.TextRenderingMode.ADD_TO_PATH_FLAG),pt=N.patternFill&&!H.missingFile;let kt;(H.disableFontFace||dt||pt)&&(kt=H.getPathGenerator(this.commonObjs,e)),H.disableFontFace||pt?(y.save(),y.translate(s,c),y.beginPath(),kt(y,ft),C&&y.setTransform(...C),(lt===l.TextRenderingMode.FILL||lt===l.TextRenderingMode.FILL_STROKE)&&y.fill(),(lt===l.TextRenderingMode.STROKE||lt===l.TextRenderingMode.FILL_STROKE)&&y.stroke(),y.restore()):((lt===l.TextRenderingMode.FILL||lt===l.TextRenderingMode.FILL_STROKE)&&y.fillText(e,s,c),(lt===l.TextRenderingMode.STROKE||lt===l.TextRenderingMode.FILL_STROKE)&&y.strokeText(e,s,c)),dt&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,R.getCurrentTransform)(y),x:s,y:c,fontSize:ft,addToPath:kt})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const s=e.getImageData(0,0,10,10).data;let c=!1;for(let C=3;C<s.length;C+=4)if(s[C]>0&&s[C]<255){c=!0;break}return(0,l.shadow)(this,"isFontSubpixelAAEnabled",c)}showText(e){const s=this.current,c=s.font;if(c.isType3Font)return this.showType3Text(e);const C=s.fontSize;if(C===0)return;const y=this.ctx,N=s.fontSizeScale,H=s.charSpacing,K=s.wordSpacing,ft=s.fontDirection,lt=s.textHScale*ft,dt=e.length,pt=c.vertical,kt=pt?1:-1,wt=c.defaultVMetrics,Lt=C*s.fontMatrix[0],Ut=s.textRenderingMode===l.TextRenderingMode.FILL&&!c.disableFontFace&&!s.patternFill;y.save(),y.transform(...s.textMatrix),y.translate(s.x,s.y+s.textRise),ft>0?y.scale(lt,-1):y.scale(lt,1);let Pt;if(s.patternFill){y.save();const gt=s.fillColor.getPattern(y,this,(0,R.getCurrentTransformInverse)(y),ht.PathType.FILL);Pt=(0,R.getCurrentTransform)(y),y.restore(),y.fillStyle=gt}let Bt=s.lineWidth;const Ct=s.textMatrixScale;if(Ct===0||Bt===0){const gt=s.textRenderingMode&l.TextRenderingMode.FILL_STROKE_MASK;(gt===l.TextRenderingMode.STROKE||gt===l.TextRenderingMode.FILL_STROKE)&&(Bt=this.getSinglePixelWidth())}else Bt/=Ct;if(N!==1&&(y.scale(N,N),Bt/=N),y.lineWidth=Bt,c.isInvalidPDFjsFont){const gt=[];let Ft=0;for(const Mt of e)gt.push(Mt.unicode),Ft+=Mt.width;y.fillText(gt.join(""),0,0),s.x+=Ft*Lt*lt,y.restore(),this.compose();return}let st=0,tt;for(tt=0;tt<dt;++tt){const gt=e[tt];if(typeof gt=="number"){st+=kt*gt*C/1e3;continue}let Ft=!1;const Mt=(gt.isSpace?K:0)+H,Ht=gt.fontChar,Wt=gt.accent;let Rt,Dt,Gt=gt.width;if(pt){const mt=gt.vmetric||wt,G=-(gt.vmetric?mt[1]:Gt*.5)*Lt,J=mt[2]*Lt;Gt=mt?-mt[0]:Gt,Rt=G/N,Dt=(st+J)/N}else Rt=st/N,Dt=0;if(c.remeasure&&Gt>0){const mt=y.measureText(Ht).width*1e3/C*N;if(Gt<mt&&this.isFontSubpixelAAEnabled){const G=Gt/mt;Ft=!0,y.save(),y.scale(G,1),Rt/=G}else Gt!==mt&&(Rt+=(Gt-mt)/2e3*C/N)}if(this.contentVisible&&(gt.isInFont||c.missingFile)){if(Ut&&!Wt)y.fillText(Ht,Rt,Dt);else if(this.paintChar(Ht,Rt,Dt,Pt),Wt){const mt=Rt+C*Wt.offset.x/N,G=Dt-C*Wt.offset.y/N;this.paintChar(Wt.fontChar,mt,G,Pt)}}const jt=pt?Gt*Lt-Mt*ft:Gt*Lt+Mt*ft;st+=jt,Ft&&y.restore()}pt?s.y-=st:s.x+=st*lt,y.restore(),this.compose()}showType3Text(e){const s=this.ctx,c=this.current,C=c.font,y=c.fontSize,N=c.fontDirection,H=C.vertical?1:-1,K=c.charSpacing,ft=c.wordSpacing,lt=c.textHScale*N,dt=c.fontMatrix||l.FONT_IDENTITY_MATRIX,pt=e.length,kt=c.textRenderingMode===l.TextRenderingMode.INVISIBLE;let wt,Lt,Ut,Pt;if(!(kt||y===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,s.save(),s.transform(...c.textMatrix),s.translate(c.x,c.y),s.scale(lt,N),wt=0;wt<pt;++wt){if(Lt=e[wt],typeof Lt=="number"){Pt=H*Lt*y/1e3,this.ctx.translate(Pt,0),c.x+=Pt*lt;continue}const Bt=(Lt.isSpace?ft:0)+K,Ct=C.charProcOperatorList[Lt.operatorListId];if(!Ct){(0,l.warn)(`Type3 character "${Lt.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=Lt,this.save(),s.scale(y,y),s.transform(...dt),this.executeOperatorList(Ct),this.restore()),Ut=l.Util.applyTransform([Lt.width,0],dt)[0]*y+Bt,s.translate(Ut,0),c.x+=Ut*lt}s.restore(),this.processingType3=null}}setCharWidth(e,s){}setCharWidthAndBounds(e,s,c,C,y,N){this.ctx.rect(c,C,y-c,N-C),this.ctx.clip(),this.endPath()}getColorN_Pattern(e){let s;if(e[0]==="TilingPattern"){const c=e[1],C=this.baseTransform||(0,R.getCurrentTransform)(this.ctx),y={createCanvasGraphics:N=>new _t(N,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};s=new ht.TilingPattern(e,c,this.ctx,y,C)}else s=this._getPattern(e[1],e[2]);return s}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e,s,c){const C=l.Util.makeHexColor(e,s,c);this.ctx.strokeStyle=C,this.current.strokeColor=C}setFillRGBColor(e,s,c){const C=l.Util.makeHexColor(e,s,c);this.ctx.fillStyle=C,this.current.fillColor=C,this.current.patternFill=!1}_getPattern(e,s=null){let c;return this.cachedPatterns.has(e)?c=this.cachedPatterns.get(e):(c=(0,ht.getShadingPattern)(this.getObject(e)),this.cachedPatterns.set(e,c)),s&&(c.matrix=s),c}shadingFill(e){if(!this.contentVisible)return;const s=this.ctx;this.save();const c=this._getPattern(e);s.fillStyle=c.getPattern(s,this,(0,R.getCurrentTransformInverse)(s),ht.PathType.SHADING);const C=(0,R.getCurrentTransformInverse)(s);if(C){const{width:y,height:N}=s.canvas,[H,K,ft,lt]=l.Util.getAxialAlignedBoundingBox([0,0,y,N],C);this.ctx.fillRect(H,K,ft-H,lt-K)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,l.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,l.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(e,s){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(e)&&e.length===6&&this.transform(...e),this.baseTransform=(0,R.getCurrentTransform)(this.ctx),s)){const c=s[2]-s[0],C=s[3]-s[1];this.ctx.rect(s[0],s[1],c,C),this.current.updateRectMinMax((0,R.getCurrentTransform)(this.ctx),s),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const s=this.ctx;e.isolated||(0,l.info)("TODO: Support non-isolated groups."),e.knockout&&(0,l.warn)("Knockout groups not supported.");const c=(0,R.getCurrentTransform)(s);if(e.matrix&&s.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let C=l.Util.getAxialAlignedBoundingBox(e.bbox,(0,R.getCurrentTransform)(s));const y=[0,0,s.canvas.width,s.canvas.height];C=l.Util.intersect(C,y)||[0,0,0,0];const N=Math.floor(C[0]),H=Math.floor(C[1]);let K=Math.max(Math.ceil(C[2])-N,1),ft=Math.max(Math.ceil(C[3])-H,1),lt=1,dt=1;K>D&&(lt=K/D,K=D),ft>D&&(dt=ft/D,ft=D),this.current.startNewPathAndClipBox([0,0,K,ft]);let pt="groupAt"+this.groupLevel;e.smask&&(pt+="_smask_"+this.smaskCounter++%2);const kt=this.cachedCanvases.getCanvas(pt,K,ft),wt=kt.context;wt.scale(1/lt,1/dt),wt.translate(-N,-H),wt.transform(...c),e.smask?this.smaskStack.push({canvas:kt.canvas,context:wt,offsetX:N,offsetY:H,scaleX:lt,scaleY:dt,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(s.setTransform(1,0,0,1,0,0),s.translate(N,H),s.scale(lt,dt),s.save()),n(s,wt),this.ctx=wt,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(s),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const s=this.ctx,c=this.groupStack.pop();if(this.ctx=c,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const C=(0,R.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...C);const y=l.Util.getAxialAlignedBoundingBox([0,0,s.canvas.width,s.canvas.height],C);this.ctx.drawImage(s.canvas,0,0),this.ctx.restore(),this.compose(y)}}beginAnnotation(e,s,c,C,y){if(X(this,u,He).call(this),r(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(s)&&s.length===4){const N=s[2]-s[0],H=s[3]-s[1];if(y&&this.annotationCanvasMap){c=c.slice(),c[4]-=s[0],c[5]-=s[1],s=s.slice(),s[0]=s[1]=0,s[2]=N,s[3]=H;const[K,ft]=l.Util.singularValueDecompose2dScale((0,R.getCurrentTransform)(this.ctx)),{viewportScale:lt}=this,dt=Math.ceil(N*this.outputScaleX*lt),pt=Math.ceil(H*this.outputScaleY*lt);this.annotationCanvas=this.canvasFactory.create(dt,pt);const{canvas:kt,context:wt}=this.annotationCanvas;this.annotationCanvasMap.set(e,kt),this.annotationCanvas.savedCtx=this.ctx,this.ctx=wt,this.ctx.save(),this.ctx.setTransform(K,0,0,-ft,0,H*ft),r(this.ctx)}else r(this.ctx),this.ctx.rect(s[0],s[1],N,H),this.ctx.clip(),this.endPath()}this.current=new w(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...c),this.transform(...C)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),X(this,Y,We).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const s=e.count;e=this.getObject(e.data,e),e.count=s;const c=this.ctx,C=this.processingType3;if(C&&(C.compiled===void 0&&(C.compiled=_(e)),C.compiled)){C.compiled(c);return}const y=this._createMaskCanvas(e),N=y.canvas;c.save(),c.setTransform(1,0,0,1,0,0),c.drawImage(N,y.offsetX,y.offsetY),c.restore(),this.compose()}paintImageMaskXObjectRepeat(e,s,c=0,C=0,y,N){if(!this.contentVisible)return;e=this.getObject(e.data,e);const H=this.ctx;H.save();const K=(0,R.getCurrentTransform)(H);H.transform(s,c,C,y,0,0);const ft=this._createMaskCanvas(e);H.setTransform(1,0,0,1,ft.offsetX-K[4],ft.offsetY-K[5]);for(let lt=0,dt=N.length;lt<dt;lt+=2){const pt=l.Util.transform(K,[s,c,C,y,N[lt],N[lt+1]]),[kt,wt]=l.Util.applyTransform([0,0],pt);H.drawImage(ft.canvas,kt,wt)}H.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const s=this.ctx,c=this.current.fillColor,C=this.current.patternFill;for(const y of e){const{data:N,width:H,height:K,transform:ft}=y,lt=this.cachedCanvases.getCanvas("maskCanvas",H,K),dt=lt.context;dt.save();const pt=this.getObject(N,y);A(dt,pt),dt.globalCompositeOperation="source-in",dt.fillStyle=C?c.getPattern(dt,this,(0,R.getCurrentTransformInverse)(s),ht.PathType.FILL):c,dt.fillRect(0,0,H,K),dt.restore(),s.save(),s.transform(...ft),s.scale(1,-1),h(s,lt.canvas,0,0,H,K,0,-1,1,1),s.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const s=this.getObject(e);if(!s){(0,l.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(s)}paintImageXObjectRepeat(e,s,c,C){if(!this.contentVisible)return;const y=this.getObject(e);if(!y){(0,l.warn)("Dependent image isn't ready yet");return}const N=y.width,H=y.height,K=[];for(let ft=0,lt=C.length;ft<lt;ft+=2)K.push({transform:[s,0,0,c,C[ft],C[ft+1]],x:0,y:0,w:N,h:H});this.paintInlineImageXObjectGroup(y,K)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:s,width:c,height:C}=e,y=this.cachedCanvases.getCanvas("inlineImage",c,C),N=y.context;return N.filter=this.current.transferMaps,N.drawImage(s,0,0),N.filter="none",y.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const s=e.width,c=e.height,C=this.ctx;if(this.save(),!l.isNodeJS){const{filter:H}=C;H!=="none"&&H!==""&&(C.filter="none")}C.scale(1/s,-1/c);let y;if(e.bitmap)y=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)y=e;else{const K=this.cachedCanvases.getCanvas("inlineImage",s,c).context;x(K,e),y=this.applyTransferMapsToCanvas(K)}const N=this._scaleImage(y,(0,R.getCurrentTransformInverse)(C));C.imageSmoothingEnabled=W((0,R.getCurrentTransform)(C),e.interpolate),h(C,N.img,0,0,N.paintWidth,N.paintHeight,0,-c,s,c),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,s){if(!this.contentVisible)return;const c=this.ctx;let C;if(e.bitmap)C=e.bitmap;else{const y=e.width,N=e.height,K=this.cachedCanvases.getCanvas("inlineImage",y,N).context;x(K,e),C=this.applyTransferMapsToCanvas(K)}for(const y of s)c.save(),c.transform(...y.transform),c.scale(1,-1),h(c,C,y.x,y.y,y.w,y.h,0,-1,1,1),c.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,s){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,s){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(s)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e){const s=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const c=this.ctx;this.pendingClip&&(s||(this.pendingClip===nt?c.clip("evenodd"):c.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),c.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=(0,R.getCurrentTransform)(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const s=Math.abs(e[0]*e[3]-e[2]*e[1]),c=Math.hypot(e[0],e[2]),C=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(c,C)/s}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:s,b:c,c:C,d:y}=this.ctx.getTransform();let N,H;if(c===0&&C===0){const K=Math.abs(s),ft=Math.abs(y);if(K===ft)if(e===0)N=H=1/K;else{const lt=K*e;N=H=lt<1?1/lt:1}else if(e===0)N=1/K,H=1/ft;else{const lt=K*e,dt=ft*e;N=lt<1?1/lt:1,H=dt<1?1/dt:1}}else{const K=Math.abs(s*y-c*C),ft=Math.hypot(s,c),lt=Math.hypot(C,y);if(e===0)N=lt/K,H=ft/K;else{const dt=e*K;N=lt>dt?lt/dt:1,H=ft>dt?ft/dt:1}}this._cachedScaleForStroking[0]=N,this._cachedScaleForStroking[1]=H}return this._cachedScaleForStroking}rescaleAndStroke(e){const{ctx:s}=this,{lineWidth:c}=this.current,[C,y]=this.getScaleForStroking();if(s.lineWidth=c||1,C===1&&y===1){s.stroke();return}const N=s.getLineDash();if(e&&s.save(),s.scale(C,y),N.length>0){const H=Math.max(C,y);s.setLineDash(N.map(K=>K/H)),s.lineDashOffset/=H}s.stroke(),e&&s.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};u=new WeakSet,He=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},Y=new WeakSet,We=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const s=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=s}}};let ct=_t;o.CanvasGraphics=ct;for(const d in l.OPS)ct.prototype[d]!==void 0&&(ct.prototype[l.OPS[d]]=ct.prototype[d])},(ot,o,at)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.TilingPattern=o.PathType=void 0,o.getShadingPattern=M;var l=at(1),R=at(6);const ht={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};o.PathType=ht;function q(_,w){if(!w)return;const x=w[2]-w[0],A=w[3]-w[1],n=new Path2D;n.rect(w[0],w[1],x,A),_.clip(n)}class ut{constructor(){this.constructor===ut&&(0,l.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,l.unreachable)("Abstract method `getPattern` called.")}}class j extends ut{constructor(w){super(),this._type=w[1],this._bbox=w[2],this._colorStops=w[3],this._p0=w[4],this._p1=w[5],this._r0=w[6],this._r1=w[7],this.matrix=null}_createGradient(w){let x;this._type==="axial"?x=w.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(x=w.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const A of this._colorStops)x.addColorStop(A[0],A[1]);return x}getPattern(w,x,A,n){let r;if(n===ht.STROKE||n===ht.FILL){const F=x.current.getClippedPathBoundingBox(n,(0,R.getCurrentTransform)(w))||[0,0,0,0],f=Math.ceil(F[2]-F[0])||1,i=Math.ceil(F[3]-F[1])||1,P=x.cachedCanvases.getCanvas("pattern",f,i,!0),g=P.context;g.clearRect(0,0,g.canvas.width,g.canvas.height),g.beginPath(),g.rect(0,0,g.canvas.width,g.canvas.height),g.translate(-F[0],-F[1]),A=l.Util.transform(A,[1,0,0,1,F[0],F[1]]),g.transform(...x.baseTransform),this.matrix&&g.transform(...this.matrix),q(g,this._bbox),g.fillStyle=this._createGradient(g),g.fill(),r=w.createPattern(P.canvas,"no-repeat");const W=new DOMMatrix(A);r.setTransform(W)}else q(w,this._bbox),r=this._createGradient(w);return r}}function D(_,w,x,A,n,r,F,f){const i=w.coords,P=w.colors,g=_.data,W=_.width*4;let V;i[x+1]>i[A+1]&&(V=x,x=A,A=V,V=r,r=F,F=V),i[A+1]>i[n+1]&&(V=A,A=n,n=V,V=F,F=f,f=V),i[x+1]>i[A+1]&&(V=x,x=A,A=V,V=r,r=F,F=V);const E=(i[x]+w.offsetX)*w.scaleX,z=(i[x+1]+w.offsetY)*w.scaleY,nt=(i[A]+w.offsetX)*w.scaleX,ct=(i[A+1]+w.offsetY)*w.scaleY,u=(i[n]+w.offsetX)*w.scaleX,L=(i[n+1]+w.offsetY)*w.scaleY;if(z>=L)return;const Y=P[r],rt=P[r+1],_t=P[r+2],d=P[F],e=P[F+1],s=P[F+2],c=P[f],C=P[f+1],y=P[f+2],N=Math.round(z),H=Math.round(L);let K,ft,lt,dt,pt,kt,wt,Lt;for(let Ut=N;Ut<=H;Ut++){if(Ut<ct){const tt=Ut<z?0:(z-Ut)/(z-ct);K=E-(E-nt)*tt,ft=Y-(Y-d)*tt,lt=rt-(rt-e)*tt,dt=_t-(_t-s)*tt}else{let tt;Ut>L?tt=1:ct===L?tt=0:tt=(ct-Ut)/(ct-L),K=nt-(nt-u)*tt,ft=d-(d-c)*tt,lt=e-(e-C)*tt,dt=s-(s-y)*tt}let Pt;Ut<z?Pt=0:Ut>L?Pt=1:Pt=(z-Ut)/(z-L),pt=E-(E-u)*Pt,kt=Y-(Y-c)*Pt,wt=rt-(rt-C)*Pt,Lt=_t-(_t-y)*Pt;const Bt=Math.round(Math.min(K,pt)),Ct=Math.round(Math.max(K,pt));let st=W*Ut+Bt*4;for(let tt=Bt;tt<=Ct;tt++)Pt=(K-tt)/(K-pt),Pt<0?Pt=0:Pt>1&&(Pt=1),g[st++]=ft-(ft-kt)*Pt|0,g[st++]=lt-(lt-wt)*Pt|0,g[st++]=dt-(dt-Lt)*Pt|0,g[st++]=255}}function m(_,w,x){const A=w.coords,n=w.colors;let r,F;switch(w.type){case"lattice":const f=w.verticesPerRow,i=Math.floor(A.length/f)-1,P=f-1;for(r=0;r<i;r++){let g=r*f;for(let W=0;W<P;W++,g++)D(_,x,A[g],A[g+1],A[g+f],n[g],n[g+1],n[g+f]),D(_,x,A[g+f+1],A[g+1],A[g+f],n[g+f+1],n[g+1],n[g+f])}break;case"triangles":for(r=0,F=A.length;r<F;r+=3)D(_,x,A[r],A[r+1],A[r+2],n[r],n[r+1],n[r+2]);break;default:throw new Error("illegal figure")}}class O extends ut{constructor(w){super(),this._coords=w[2],this._colors=w[3],this._figures=w[4],this._bounds=w[5],this._bbox=w[7],this._background=w[8],this.matrix=null}_createMeshCanvas(w,x,A){const f=Math.floor(this._bounds[0]),i=Math.floor(this._bounds[1]),P=Math.ceil(this._bounds[2])-f,g=Math.ceil(this._bounds[3])-i,W=Math.min(Math.ceil(Math.abs(P*w[0]*1.1)),3e3),V=Math.min(Math.ceil(Math.abs(g*w[1]*1.1)),3e3),E=P/W,z=g/V,nt={coords:this._coords,colors:this._colors,offsetX:-f,offsetY:-i,scaleX:1/E,scaleY:1/z},ct=W+2*2,u=V+2*2,L=A.getCanvas("mesh",ct,u,!1),Y=L.context,rt=Y.createImageData(W,V);if(x){const d=rt.data;for(let e=0,s=d.length;e<s;e+=4)d[e]=x[0],d[e+1]=x[1],d[e+2]=x[2],d[e+3]=255}for(const d of this._figures)m(rt,d,nt);return Y.putImageData(rt,2,2),{canvas:L.canvas,offsetX:f-2*E,offsetY:i-2*z,scaleX:E,scaleY:z}}getPattern(w,x,A,n){q(w,this._bbox);let r;if(n===ht.SHADING)r=l.Util.singularValueDecompose2dScale((0,R.getCurrentTransform)(w));else if(r=l.Util.singularValueDecompose2dScale(x.baseTransform),this.matrix){const f=l.Util.singularValueDecompose2dScale(this.matrix);r=[r[0]*f[0],r[1]*f[1]]}const F=this._createMeshCanvas(r,n===ht.SHADING?null:this._background,x.cachedCanvases);return n!==ht.SHADING&&(w.setTransform(...x.baseTransform),this.matrix&&w.transform(...this.matrix)),w.translate(F.offsetX,F.offsetY),w.scale(F.scaleX,F.scaleY),w.createPattern(F.canvas,"no-repeat")}}class B extends ut{getPattern(){return"hotpink"}}function M(_){switch(_[0]){case"RadialAxial":return new j(_);case"Mesh":return new O(_);case"Dummy":return new B}throw new Error(`Unknown IR type: ${_[0]}`)}const S={COLORED:1,UNCOLORED:2},h=class h{constructor(w,x,A,n,r){this.operatorList=w[2],this.matrix=w[3]||[1,0,0,1,0,0],this.bbox=w[4],this.xstep=w[5],this.ystep=w[6],this.paintType=w[7],this.tilingType=w[8],this.color=x,this.ctx=A,this.canvasGraphicsFactory=n,this.baseTransform=r}createPatternCanvas(w){const x=this.operatorList,A=this.bbox,n=this.xstep,r=this.ystep,F=this.paintType,f=this.tilingType,i=this.color,P=this.canvasGraphicsFactory;(0,l.info)("TilingType: "+f);const g=A[0],W=A[1],V=A[2],E=A[3],z=l.Util.singularValueDecompose2dScale(this.matrix),nt=l.Util.singularValueDecompose2dScale(this.baseTransform),ct=[z[0]*nt[0],z[1]*nt[1]],u=this.getSizeAndScale(n,this.ctx.canvas.width,ct[0]),L=this.getSizeAndScale(r,this.ctx.canvas.height,ct[1]),Y=w.cachedCanvases.getCanvas("pattern",u.size,L.size,!0),rt=Y.context,_t=P.createCanvasGraphics(rt);_t.groupLevel=w.groupLevel,this.setFillAndStrokeStyleToContext(_t,F,i);let d=g,e=W,s=V,c=E;return g<0&&(d=0,s+=Math.abs(g)),W<0&&(e=0,c+=Math.abs(W)),rt.translate(-(u.scale*d),-(L.scale*e)),_t.transform(u.scale,0,0,L.scale,0,0),rt.save(),this.clipBbox(_t,d,e,s,c),_t.baseTransform=(0,R.getCurrentTransform)(_t.ctx),_t.executeOperatorList(x),_t.endDrawing(),{canvas:Y.canvas,scaleX:u.scale,scaleY:L.scale,offsetX:d,offsetY:e}}getSizeAndScale(w,x,A){w=Math.abs(w);const n=Math.max(h.MAX_PATTERN_SIZE,x);let r=Math.ceil(w*A);return r>=n?r=n:A=r/w,{scale:A,size:r}}clipBbox(w,x,A,n,r){const F=n-x,f=r-A;w.ctx.rect(x,A,F,f),w.current.updateRectMinMax((0,R.getCurrentTransform)(w.ctx),[x,A,n,r]),w.clip(),w.endPath()}setFillAndStrokeStyleToContext(w,x,A){const n=w.ctx,r=w.current;switch(x){case S.COLORED:const F=this.ctx;n.fillStyle=F.fillStyle,n.strokeStyle=F.strokeStyle,r.fillColor=F.fillStyle,r.strokeColor=F.strokeStyle;break;case S.UNCOLORED:const f=l.Util.makeHexColor(A[0],A[1],A[2]);n.fillStyle=f,n.strokeStyle=f,r.fillColor=f,r.strokeColor=f;break;default:throw new l.FormatError(`Unsupported paint type: ${x}`)}}getPattern(w,x,A,n){let r=A;n!==ht.SHADING&&(r=l.Util.transform(r,x.baseTransform),this.matrix&&(r=l.Util.transform(r,this.matrix)));const F=this.createPatternCanvas(x);let f=new DOMMatrix(r);f=f.translate(F.offsetX,F.offsetY),f=f.scale(1/F.scaleX,1/F.scaleY);const i=w.createPattern(F.canvas,"repeat");return i.setTransform(f),i}};Yt(h,"MAX_PATTERN_SIZE",3e3);let v=h;o.TilingPattern=v},(ot,o,at)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.convertBlackAndWhiteToRGBA=ht,o.convertToRGBA=R,o.grayToRGBA=ut;var l=at(1);function R(j){switch(j.kind){case l.ImageKind.GRAYSCALE_1BPP:return ht(j);case l.ImageKind.RGB_24BPP:return q(j)}return null}function ht({src:j,srcPos:D=0,dest:m,width:O,height:B,nonBlackColor:M=4294967295,inverseDecode:S=!1}){const v=l.FeatureTest.isLittleEndian?4278190080:255,[h,_]=S?[M,v]:[v,M],w=O>>3,x=O&7,A=j.length;m=new Uint32Array(m.buffer);let n=0;for(let r=0;r<B;r++){for(const f=D+w;D<f;D++){const i=D<A?j[D]:255;m[n++]=i&128?_:h,m[n++]=i&64?_:h,m[n++]=i&32?_:h,m[n++]=i&16?_:h,m[n++]=i&8?_:h,m[n++]=i&4?_:h,m[n++]=i&2?_:h,m[n++]=i&1?_:h}if(x===0)continue;const F=D<A?j[D++]:255;for(let f=0;f<x;f++)m[n++]=F&1<<7-f?_:h}return{srcPos:D,destPos:n}}function q({src:j,srcPos:D=0,dest:m,destPos:O=0,width:B,height:M}){let S=0;const v=j.length>>2,h=new Uint32Array(j.buffer,D,v);if(l.FeatureTest.isLittleEndian){for(;S<v-2;S+=3,O+=4){const _=h[S],w=h[S+1],x=h[S+2];m[O]=_|4278190080,m[O+1]=_>>>24|w<<8|4278190080,m[O+2]=w>>>16|x<<16|4278190080,m[O+3]=x>>>8|4278190080}for(let _=S*4,w=j.length;_<w;_+=3)m[O++]=j[_]|j[_+1]<<8|j[_+2]<<16|4278190080}else{for(;S<v-2;S+=3,O+=4){const _=h[S],w=h[S+1],x=h[S+2];m[O]=_|255,m[O+1]=_<<24|w>>>8|255,m[O+2]=w<<16|x>>>16|255,m[O+3]=x<<8|255}for(let _=S*4,w=j.length;_<w;_+=3)m[O++]=j[_]<<24|j[_+1]<<16|j[_+2]<<8|255}return{srcPos:D,destPos:O}}function ut(j,D){if(l.FeatureTest.isLittleEndian)for(let m=0,O=j.length;m<O;m++)D[m]=j[m]*65793|4278190080;else for(let m=0,O=j.length;m<O;m++)D[m]=j[m]*16843008|255}},(ot,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.GlobalWorkerOptions=void 0;const at=Object.create(null);o.GlobalWorkerOptions=at,at.workerPort=null,at.workerSrc=""},(ot,o,at)=>{var j,Ns,m,Bs,B,Se;Object.defineProperty(o,"__esModule",{value:!0}),o.MessageHandler=void 0;var l=at(1);const R={UNKNOWN:0,DATA:1,ERROR:2},ht={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function q(S){switch(S instanceof Error||typeof S=="object"&&S!==null||(0,l.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),S.name){case"AbortException":return new l.AbortException(S.message);case"MissingPDFException":return new l.MissingPDFException(S.message);case"PasswordException":return new l.PasswordException(S.message,S.code);case"UnexpectedResponseException":return new l.UnexpectedResponseException(S.message,S.status);case"UnknownErrorException":return new l.UnknownErrorException(S.message,S.details);default:return new l.UnknownErrorException(S.message,S.toString())}}class ut{constructor(v,h,_){I(this,j);I(this,m);I(this,B);this.sourceName=v,this.targetName=h,this.comObj=_,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=w=>{const x=w.data;if(x.targetName!==this.sourceName)return;if(x.stream){X(this,m,Bs).call(this,x);return}if(x.callback){const n=x.callbackId,r=this.callbackCapabilities[n];if(!r)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],x.callback===R.DATA)r.resolve(x.data);else if(x.callback===R.ERROR)r.reject(q(x.reason));else throw new Error("Unexpected callback case");return}const A=this.actionHandler[x.action];if(!A)throw new Error(`Unknown action from worker: ${x.action}`);if(x.callbackId){const n=this.sourceName,r=x.sourceName;new Promise(function(F){F(A(x.data))}).then(function(F){_.postMessage({sourceName:n,targetName:r,callback:R.DATA,callbackId:x.callbackId,data:F})},function(F){_.postMessage({sourceName:n,targetName:r,callback:R.ERROR,callbackId:x.callbackId,reason:q(F)})});return}if(x.streamId){X(this,j,Ns).call(this,x);return}A(x.data)},_.addEventListener("message",this._onComObjOnMessage)}on(v,h){const _=this.actionHandler;if(_[v])throw new Error(`There is already an actionName called "${v}"`);_[v]=h}send(v,h,_){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:v,data:h},_)}sendWithPromise(v,h,_){const w=this.callbackId++,x=new l.PromiseCapability;this.callbackCapabilities[w]=x;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:v,callbackId:w,data:h},_)}catch(A){x.reject(A)}return x.promise}sendWithStream(v,h,_,w){const x=this.streamId++,A=this.sourceName,n=this.targetName,r=this.comObj;return new ReadableStream({start:F=>{const f=new l.PromiseCapability;return this.streamControllers[x]={controller:F,startCall:f,pullCall:null,cancelCall:null,isClosed:!1},r.postMessage({sourceName:A,targetName:n,action:v,streamId:x,data:h,desiredSize:F.desiredSize},w),f.promise},pull:F=>{const f=new l.PromiseCapability;return this.streamControllers[x].pullCall=f,r.postMessage({sourceName:A,targetName:n,stream:ht.PULL,streamId:x,desiredSize:F.desiredSize}),f.promise},cancel:F=>{(0,l.assert)(F instanceof Error,"cancel must have a valid reason");const f=new l.PromiseCapability;return this.streamControllers[x].cancelCall=f,this.streamControllers[x].isClosed=!0,r.postMessage({sourceName:A,targetName:n,stream:ht.CANCEL,streamId:x,reason:q(F)}),f.promise}},_)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}j=new WeakSet,Ns=function(v){const h=v.streamId,_=this.sourceName,w=v.sourceName,x=this.comObj,A=this,n=this.actionHandler[v.action],r={enqueue(F,f=1,i){if(this.isCancelled)return;const P=this.desiredSize;this.desiredSize-=f,P>0&&this.desiredSize<=0&&(this.sinkCapability=new l.PromiseCapability,this.ready=this.sinkCapability.promise),x.postMessage({sourceName:_,targetName:w,stream:ht.ENQUEUE,streamId:h,chunk:F},i)},close(){this.isCancelled||(this.isCancelled=!0,x.postMessage({sourceName:_,targetName:w,stream:ht.CLOSE,streamId:h}),delete A.streamSinks[h])},error(F){(0,l.assert)(F instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,x.postMessage({sourceName:_,targetName:w,stream:ht.ERROR,streamId:h,reason:q(F)}))},sinkCapability:new l.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:v.desiredSize,ready:null};r.sinkCapability.resolve(),r.ready=r.sinkCapability.promise,this.streamSinks[h]=r,new Promise(function(F){F(n(v.data,r))}).then(function(){x.postMessage({sourceName:_,targetName:w,stream:ht.START_COMPLETE,streamId:h,success:!0})},function(F){x.postMessage({sourceName:_,targetName:w,stream:ht.START_COMPLETE,streamId:h,reason:q(F)})})},m=new WeakSet,Bs=function(v){const h=v.streamId,_=this.sourceName,w=v.sourceName,x=this.comObj,A=this.streamControllers[h],n=this.streamSinks[h];switch(v.stream){case ht.START_COMPLETE:v.success?A.startCall.resolve():A.startCall.reject(q(v.reason));break;case ht.PULL_COMPLETE:v.success?A.pullCall.resolve():A.pullCall.reject(q(v.reason));break;case ht.PULL:if(!n){x.postMessage({sourceName:_,targetName:w,stream:ht.PULL_COMPLETE,streamId:h,success:!0});break}n.desiredSize<=0&&v.desiredSize>0&&n.sinkCapability.resolve(),n.desiredSize=v.desiredSize,new Promise(function(r){var F;r((F=n.onPull)==null?void 0:F.call(n))}).then(function(){x.postMessage({sourceName:_,targetName:w,stream:ht.PULL_COMPLETE,streamId:h,success:!0})},function(r){x.postMessage({sourceName:_,targetName:w,stream:ht.PULL_COMPLETE,streamId:h,reason:q(r)})});break;case ht.ENQUEUE:if((0,l.assert)(A,"enqueue should have stream controller"),A.isClosed)break;A.controller.enqueue(v.chunk);break;case ht.CLOSE:if((0,l.assert)(A,"close should have stream controller"),A.isClosed)break;A.isClosed=!0,A.controller.close(),X(this,B,Se).call(this,A,h);break;case ht.ERROR:(0,l.assert)(A,"error should have stream controller"),A.controller.error(q(v.reason)),X(this,B,Se).call(this,A,h);break;case ht.CANCEL_COMPLETE:v.success?A.cancelCall.resolve():A.cancelCall.reject(q(v.reason)),X(this,B,Se).call(this,A,h);break;case ht.CANCEL:if(!n)break;new Promise(function(r){var F;r((F=n.onCancel)==null?void 0:F.call(n,q(v.reason)))}).then(function(){x.postMessage({sourceName:_,targetName:w,stream:ht.CANCEL_COMPLETE,streamId:h,success:!0})},function(r){x.postMessage({sourceName:_,targetName:w,stream:ht.CANCEL_COMPLETE,streamId:h,reason:q(r)})}),n.sinkCapability.reject(q(v.reason)),n.isCancelled=!0,delete this.streamSinks[h];break;default:throw new Error("Unexpected stream case")}},B=new WeakSet,Se=async function(v,h){var _,w,x;await Promise.allSettled([(_=v.startCall)==null?void 0:_.promise,(w=v.pullCall)==null?void 0:w.promise,(x=v.cancelCall)==null?void 0:x.promise]),delete this.streamControllers[h]},o.MessageHandler=ut},(ot,o,at)=>{var ht,q;Object.defineProperty(o,"__esModule",{value:!0}),o.Metadata=void 0;var l=at(1);class R{constructor({parsedData:j,rawData:D}){I(this,ht,void 0);I(this,q,void 0);it(this,ht,j),it(this,q,D)}getRaw(){return t(this,q)}get(j){return t(this,ht).get(j)??null}getAll(){return(0,l.objectFromMap)(t(this,ht))}has(j){return t(this,ht).has(j)}}ht=new WeakMap,q=new WeakMap,o.Metadata=R},(ot,o,at)=>{var j,D,m,O,B,M,Ge;Object.defineProperty(o,"__esModule",{value:!0}),o.OptionalContentConfig=void 0;var l=at(1),R=at(8);const ht=Symbol("INTERNAL");class q{constructor(h,_){I(this,j,!0);this.name=h,this.intent=_}get visible(){return t(this,j)}_setVisible(h,_){h!==ht&&(0,l.unreachable)("Internal method `_setVisible` called."),it(this,j,_)}}j=new WeakMap;class ut{constructor(h){I(this,M);I(this,D,null);I(this,m,new Map);I(this,O,null);I(this,B,null);if(this.name=null,this.creator=null,h!==null){this.name=h.name,this.creator=h.creator,it(this,B,h.order);for(const _ of h.groups)t(this,m).set(_.id,new q(_.name,_.intent));if(h.baseState==="OFF")for(const _ of t(this,m).values())_._setVisible(ht,!1);for(const _ of h.on)t(this,m).get(_)._setVisible(ht,!0);for(const _ of h.off)t(this,m).get(_)._setVisible(ht,!1);it(this,O,this.getHash())}}isVisible(h){if(t(this,m).size===0)return!0;if(!h)return(0,l.warn)("Optional content group not defined."),!0;if(h.type==="OCG")return t(this,m).has(h.id)?t(this,m).get(h.id).visible:((0,l.warn)(`Optional content group not found: ${h.id}`),!0);if(h.type==="OCMD"){if(h.expression)return X(this,M,Ge).call(this,h.expression);if(!h.policy||h.policy==="AnyOn"){for(const _ of h.ids){if(!t(this,m).has(_))return(0,l.warn)(`Optional content group not found: ${_}`),!0;if(t(this,m).get(_).visible)return!0}return!1}else if(h.policy==="AllOn"){for(const _ of h.ids){if(!t(this,m).has(_))return(0,l.warn)(`Optional content group not found: ${_}`),!0;if(!t(this,m).get(_).visible)return!1}return!0}else if(h.policy==="AnyOff"){for(const _ of h.ids){if(!t(this,m).has(_))return(0,l.warn)(`Optional content group not found: ${_}`),!0;if(!t(this,m).get(_).visible)return!0}return!1}else if(h.policy==="AllOff"){for(const _ of h.ids){if(!t(this,m).has(_))return(0,l.warn)(`Optional content group not found: ${_}`),!0;if(t(this,m).get(_).visible)return!1}return!0}return(0,l.warn)(`Unknown optional content policy ${h.policy}.`),!0}return(0,l.warn)(`Unknown group type ${h.type}.`),!0}setVisibility(h,_=!0){if(!t(this,m).has(h)){(0,l.warn)(`Optional content group not found: ${h}`);return}t(this,m).get(h)._setVisible(ht,!!_),it(this,D,null)}get hasInitialVisibility(){return t(this,O)===null||this.getHash()===t(this,O)}getOrder(){return t(this,m).size?t(this,B)?t(this,B).slice():[...t(this,m).keys()]:null}getGroups(){return t(this,m).size>0?(0,l.objectFromMap)(t(this,m)):null}getGroup(h){return t(this,m).get(h)||null}getHash(){if(t(this,D)!==null)return t(this,D);const h=new R.MurmurHash3_64;for(const[_,w]of t(this,m))h.update(`${_}:${w.visible}`);return it(this,D,h.hexdigest())}}D=new WeakMap,m=new WeakMap,O=new WeakMap,B=new WeakMap,M=new WeakSet,Ge=function(h){const _=h.length;if(_<2)return!0;const w=h[0];for(let x=1;x<_;x++){const A=h[x];let n;if(Array.isArray(A))n=X(this,M,Ge).call(this,A);else if(t(this,m).has(A))n=t(this,m).get(A).visible;else return(0,l.warn)(`Optional content group not found: ${A}`),!0;switch(w){case"And":if(!n)return!1;break;case"Or":if(n)return!0;break;case"Not":return!n;default:return!0}}return w==="And"},o.OptionalContentConfig=ut},(ot,o,at)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.PDFDataTransportStream=void 0;var l=at(1),R=at(6);class ht{constructor({length:D,initialData:m,progressiveDone:O=!1,contentDispositionFilename:B=null,disableRange:M=!1,disableStream:S=!1},v){if((0,l.assert)(v,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=O,this._contentDispositionFilename=B,(m==null?void 0:m.length)>0){const h=m instanceof Uint8Array&&m.byteLength===m.buffer.byteLength?m.buffer:new Uint8Array(m).buffer;this._queuedChunks.push(h)}this._pdfDataRangeTransport=v,this._isStreamingSupported=!S,this._isRangeSupported=!M,this._contentLength=D,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((h,_)=>{this._onReceiveData({begin:h,chunk:_})}),this._pdfDataRangeTransport.addProgressListener((h,_)=>{this._onProgress({loaded:h,total:_})}),this._pdfDataRangeTransport.addProgressiveReadListener(h=>{this._onReceiveData({chunk:h})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:D,chunk:m}){const O=m instanceof Uint8Array&&m.byteLength===m.buffer.byteLength?m.buffer:new Uint8Array(m).buffer;if(D===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(O):this._queuedChunks.push(O);else{const B=this._rangeReaders.some(function(M){return M._begin!==D?!1:(M._enqueue(O),!0)});(0,l.assert)(B,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var D;return((D=this._fullRequestReader)==null?void 0:D._loaded)??0}_onProgress(D){var m,O,B,M;D.total===void 0?(O=(m=this._rangeReaders[0])==null?void 0:m.onProgress)==null||O.call(m,{loaded:D.loaded}):(M=(B=this._fullRequestReader)==null?void 0:B.onProgress)==null||M.call(B,{loaded:D.loaded,total:D.total})}_onProgressiveDone(){var D;(D=this._fullRequestReader)==null||D.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(D){const m=this._rangeReaders.indexOf(D);m>=0&&this._rangeReaders.splice(m,1)}getFullReader(){(0,l.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const D=this._queuedChunks;return this._queuedChunks=null,new q(this,D,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(D,m){if(m<=this._progressiveDataLength)return null;const O=new ut(this,D,m);return this._pdfDataRangeTransport.requestDataRange(D,m),this._rangeReaders.push(O),O}cancelAllRequests(D){var m;(m=this._fullRequestReader)==null||m.cancel(D);for(const O of this._rangeReaders.slice(0))O.cancel(D);this._pdfDataRangeTransport.abort()}}o.PDFDataTransportStream=ht;class q{constructor(D,m,O=!1,B=null){this._stream=D,this._done=O||!1,this._filename=(0,R.isPdfFile)(B)?B:null,this._queuedChunks=m||[],this._loaded=0;for(const M of this._queuedChunks)this._loaded+=M.byteLength;this._requests=[],this._headersReady=Promise.resolve(),D._fullRequestReader=this,this.onProgress=null}_enqueue(D){this._done||(this._requests.length>0?this._requests.shift().resolve({value:D,done:!1}):this._queuedChunks.push(D),this._loaded+=D.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const D=new l.PromiseCapability;return this._requests.push(D),D.promise}cancel(D){this._done=!0;for(const m of this._requests)m.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class ut{constructor(D,m,O){this._stream=D,this._begin=m,this._end=O,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(D){if(!this._done){if(this._requests.length===0)this._queuedChunk=D;else{this._requests.shift().resolve({value:D,done:!1});for(const O of this._requests)O.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const m=this._queuedChunk;return this._queuedChunk=null,{value:m,done:!1}}if(this._done)return{value:void 0,done:!0};const D=new l.PromiseCapability;return this._requests.push(D),D.promise}cancel(D){this._done=!0;for(const m of this._requests)m.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(ot,o,at)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.PDFFetchStream=void 0;var l=at(1),R=at(20);function ht(O,B,M){return{method:"GET",headers:O,signal:M.signal,mode:"cors",credentials:B?"include":"same-origin",redirect:"follow"}}function q(O){const B=new Headers;for(const M in O){const S=O[M];S!==void 0&&B.append(M,S)}return B}function ut(O){return O instanceof Uint8Array?O.buffer:O instanceof ArrayBuffer?O:((0,l.warn)(`getArrayBuffer - unexpected data format: ${O}`),new Uint8Array(O).buffer)}class j{constructor(B){this.source=B,this.isHttp=/^https?:/i.test(B.url),this.httpHeaders=this.isHttp&&B.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var B;return((B=this._fullRequestReader)==null?void 0:B._loaded)??0}getFullReader(){return(0,l.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new D(this),this._fullRequestReader}getRangeReader(B,M){if(M<=this._progressiveDataLength)return null;const S=new m(this,B,M);return this._rangeRequestReaders.push(S),S}cancelAllRequests(B){var M;(M=this._fullRequestReader)==null||M.cancel(B);for(const S of this._rangeRequestReaders.slice(0))S.cancel(B)}}o.PDFFetchStream=j;class D{constructor(B){this._stream=B,this._reader=null,this._loaded=0,this._filename=null;const M=B.source;this._withCredentials=M.withCredentials||!1,this._contentLength=M.length,this._headersCapability=new l.PromiseCapability,this._disableRange=M.disableRange||!1,this._rangeChunkSize=M.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!M.disableStream,this._isRangeSupported=!M.disableRange,this._headers=q(this._stream.httpHeaders);const S=M.url;fetch(S,ht(this._headers,this._withCredentials,this._abortController)).then(v=>{if(!(0,R.validateResponseStatus)(v.status))throw(0,R.createResponseStatusError)(v.status,S);this._reader=v.body.getReader(),this._headersCapability.resolve();const h=x=>v.headers.get(x),{allowRangeRequests:_,suggestedLength:w}=(0,R.validateRangeRequestCapabilities)({getResponseHeader:h,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=_,this._contentLength=w||this._contentLength,this._filename=(0,R.extractFilenameFromHeader)(h),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new l.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var S;await this._headersCapability.promise;const{value:B,done:M}=await this._reader.read();return M?{value:B,done:M}:(this._loaded+=B.byteLength,(S=this.onProgress)==null||S.call(this,{loaded:this._loaded,total:this._contentLength}),{value:ut(B),done:!1})}cancel(B){var M;(M=this._reader)==null||M.cancel(B),this._abortController.abort()}}class m{constructor(B,M,S){this._stream=B,this._reader=null,this._loaded=0;const v=B.source;this._withCredentials=v.withCredentials||!1,this._readCapability=new l.PromiseCapability,this._isStreamingSupported=!v.disableStream,this._abortController=new AbortController,this._headers=q(this._stream.httpHeaders),this._headers.append("Range",`bytes=${M}-${S-1}`);const h=v.url;fetch(h,ht(this._headers,this._withCredentials,this._abortController)).then(_=>{if(!(0,R.validateResponseStatus)(_.status))throw(0,R.createResponseStatusError)(_.status,h);this._readCapability.resolve(),this._reader=_.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var S;await this._readCapability.promise;const{value:B,done:M}=await this._reader.read();return M?{value:B,done:M}:(this._loaded+=B.byteLength,(S=this.onProgress)==null||S.call(this,{loaded:this._loaded}),{value:ut(B),done:!1})}cancel(B){var M;(M=this._reader)==null||M.cancel(B),this._abortController.abort()}}},(ot,o,at)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.createResponseStatusError=j,o.extractFilenameFromHeader=ut,o.validateRangeRequestCapabilities=q,o.validateResponseStatus=D;var l=at(1),R=at(21),ht=at(6);function q({getResponseHeader:m,isHttp:O,rangeChunkSize:B,disableRange:M}){const S={allowRangeRequests:!1,suggestedLength:void 0},v=parseInt(m("Content-Length"),10);return!Number.isInteger(v)||(S.suggestedLength=v,v<=2*B)||M||!O||m("Accept-Ranges")!=="bytes"||(m("Content-Encoding")||"identity")!=="identity"||(S.allowRangeRequests=!0),S}function ut(m){const O=m("Content-Disposition");if(O){let B=(0,R.getFilenameFromContentDispositionHeader)(O);if(B.includes("%"))try{B=decodeURIComponent(B)}catch{}if((0,ht.isPdfFile)(B))return B}return null}function j(m,O){return m===404||m===0&&O.startsWith("file:")?new l.MissingPDFException('Missing PDF "'+O+'".'):new l.UnexpectedResponseException(`Unexpected server response (${m}) while retrieving PDF "${O}".`,m)}function D(m){return m===200||m===206}},(ot,o,at)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.getFilenameFromContentDispositionHeader=R;var l=at(1);function R(ht){let q=!0,ut=j("filename\\*","i").exec(ht);if(ut){ut=ut[1];let v=B(ut);return v=unescape(v),v=M(v),v=S(v),m(v)}if(ut=O(ht),ut){const v=S(ut);return m(v)}if(ut=j("filename","i").exec(ht),ut){ut=ut[1];let v=B(ut);return v=S(v),m(v)}function j(v,h){return new RegExp("(?:^|;)\\s*"+v+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',h)}function D(v,h){if(v){if(!/^[\x00-\xFF]+$/.test(h))return h;try{const _=new TextDecoder(v,{fatal:!0}),w=(0,l.stringToBytes)(h);h=_.decode(w),q=!1}catch{}}return h}function m(v){return q&&/[\x80-\xff]/.test(v)&&(v=D("utf-8",v),q&&(v=D("iso-8859-1",v))),v}function O(v){const h=[];let _;const w=j("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(_=w.exec(v))!==null;){let[,A,n,r]=_;if(A=parseInt(A,10),A in h){if(A===0)break;continue}h[A]=[n,r]}const x=[];for(let A=0;A<h.length&&A in h;++A){let[n,r]=h[A];r=B(r),n&&(r=unescape(r),A===0&&(r=M(r))),x.push(r)}return x.join("")}function B(v){if(v.startsWith('"')){const h=v.slice(1).split('\\"');for(let _=0;_<h.length;++_){const w=h[_].indexOf('"');w!==-1&&(h[_]=h[_].slice(0,w),h.length=_+1),h[_]=h[_].replaceAll(/\\(.)/g,"$1")}v=h.join('"')}return v}function M(v){const h=v.indexOf("'");if(h===-1)return v;const _=v.slice(0,h),x=v.slice(h+1).replace(/^[^']*'/,"");return D(_,x)}function S(v){return!v.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(v)?v:v.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(h,_,w,x){if(w==="q"||w==="Q")return x=x.replaceAll("_"," "),x=x.replaceAll(/=([0-9a-fA-F]{2})/g,function(A,n){return String.fromCharCode(parseInt(n,16))}),D(_,x);try{x=atob(x)}catch{}return D(_,x)})}return""}},(ot,o,at)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.PDFNetworkStream=void 0;var l=at(1),R=at(20);const ht=200,q=206;function ut(B){const M=B.response;return typeof M!="string"?M:(0,l.stringToBytes)(M).buffer}class j{constructor(M,S={}){this.url=M,this.isHttp=/^https?:/i.test(M),this.httpHeaders=this.isHttp&&S.httpHeaders||Object.create(null),this.withCredentials=S.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(M,S,v){const h={begin:M,end:S};for(const _ in v)h[_]=v[_];return this.request(h)}requestFull(M){return this.request(M)}request(M){const S=new XMLHttpRequest,v=this.currXhrId++,h=this.pendingRequests[v]={xhr:S};S.open("GET",this.url),S.withCredentials=this.withCredentials;for(const _ in this.httpHeaders){const w=this.httpHeaders[_];w!==void 0&&S.setRequestHeader(_,w)}return this.isHttp&&"begin"in M&&"end"in M?(S.setRequestHeader("Range",`bytes=${M.begin}-${M.end-1}`),h.expectedStatus=q):h.expectedStatus=ht,S.responseType="arraybuffer",M.onError&&(S.onerror=function(_){M.onError(S.status)}),S.onreadystatechange=this.onStateChange.bind(this,v),S.onprogress=this.onProgress.bind(this,v),h.onHeadersReceived=M.onHeadersReceived,h.onDone=M.onDone,h.onError=M.onError,h.onProgress=M.onProgress,S.send(null),v}onProgress(M,S){var h;const v=this.pendingRequests[M];v&&((h=v.onProgress)==null||h.call(v,S))}onStateChange(M,S){var A,n,r;const v=this.pendingRequests[M];if(!v)return;const h=v.xhr;if(h.readyState>=2&&v.onHeadersReceived&&(v.onHeadersReceived(),delete v.onHeadersReceived),h.readyState!==4||!(M in this.pendingRequests))return;if(delete this.pendingRequests[M],h.status===0&&this.isHttp){(A=v.onError)==null||A.call(v,h.status);return}const _=h.status||ht;if(!(_===ht&&v.expectedStatus===q)&&_!==v.expectedStatus){(n=v.onError)==null||n.call(v,h.status);return}const x=ut(h);if(_===q){const F=h.getResponseHeader("Content-Range"),f=/bytes (\d+)-(\d+)\/(\d+)/.exec(F);v.onDone({begin:parseInt(f[1],10),chunk:x})}else x?v.onDone({begin:0,chunk:x}):(r=v.onError)==null||r.call(v,h.status)}getRequestXhr(M){return this.pendingRequests[M].xhr}isPendingRequest(M){return M in this.pendingRequests}abortRequest(M){const S=this.pendingRequests[M].xhr;delete this.pendingRequests[M],S.abort()}}class D{constructor(M){this._source=M,this._manager=new j(M.url,{httpHeaders:M.httpHeaders,withCredentials:M.withCredentials}),this._rangeChunkSize=M.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(M){const S=this._rangeRequestReaders.indexOf(M);S>=0&&this._rangeRequestReaders.splice(S,1)}getFullReader(){return(0,l.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new m(this._manager,this._source),this._fullRequestReader}getRangeReader(M,S){const v=new O(this._manager,M,S);return v.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(v),v}cancelAllRequests(M){var S;(S=this._fullRequestReader)==null||S.cancel(M);for(const v of this._rangeRequestReaders.slice(0))v.cancel(M)}}o.PDFNetworkStream=D;class m{constructor(M,S){this._manager=M;const v={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=S.url,this._fullRequestId=M.requestFull(v),this._headersReceivedCapability=new l.PromiseCapability,this._disableRange=S.disableRange||!1,this._contentLength=S.length,this._rangeChunkSize=S.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const M=this._fullRequestId,S=this._manager.getRequestXhr(M),v=w=>S.getResponseHeader(w),{allowRangeRequests:h,suggestedLength:_}=(0,R.validateRangeRequestCapabilities)({getResponseHeader:v,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});h&&(this._isRangeSupported=!0),this._contentLength=_||this._contentLength,this._filename=(0,R.extractFilenameFromHeader)(v),this._isRangeSupported&&this._manager.abortRequest(M),this._headersReceivedCapability.resolve()}_onDone(M){if(M&&(this._requests.length>0?this._requests.shift().resolve({value:M.chunk,done:!1}):this._cachedChunks.push(M.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const S of this._requests)S.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(M){this._storedError=(0,R.createResponseStatusError)(M,this._url),this._headersReceivedCapability.reject(this._storedError);for(const S of this._requests)S.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(M){var S;(S=this.onProgress)==null||S.call(this,{loaded:M.loaded,total:M.lengthComputable?M.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const M=new l.PromiseCapability;return this._requests.push(M),M.promise}cancel(M){this._done=!0,this._headersReceivedCapability.reject(M);for(const S of this._requests)S.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class O{constructor(M,S,v){this._manager=M;const h={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=M.url,this._requestId=M.requestRange(S,v,h),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var M;(M=this.onClosed)==null||M.call(this,this)}_onDone(M){const S=M.chunk;this._requests.length>0?this._requests.shift().resolve({value:S,done:!1}):this._queuedChunk=S,this._done=!0;for(const v of this._requests)v.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(M){this._storedError=(0,R.createResponseStatusError)(M,this._url);for(const S of this._requests)S.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(M){var S;this.isStreamingSupported||(S=this.onProgress)==null||S.call(this,{loaded:M.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const S=this._queuedChunk;return this._queuedChunk=null,{value:S,done:!1}}if(this._done)return{value:void 0,done:!0};const M=new l.PromiseCapability;return this._requests.push(M),M.promise}cancel(M){this._done=!0;for(const S of this._requests)S.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(ot,o,at)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.PDFNodeStream=void 0;var l=at(1),R=at(20);const ht=/^file:\/\/\/[a-zA-Z]:\//;function q(v){const h=require$$5,_=h.parse(v);return _.protocol==="file:"||_.host?_:/^[a-z]:[/\\]/i.test(v)?h.parse(`file:///${v}`):(_.host||(_.protocol="file:"),_)}class ut{constructor(h){this.source=h,this.url=q(h.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&h.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var h;return((h=this._fullRequestReader)==null?void 0:h._loaded)??0}getFullReader(){return(0,l.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new M(this):new O(this),this._fullRequestReader}getRangeReader(h,_){if(_<=this._progressiveDataLength)return null;const w=this.isFsUrl?new S(this,h,_):new B(this,h,_);return this._rangeRequestReaders.push(w),w}cancelAllRequests(h){var _;(_=this._fullRequestReader)==null||_.cancel(h);for(const w of this._rangeRequestReaders.slice(0))w.cancel(h)}}o.PDFNodeStream=ut;class j{constructor(h){this._url=h.url,this._done=!1,this._storedError=null,this.onProgress=null;const _=h.source;this._contentLength=_.length,this._loaded=0,this._filename=null,this._disableRange=_.disableRange||!1,this._rangeChunkSize=_.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!_.disableStream,this._isRangeSupported=!_.disableRange,this._readableStream=null,this._readCapability=new l.PromiseCapability,this._headersCapability=new l.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var w;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const h=this._readableStream.read();return h===null?(this._readCapability=new l.PromiseCapability,this.read()):(this._loaded+=h.length,(w=this.onProgress)==null||w.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(h).buffer,done:!1})}cancel(h){if(!this._readableStream){this._error(h);return}this._readableStream.destroy(h)}_error(h){this._storedError=h,this._readCapability.resolve()}_setReadableStream(h){this._readableStream=h,h.on("readable",()=>{this._readCapability.resolve()}),h.on("end",()=>{h.destroy(),this._done=!0,this._readCapability.resolve()}),h.on("error",_=>{this._error(_)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new l.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class D{constructor(h){this._url=h.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new l.PromiseCapability;const _=h.source;this._isStreamingSupported=!_.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var w;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const h=this._readableStream.read();return h===null?(this._readCapability=new l.PromiseCapability,this.read()):(this._loaded+=h.length,(w=this.onProgress)==null||w.call(this,{loaded:this._loaded}),{value:new Uint8Array(h).buffer,done:!1})}cancel(h){if(!this._readableStream){this._error(h);return}this._readableStream.destroy(h)}_error(h){this._storedError=h,this._readCapability.resolve()}_setReadableStream(h){this._readableStream=h,h.on("readable",()=>{this._readCapability.resolve()}),h.on("end",()=>{h.destroy(),this._done=!0,this._readCapability.resolve()}),h.on("error",_=>{this._error(_)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function m(v,h){return{protocol:v.protocol,auth:v.auth,host:v.hostname,port:v.port,path:v.path,method:"GET",headers:h}}class O extends j{constructor(h){super(h);const _=w=>{if(w.statusCode===404){const r=new l.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=r,this._headersCapability.reject(r);return}this._headersCapability.resolve(),this._setReadableStream(w);const x=r=>this._readableStream.headers[r.toLowerCase()],{allowRangeRequests:A,suggestedLength:n}=(0,R.validateRangeRequestCapabilities)({getResponseHeader:x,isHttp:h.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=A,this._contentLength=n||this._contentLength,this._filename=(0,R.extractFilenameFromHeader)(x)};if(this._request=null,this._url.protocol==="http:"){const w=require$$5;this._request=w.request(m(this._url,h.httpHeaders),_)}else{const w=require$$5;this._request=w.request(m(this._url,h.httpHeaders),_)}this._request.on("error",w=>{this._storedError=w,this._headersCapability.reject(w)}),this._request.end()}}class B extends D{constructor(h,_,w){super(h),this._httpHeaders={};for(const A in h.httpHeaders){const n=h.httpHeaders[A];n!==void 0&&(this._httpHeaders[A]=n)}this._httpHeaders.Range=`bytes=${_}-${w-1}`;const x=A=>{if(A.statusCode===404){const n=new l.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=n;return}this._setReadableStream(A)};if(this._request=null,this._url.protocol==="http:"){const A=require$$5;this._request=A.request(m(this._url,this._httpHeaders),x)}else{const A=require$$5;this._request=A.request(m(this._url,this._httpHeaders),x)}this._request.on("error",A=>{this._storedError=A}),this._request.end()}}class M extends j{constructor(h){super(h);let _=decodeURIComponent(this._url.path);ht.test(this._url.href)&&(_=_.replace(/^\//,""));const w=require$$5;w.lstat(_,(x,A)=>{if(x){x.code==="ENOENT"&&(x=new l.MissingPDFException(`Missing PDF "${_}".`)),this._storedError=x,this._headersCapability.reject(x);return}this._contentLength=A.size,this._setReadableStream(w.createReadStream(_)),this._headersCapability.resolve()})}}class S extends D{constructor(h,_,w){super(h);let x=decodeURIComponent(this._url.path);ht.test(this._url.href)&&(x=x.replace(/^\//,""));const A=require$$5;this._setReadableStream(A.createReadStream(x,{start:_,end:w-1}))}}},(ot,o,at)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.SVGGraphics=void 0;var l=at(6),R=at(1);const ht={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},q="http://www.w3.org/XML/1998/namespace",ut="http://www.w3.org/1999/xlink",j=["butt","round","square"],D=["miter","round","bevel"],m=function(A,n="",r=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!r)return URL.createObjectURL(new Blob([A],{type:n}));const F="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let f=`data:${n};base64,`;for(let i=0,P=A.length;i<P;i+=3){const g=A[i]&255,W=A[i+1]&255,V=A[i+2]&255,E=g>>2,z=(g&3)<<4|W>>4,nt=i+1<P?(W&15)<<2|V>>6:64,ct=i+2<P?V&63:64;f+=F[E]+F[z]+F[nt]+F[ct]}return f},O=function(){const A=new Uint8Array([137,80,78,71,13,10,26,10]),n=12,r=new Int32Array(256);for(let V=0;V<256;V++){let E=V;for(let z=0;z<8;z++)E=E&1?3988292384^E>>1&2147483647:E>>1&2147483647;r[V]=E}function F(V,E,z){let nt=-1;for(let ct=E;ct<z;ct++){const u=(nt^V[ct])&255,L=r[u];nt=nt>>>8^L}return nt^-1}function f(V,E,z,nt){let ct=nt;const u=E.length;z[ct]=u>>24&255,z[ct+1]=u>>16&255,z[ct+2]=u>>8&255,z[ct+3]=u&255,ct+=4,z[ct]=V.charCodeAt(0)&255,z[ct+1]=V.charCodeAt(1)&255,z[ct+2]=V.charCodeAt(2)&255,z[ct+3]=V.charCodeAt(3)&255,ct+=4,z.set(E,ct),ct+=E.length;const L=F(z,nt+4,ct);z[ct]=L>>24&255,z[ct+1]=L>>16&255,z[ct+2]=L>>8&255,z[ct+3]=L&255}function i(V,E,z){let nt=1,ct=0;for(let u=E;u<z;++u)nt=(nt+(V[u]&255))%65521,ct=(ct+nt)%65521;return ct<<16|nt}function P(V){if(!R.isNodeJS)return g(V);try{const E=parseInt(process.versions.node)>=8?V:Buffer.from(V),z=require$$5.deflateSync(E,{level:9});return z instanceof Uint8Array?z:new Uint8Array(z)}catch(E){(0,R.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+E)}return g(V)}function g(V){let E=V.length;const z=65535,nt=Math.ceil(E/z),ct=new Uint8Array(2+E+nt*5+4);let u=0;ct[u++]=120,ct[u++]=156;let L=0;for(;E>z;)ct[u++]=0,ct[u++]=255,ct[u++]=255,ct[u++]=0,ct[u++]=0,ct.set(V.subarray(L,L+z),u),u+=z,L+=z,E-=z;ct[u++]=1,ct[u++]=E&255,ct[u++]=E>>8&255,ct[u++]=~E&65535&255,ct[u++]=(~E&65535)>>8&255,ct.set(V.subarray(L),u),u+=V.length-L;const Y=i(V,0,V.length);return ct[u++]=Y>>24&255,ct[u++]=Y>>16&255,ct[u++]=Y>>8&255,ct[u++]=Y&255,ct}function W(V,E,z,nt){const ct=V.width,u=V.height;let L,Y,rt;const _t=V.data;switch(E){case R.ImageKind.GRAYSCALE_1BPP:Y=0,L=1,rt=ct+7>>3;break;case R.ImageKind.RGB_24BPP:Y=2,L=8,rt=ct*3;break;case R.ImageKind.RGBA_32BPP:Y=6,L=8,rt=ct*4;break;default:throw new Error("invalid format")}const d=new Uint8Array((1+rt)*u);let e=0,s=0;for(let K=0;K<u;++K)d[e++]=0,d.set(_t.subarray(s,s+rt),e),s+=rt,e+=rt;if(E===R.ImageKind.GRAYSCALE_1BPP&&nt){e=0;for(let K=0;K<u;K++){e++;for(let ft=0;ft<rt;ft++)d[e++]^=255}}const c=new Uint8Array([ct>>24&255,ct>>16&255,ct>>8&255,ct&255,u>>24&255,u>>16&255,u>>8&255,u&255,L,Y,0,0,0]),C=P(d),y=A.length+n*3+c.length+C.length,N=new Uint8Array(y);let H=0;return N.set(A,H),H+=A.length,f("IHDR",c,N,H),H+=n+c.length,f("IDATA",C,N,H),H+=n+C.length,f("IEND",new Uint8Array(0),N,H),m(N,"image/png",z)}return function(E,z,nt){const ct=E.kind===void 0?R.ImageKind.GRAYSCALE_1BPP:E.kind;return W(E,ct,z,nt)}}();class B{constructor(){this.fontSizeScale=1,this.fontWeight=ht.fontWeight,this.fontSize=0,this.textMatrix=R.IDENTITY_MATRIX,this.fontMatrix=R.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=R.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=ht.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(n,r){this.x=n,this.y=r}}function M(A){let n=[];const r=[];for(const F of A){if(F.fn==="save"){n.push({fnId:92,fn:"group",items:[]}),r.push(n),n=n.at(-1).items;continue}F.fn==="restore"?n=r.pop():n.push(F)}return n}function S(A){if(Number.isInteger(A))return A.toString();const n=A.toFixed(10);let r=n.length-1;if(n[r]!=="0")return n;do r--;while(n[r]==="0");return n.substring(0,n[r]==="."?r:r+1)}function v(A){if(A[4]===0&&A[5]===0){if(A[1]===0&&A[2]===0)return A[0]===1&&A[3]===1?"":`scale(${S(A[0])} ${S(A[3])})`;if(A[0]===A[3]&&A[1]===-A[2]){const n=Math.acos(A[0])*180/Math.PI;return`rotate(${S(n)})`}}else if(A[0]===1&&A[1]===0&&A[2]===0&&A[3]===1)return`translate(${S(A[4])} ${S(A[5])})`;return`matrix(${S(A[0])} ${S(A[1])} ${S(A[2])} ${S(A[3])} ${S(A[4])} ${S(A[5])})`}let h=0,_=0,w=0;class x{constructor(n,r,F=!1){(0,l.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new l.DOMSVGFactory,this.current=new B,this.transformMatrix=R.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=n,this.objs=r,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!F,this._operatorIdMapping=[];for(const f in R.OPS)this._operatorIdMapping[R.OPS[f]]=f}getObject(n,r=null){return typeof n=="string"?n.startsWith("g_")?this.commonObjs.get(n):this.objs.get(n):r}save(){this.transformStack.push(this.transformMatrix);const n=this.current;this.extraStack.push(n),this.current=n.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(n){this.save(),this.executeOpTree(n),this.restore()}loadDependencies(n){const r=n.fnArray,F=n.argsArray;for(let f=0,i=r.length;f<i;f++)if(r[f]===R.OPS.dependency)for(const P of F[f]){const g=P.startsWith("g_")?this.commonObjs:this.objs,W=new Promise(V=>{g.get(P,V)});this.current.dependencies.push(W)}return Promise.all(this.current.dependencies)}transform(n,r,F,f,i,P){const g=[n,r,F,f,i,P];this.transformMatrix=R.Util.transform(this.transformMatrix,g),this.tgrp=null}getSVG(n,r){this.viewport=r;const F=this._initialize(r);return this.loadDependencies(n).then(()=>(this.transformMatrix=R.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(n)),F))}convertOpList(n){const r=this._operatorIdMapping,F=n.argsArray,f=n.fnArray,i=[];for(let P=0,g=f.length;P<g;P++){const W=f[P];i.push({fnId:W,fn:r[W],args:F[P]})}return M(i)}executeOpTree(n){for(const r of n){const F=r.fn,f=r.fnId,i=r.args;switch(f|0){case R.OPS.beginText:this.beginText();break;case R.OPS.dependency:break;case R.OPS.setLeading:this.setLeading(i);break;case R.OPS.setLeadingMoveText:this.setLeadingMoveText(i[0],i[1]);break;case R.OPS.setFont:this.setFont(i);break;case R.OPS.showText:this.showText(i[0]);break;case R.OPS.showSpacedText:this.showText(i[0]);break;case R.OPS.endText:this.endText();break;case R.OPS.moveText:this.moveText(i[0],i[1]);break;case R.OPS.setCharSpacing:this.setCharSpacing(i[0]);break;case R.OPS.setWordSpacing:this.setWordSpacing(i[0]);break;case R.OPS.setHScale:this.setHScale(i[0]);break;case R.OPS.setTextMatrix:this.setTextMatrix(i[0],i[1],i[2],i[3],i[4],i[5]);break;case R.OPS.setTextRise:this.setTextRise(i[0]);break;case R.OPS.setTextRenderingMode:this.setTextRenderingMode(i[0]);break;case R.OPS.setLineWidth:this.setLineWidth(i[0]);break;case R.OPS.setLineJoin:this.setLineJoin(i[0]);break;case R.OPS.setLineCap:this.setLineCap(i[0]);break;case R.OPS.setMiterLimit:this.setMiterLimit(i[0]);break;case R.OPS.setFillRGBColor:this.setFillRGBColor(i[0],i[1],i[2]);break;case R.OPS.setStrokeRGBColor:this.setStrokeRGBColor(i[0],i[1],i[2]);break;case R.OPS.setStrokeColorN:this.setStrokeColorN(i);break;case R.OPS.setFillColorN:this.setFillColorN(i);break;case R.OPS.shadingFill:this.shadingFill(i[0]);break;case R.OPS.setDash:this.setDash(i[0],i[1]);break;case R.OPS.setRenderingIntent:this.setRenderingIntent(i[0]);break;case R.OPS.setFlatness:this.setFlatness(i[0]);break;case R.OPS.setGState:this.setGState(i[0]);break;case R.OPS.fill:this.fill();break;case R.OPS.eoFill:this.eoFill();break;case R.OPS.stroke:this.stroke();break;case R.OPS.fillStroke:this.fillStroke();break;case R.OPS.eoFillStroke:this.eoFillStroke();break;case R.OPS.clip:this.clip("nonzero");break;case R.OPS.eoClip:this.clip("evenodd");break;case R.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case R.OPS.paintImageXObject:this.paintImageXObject(i[0]);break;case R.OPS.paintInlineImageXObject:this.paintInlineImageXObject(i[0]);break;case R.OPS.paintImageMaskXObject:this.paintImageMaskXObject(i[0]);break;case R.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(i[0],i[1]);break;case R.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case R.OPS.closePath:this.closePath();break;case R.OPS.closeStroke:this.closeStroke();break;case R.OPS.closeFillStroke:this.closeFillStroke();break;case R.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case R.OPS.nextLine:this.nextLine();break;case R.OPS.transform:this.transform(i[0],i[1],i[2],i[3],i[4],i[5]);break;case R.OPS.constructPath:this.constructPath(i[0],i[1]);break;case R.OPS.endPath:this.endPath();break;case 92:this.group(r.items);break;default:(0,R.warn)(`Unimplemented operator ${F}`);break}}}setWordSpacing(n){this.current.wordSpacing=n}setCharSpacing(n){this.current.charSpacing=n}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(n,r,F,f,i,P){const g=this.current;g.textMatrix=g.lineMatrix=[n,r,F,f,i,P],g.textMatrixScale=Math.hypot(n,r),g.x=g.lineX=0,g.y=g.lineY=0,g.xcoords=[],g.ycoords=[],g.tspan=this.svgFactory.createElement("svg:tspan"),g.tspan.setAttributeNS(null,"font-family",g.fontFamily),g.tspan.setAttributeNS(null,"font-size",`${S(g.fontSize)}px`),g.tspan.setAttributeNS(null,"y",S(-g.y)),g.txtElement=this.svgFactory.createElement("svg:text"),g.txtElement.append(g.tspan)}beginText(){const n=this.current;n.x=n.lineX=0,n.y=n.lineY=0,n.textMatrix=R.IDENTITY_MATRIX,n.lineMatrix=R.IDENTITY_MATRIX,n.textMatrixScale=1,n.tspan=this.svgFactory.createElement("svg:tspan"),n.txtElement=this.svgFactory.createElement("svg:text"),n.txtgrp=this.svgFactory.createElement("svg:g"),n.xcoords=[],n.ycoords=[]}moveText(n,r){const F=this.current;F.x=F.lineX+=n,F.y=F.lineY+=r,F.xcoords=[],F.ycoords=[],F.tspan=this.svgFactory.createElement("svg:tspan"),F.tspan.setAttributeNS(null,"font-family",F.fontFamily),F.tspan.setAttributeNS(null,"font-size",`${S(F.fontSize)}px`),F.tspan.setAttributeNS(null,"y",S(-F.y))}showText(n){const r=this.current,F=r.font,f=r.fontSize;if(f===0)return;const i=r.fontSizeScale,P=r.charSpacing,g=r.wordSpacing,W=r.fontDirection,V=r.textHScale*W,E=F.vertical,z=E?1:-1,nt=F.defaultVMetrics,ct=f*r.fontMatrix[0];let u=0;for(const rt of n){if(rt===null){u+=W*g;continue}else if(typeof rt=="number"){u+=z*rt*f/1e3;continue}const _t=(rt.isSpace?g:0)+P,d=rt.fontChar;let e,s,c=rt.width;if(E){let y;const N=rt.vmetric||nt;y=rt.vmetric?N[1]:c*.5,y=-y*ct;const H=N[2]*ct;c=N?-N[0]:c,e=y/i,s=(u+H)/i}else e=u/i,s=0;(rt.isInFont||F.missingFile)&&(r.xcoords.push(r.x+e),E&&r.ycoords.push(-r.y+s),r.tspan.textContent+=d);const C=E?c*ct-_t*W:c*ct+_t*W;u+=C}r.tspan.setAttributeNS(null,"x",r.xcoords.map(S).join(" ")),E?r.tspan.setAttributeNS(null,"y",r.ycoords.map(S).join(" ")):r.tspan.setAttributeNS(null,"y",S(-r.y)),E?r.y-=u:r.x+=u*V,r.tspan.setAttributeNS(null,"font-family",r.fontFamily),r.tspan.setAttributeNS(null,"font-size",`${S(r.fontSize)}px`),r.fontStyle!==ht.fontStyle&&r.tspan.setAttributeNS(null,"font-style",r.fontStyle),r.fontWeight!==ht.fontWeight&&r.tspan.setAttributeNS(null,"font-weight",r.fontWeight);const L=r.textRenderingMode&R.TextRenderingMode.FILL_STROKE_MASK;if(L===R.TextRenderingMode.FILL||L===R.TextRenderingMode.FILL_STROKE?(r.fillColor!==ht.fillColor&&r.tspan.setAttributeNS(null,"fill",r.fillColor),r.fillAlpha<1&&r.tspan.setAttributeNS(null,"fill-opacity",r.fillAlpha)):r.textRenderingMode===R.TextRenderingMode.ADD_TO_PATH?r.tspan.setAttributeNS(null,"fill","transparent"):r.tspan.setAttributeNS(null,"fill","none"),L===R.TextRenderingMode.STROKE||L===R.TextRenderingMode.FILL_STROKE){const rt=1/(r.textMatrixScale||1);this._setStrokeAttributes(r.tspan,rt)}let Y=r.textMatrix;r.textRise!==0&&(Y=Y.slice(),Y[5]+=r.textRise),r.txtElement.setAttributeNS(null,"transform",`${v(Y)} scale(${S(V)}, -1)`),r.txtElement.setAttributeNS(q,"xml:space","preserve"),r.txtElement.append(r.tspan),r.txtgrp.append(r.txtElement),this._ensureTransformGroup().append(r.txtElement)}setLeadingMoveText(n,r){this.setLeading(-r),this.moveText(n,r)}addFontStyle(n){if(!n.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const r=m(n.data,n.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${n.loadedName}"; src: url(${r}); }
`}setFont(n){const r=this.current,F=this.commonObjs.get(n[0]);let f=n[1];r.font=F,this.embedFonts&&!F.missingFile&&!this.embeddedFonts[F.loadedName]&&(this.addFontStyle(F),this.embeddedFonts[F.loadedName]=F),r.fontMatrix=F.fontMatrix||R.FONT_IDENTITY_MATRIX;let i="normal";F.black?i="900":F.bold&&(i="bold");const P=F.italic?"italic":"normal";f<0?(f=-f,r.fontDirection=-1):r.fontDirection=1,r.fontSize=f,r.fontFamily=F.loadedName,r.fontWeight=i,r.fontStyle=P,r.tspan=this.svgFactory.createElement("svg:tspan"),r.tspan.setAttributeNS(null,"y",S(-r.y)),r.xcoords=[],r.ycoords=[]}endText(){var r;const n=this.current;n.textRenderingMode&R.TextRenderingMode.ADD_TO_PATH_FLAG&&((r=n.txtElement)!=null&&r.hasChildNodes())&&(n.element=n.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(n){n>0&&(this.current.lineWidth=n)}setLineCap(n){this.current.lineCap=j[n]}setLineJoin(n){this.current.lineJoin=D[n]}setMiterLimit(n){this.current.miterLimit=n}setStrokeAlpha(n){this.current.strokeAlpha=n}setStrokeRGBColor(n,r,F){this.current.strokeColor=R.Util.makeHexColor(n,r,F)}setFillAlpha(n){this.current.fillAlpha=n}setFillRGBColor(n,r,F){this.current.fillColor=R.Util.makeHexColor(n,r,F),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(n){this.current.strokeColor=this._makeColorN_Pattern(n)}setFillColorN(n){this.current.fillColor=this._makeColorN_Pattern(n)}shadingFill(n){const{width:r,height:F}=this.viewport,f=R.Util.inverseTransform(this.transformMatrix),[i,P,g,W]=R.Util.getAxialAlignedBoundingBox([0,0,r,F],f),V=this.svgFactory.createElement("svg:rect");V.setAttributeNS(null,"x",i),V.setAttributeNS(null,"y",P),V.setAttributeNS(null,"width",g-i),V.setAttributeNS(null,"height",W-P),V.setAttributeNS(null,"fill",this._makeShadingPattern(n)),this.current.fillAlpha<1&&V.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(V)}_makeColorN_Pattern(n){return n[0]==="TilingPattern"?this._makeTilingPattern(n):this._makeShadingPattern(n)}_makeTilingPattern(n){const r=n[1],F=n[2],f=n[3]||R.IDENTITY_MATRIX,[i,P,g,W]=n[4],V=n[5],E=n[6],z=n[7],nt=`shading${w++}`,[ct,u,L,Y]=R.Util.normalizeRect([...R.Util.applyTransform([i,P],f),...R.Util.applyTransform([g,W],f)]),[rt,_t]=R.Util.singularValueDecompose2dScale(f),d=V*rt,e=E*_t,s=this.svgFactory.createElement("svg:pattern");s.setAttributeNS(null,"id",nt),s.setAttributeNS(null,"patternUnits","userSpaceOnUse"),s.setAttributeNS(null,"width",d),s.setAttributeNS(null,"height",e),s.setAttributeNS(null,"x",`${ct}`),s.setAttributeNS(null,"y",`${u}`);const c=this.svg,C=this.transformMatrix,y=this.current.fillColor,N=this.current.strokeColor,H=this.svgFactory.create(L-ct,Y-u);if(this.svg=H,this.transformMatrix=f,z===2){const K=R.Util.makeHexColor(...r);this.current.fillColor=K,this.current.strokeColor=K}return this.executeOpTree(this.convertOpList(F)),this.svg=c,this.transformMatrix=C,this.current.fillColor=y,this.current.strokeColor=N,s.append(H.childNodes[0]),this.defs.append(s),`url(#${nt})`}_makeShadingPattern(n){switch(typeof n=="string"&&(n=this.objs.get(n)),n[0]){case"RadialAxial":const r=`shading${w++}`,F=n[3];let f;switch(n[1]){case"axial":const i=n[4],P=n[5];f=this.svgFactory.createElement("svg:linearGradient"),f.setAttributeNS(null,"id",r),f.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),f.setAttributeNS(null,"x1",i[0]),f.setAttributeNS(null,"y1",i[1]),f.setAttributeNS(null,"x2",P[0]),f.setAttributeNS(null,"y2",P[1]);break;case"radial":const g=n[4],W=n[5],V=n[6],E=n[7];f=this.svgFactory.createElement("svg:radialGradient"),f.setAttributeNS(null,"id",r),f.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),f.setAttributeNS(null,"cx",W[0]),f.setAttributeNS(null,"cy",W[1]),f.setAttributeNS(null,"r",E),f.setAttributeNS(null,"fx",g[0]),f.setAttributeNS(null,"fy",g[1]),f.setAttributeNS(null,"fr",V);break;default:throw new Error(`Unknown RadialAxial type: ${n[1]}`)}for(const i of F){const P=this.svgFactory.createElement("svg:stop");P.setAttributeNS(null,"offset",i[0]),P.setAttributeNS(null,"stop-color",i[1]),f.append(P)}return this.defs.append(f),`url(#${r})`;case"Mesh":return(0,R.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${n[0]}`)}}setDash(n,r){this.current.dashArray=n,this.current.dashPhase=r}constructPath(n,r){const F=this.current;let f=F.x,i=F.y,P=[],g=0;for(const W of n)switch(W|0){case R.OPS.rectangle:f=r[g++],i=r[g++];const V=r[g++],E=r[g++],z=f+V,nt=i+E;P.push("M",S(f),S(i),"L",S(z),S(i),"L",S(z),S(nt),"L",S(f),S(nt),"Z");break;case R.OPS.moveTo:f=r[g++],i=r[g++],P.push("M",S(f),S(i));break;case R.OPS.lineTo:f=r[g++],i=r[g++],P.push("L",S(f),S(i));break;case R.OPS.curveTo:f=r[g+4],i=r[g+5],P.push("C",S(r[g]),S(r[g+1]),S(r[g+2]),S(r[g+3]),S(f),S(i)),g+=6;break;case R.OPS.curveTo2:P.push("C",S(f),S(i),S(r[g]),S(r[g+1]),S(r[g+2]),S(r[g+3])),f=r[g+2],i=r[g+3],g+=4;break;case R.OPS.curveTo3:f=r[g+2],i=r[g+3],P.push("C",S(r[g]),S(r[g+1]),S(f),S(i),S(f),S(i)),g+=4;break;case R.OPS.closePath:P.push("Z");break}P=P.join(" "),F.path&&n.length>0&&n[0]!==R.OPS.rectangle&&n[0]!==R.OPS.moveTo?P=F.path.getAttributeNS(null,"d")+P:(F.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(F.path)),F.path.setAttributeNS(null,"d",P),F.path.setAttributeNS(null,"fill","none"),F.element=F.path,F.setCurrentPoint(f,i)}endPath(){const n=this.current;if(n.path=null,!this.pendingClip)return;if(!n.element){this.pendingClip=null;return}const r=`clippath${h++}`,F=this.svgFactory.createElement("svg:clipPath");F.setAttributeNS(null,"id",r),F.setAttributeNS(null,"transform",v(this.transformMatrix));const f=n.element.cloneNode(!0);if(this.pendingClip==="evenodd"?f.setAttributeNS(null,"clip-rule","evenodd"):f.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,F.append(f),this.defs.append(F),n.activeClipUrl){n.clipGroup=null;for(const i of this.extraStack)i.clipGroup=null;F.setAttributeNS(null,"clip-path",n.activeClipUrl)}n.activeClipUrl=`url(#${r})`,this.tgrp=null}clip(n){this.pendingClip=n}closePath(){const n=this.current;if(n.path){const r=`${n.path.getAttributeNS(null,"d")}Z`;n.path.setAttributeNS(null,"d",r)}}setLeading(n){this.current.leading=-n}setTextRise(n){this.current.textRise=n}setTextRenderingMode(n){this.current.textRenderingMode=n}setHScale(n){this.current.textHScale=n/100}setRenderingIntent(n){}setFlatness(n){}setGState(n){for(const[r,F]of n)switch(r){case"LW":this.setLineWidth(F);break;case"LC":this.setLineCap(F);break;case"LJ":this.setLineJoin(F);break;case"ML":this.setMiterLimit(F);break;case"D":this.setDash(F[0],F[1]);break;case"RI":this.setRenderingIntent(F);break;case"FL":this.setFlatness(F);break;case"Font":this.setFont(F);break;case"CA":this.setStrokeAlpha(F);break;case"ca":this.setFillAlpha(F);break;default:(0,R.warn)(`Unimplemented graphic state operator ${r}`);break}}fill(){const n=this.current;n.element&&(n.element.setAttributeNS(null,"fill",n.fillColor),n.element.setAttributeNS(null,"fill-opacity",n.fillAlpha),this.endPath())}stroke(){const n=this.current;n.element&&(this._setStrokeAttributes(n.element),n.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(n,r=1){const F=this.current;let f=F.dashArray;r!==1&&f.length>0&&(f=f.map(function(i){return r*i})),n.setAttributeNS(null,"stroke",F.strokeColor),n.setAttributeNS(null,"stroke-opacity",F.strokeAlpha),n.setAttributeNS(null,"stroke-miterlimit",S(F.miterLimit)),n.setAttributeNS(null,"stroke-linecap",F.lineCap),n.setAttributeNS(null,"stroke-linejoin",F.lineJoin),n.setAttributeNS(null,"stroke-width",S(r*F.lineWidth)+"px"),n.setAttributeNS(null,"stroke-dasharray",f.map(S).join(" ")),n.setAttributeNS(null,"stroke-dashoffset",S(r*F.dashPhase)+"px")}eoFill(){var n;(n=this.current.element)==null||n.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var n;(n=this.current.element)==null||n.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const n=this.svgFactory.createElement("svg:rect");n.setAttributeNS(null,"x","0"),n.setAttributeNS(null,"y","0"),n.setAttributeNS(null,"width","1px"),n.setAttributeNS(null,"height","1px"),n.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(n)}paintImageXObject(n){const r=this.getObject(n);if(!r){(0,R.warn)(`Dependent image with object ID ${n} is not ready yet`);return}this.paintInlineImageXObject(r)}paintInlineImageXObject(n,r){const F=n.width,f=n.height,i=O(n,this.forceDataSchema,!!r),P=this.svgFactory.createElement("svg:rect");P.setAttributeNS(null,"x","0"),P.setAttributeNS(null,"y","0"),P.setAttributeNS(null,"width",S(F)),P.setAttributeNS(null,"height",S(f)),this.current.element=P,this.clip("nonzero");const g=this.svgFactory.createElement("svg:image");g.setAttributeNS(ut,"xlink:href",i),g.setAttributeNS(null,"x","0"),g.setAttributeNS(null,"y",S(-f)),g.setAttributeNS(null,"width",S(F)+"px"),g.setAttributeNS(null,"height",S(f)+"px"),g.setAttributeNS(null,"transform",`scale(${S(1/F)} ${S(-1/f)})`),r?r.append(g):this._ensureTransformGroup().append(g)}paintImageMaskXObject(n){const r=this.getObject(n.data,n);if(r.bitmap){(0,R.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const F=this.current,f=r.width,i=r.height,P=F.fillColor;F.maskId=`mask${_++}`;const g=this.svgFactory.createElement("svg:mask");g.setAttributeNS(null,"id",F.maskId);const W=this.svgFactory.createElement("svg:rect");W.setAttributeNS(null,"x","0"),W.setAttributeNS(null,"y","0"),W.setAttributeNS(null,"width",S(f)),W.setAttributeNS(null,"height",S(i)),W.setAttributeNS(null,"fill",P),W.setAttributeNS(null,"mask",`url(#${F.maskId})`),this.defs.append(g),this._ensureTransformGroup().append(W),this.paintInlineImageXObject(r,g)}paintFormXObjectBegin(n,r){if(Array.isArray(n)&&n.length===6&&this.transform(n[0],n[1],n[2],n[3],n[4],n[5]),r){const F=r[2]-r[0],f=r[3]-r[1],i=this.svgFactory.createElement("svg:rect");i.setAttributeNS(null,"x",r[0]),i.setAttributeNS(null,"y",r[1]),i.setAttributeNS(null,"width",S(F)),i.setAttributeNS(null,"height",S(f)),this.current.element=i,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(n){const r=this.svgFactory.create(n.width,n.height),F=this.svgFactory.createElement("svg:defs");r.append(F),this.defs=F;const f=this.svgFactory.createElement("svg:g");return f.setAttributeNS(null,"transform",v(n.transform)),r.append(f),this.svg=f,r}_ensureClipGroup(){if(!this.current.clipGroup){const n=this.svgFactory.createElement("svg:g");n.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(n),this.current.clipGroup=n}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",v(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}o.SVGGraphics=x},(ot,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.XfaText=void 0;class at{static textContent(R){const ht=[],q={items:ht,styles:Object.create(null)};function ut(j){var O;if(!j)return;let D=null;const m=j.name;if(m==="#text")D=j.value;else if(at.shouldBuildText(m))(O=j==null?void 0:j.attributes)!=null&&O.textContent?D=j.attributes.textContent:j.value&&(D=j.value);else return;if(D!==null&&ht.push({str:D}),!!j.children)for(const B of j.children)ut(B)}return ut(R),q}static shouldBuildText(R){return!(R==="textarea"||R==="input"||R==="option"||R==="select")}}o.XfaText=at},(ot,o,at)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.TextLayerRenderTask=void 0,o.renderTextLayer=v,o.updateTextLayer=h;var l=at(1),R=at(6);const ht=1e5,q=30,ut=.8,j=new Map;function D(_,w){let x;if(w&&l.FeatureTest.isOffscreenCanvasSupported)x=new OffscreenCanvas(_,_).getContext("2d",{alpha:!1});else{const A=document.createElement("canvas");A.width=A.height=_,x=A.getContext("2d",{alpha:!1})}return x}function m(_,w){const x=j.get(_);if(x)return x;const A=D(q,w);A.font=`${q}px ${_}`;const n=A.measureText("");let r=n.fontBoundingBoxAscent,F=Math.abs(n.fontBoundingBoxDescent);if(r){const i=r/(r+F);return j.set(_,i),A.canvas.width=A.canvas.height=0,i}A.strokeStyle="red",A.clearRect(0,0,q,q),A.strokeText("g",0,0);let f=A.getImageData(0,0,q,q).data;F=0;for(let i=f.length-1-3;i>=0;i-=4)if(f[i]>0){F=Math.ceil(i/4/q);break}A.clearRect(0,0,q,q),A.strokeText("A",0,q),f=A.getImageData(0,0,q,q).data,r=0;for(let i=0,P=f.length;i<P;i+=4)if(f[i]>0){r=q-Math.floor(i/4/q);break}if(A.canvas.width=A.canvas.height=0,r){const i=r/(r+F);return j.set(_,i),i}return j.set(_,ut),ut}function O(_,w,x){const A=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:w.str!=="",hasEOL:w.hasEOL,fontSize:0};_._textDivs.push(A);const r=l.Util.transform(_._transform,w.transform);let F=Math.atan2(r[1],r[0]);const f=x[w.fontName];f.vertical&&(F+=Math.PI/2);const i=Math.hypot(r[2],r[3]),P=i*m(f.fontFamily,_._isOffscreenCanvasSupported);let g,W;F===0?(g=r[4],W=r[5]-P):(g=r[4]+P*Math.sin(F),W=r[5]-P*Math.cos(F));const V="calc(var(--scale-factor)*",E=A.style;_._container===_._rootContainer?(E.left=`${(100*g/_._pageWidth).toFixed(2)}%`,E.top=`${(100*W/_._pageHeight).toFixed(2)}%`):(E.left=`${V}${g.toFixed(2)}px)`,E.top=`${V}${W.toFixed(2)}px)`),E.fontSize=`${V}${i.toFixed(2)}px)`,E.fontFamily=f.fontFamily,n.fontSize=i,A.setAttribute("role","presentation"),A.textContent=w.str,A.dir=w.dir,_._fontInspectorEnabled&&(A.dataset.fontName=w.fontName),F!==0&&(n.angle=F*(180/Math.PI));let z=!1;if(w.str.length>1)z=!0;else if(w.str!==" "&&w.transform[0]!==w.transform[3]){const nt=Math.abs(w.transform[0]),ct=Math.abs(w.transform[3]);nt!==ct&&Math.max(nt,ct)/Math.min(nt,ct)>1.5&&(z=!0)}z&&(n.canvasWidth=f.vertical?w.height:w.width),_._textDivProperties.set(A,n),_._isReadableStream&&_._layoutText(A)}function B(_){const{div:w,scale:x,properties:A,ctx:n,prevFontSize:r,prevFontFamily:F}=_,{style:f}=w;let i="";if(A.canvasWidth!==0&&A.hasText){const{fontFamily:P}=f,{canvasWidth:g,fontSize:W}=A;(r!==W||F!==P)&&(n.font=`${W*x}px ${P}`,_.prevFontSize=W,_.prevFontFamily=P);const{width:V}=n.measureText(w.textContent);V>0&&(i=`scaleX(${g*x/V})`)}A.angle!==0&&(i=`rotate(${A.angle}deg) ${i}`),i.length>0&&(f.transform=i)}function M(_){if(_._canceled)return;const w=_._textDivs,x=_._capability;if(w.length>ht){x.resolve();return}if(!_._isReadableStream)for(const n of w)_._layoutText(n);x.resolve()}class S{constructor({textContentSource:w,container:x,viewport:A,textDivs:n,textDivProperties:r,textContentItemsStr:F,isOffscreenCanvasSupported:f}){var V;this._textContentSource=w,this._isReadableStream=w instanceof ReadableStream,this._container=this._rootContainer=x,this._textDivs=n||[],this._textContentItemsStr=F||[],this._isOffscreenCanvasSupported=f,this._fontInspectorEnabled=!!((V=globalThis.FontInspector)!=null&&V.enabled),this._reader=null,this._textDivProperties=r||new WeakMap,this._canceled=!1,this._capability=new l.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:A.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:D(0,f)};const{pageWidth:i,pageHeight:P,pageX:g,pageY:W}=A.rawDims;this._transform=[1,0,0,-1,-g,W+P],this._pageWidth=i,this._pageHeight=P,(0,R.setLayerDimensions)(x,A),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new l.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new l.AbortException("TextLayer task cancelled."))}_processItems(w,x){for(const A of w){if(A.str===void 0){if(A.type==="beginMarkedContentProps"||A.type==="beginMarkedContent"){const n=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),A.id!==null&&this._container.setAttribute("id",`${A.id}`),n.append(this._container)}else A.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(A.str),O(this,A,x)}}_layoutText(w){const x=this._layoutTextParams.properties=this._textDivProperties.get(w);if(this._layoutTextParams.div=w,B(this._layoutTextParams),x.hasText&&this._container.append(w),x.hasEOL){const A=document.createElement("br");A.setAttribute("role","presentation"),this._container.append(A)}}_render(){const w=new l.PromiseCapability;let x=Object.create(null);if(this._isReadableStream){const A=()=>{this._reader.read().then(({value:n,done:r})=>{if(r){w.resolve();return}Object.assign(x,n.styles),this._processItems(n.items,x),A()},w.reject)};this._reader=this._textContentSource.getReader(),A()}else if(this._textContentSource){const{items:A,styles:n}=this._textContentSource;this._processItems(A,n),w.resolve()}else throw new Error('No "textContentSource" parameter specified.');w.promise.then(()=>{x=null,M(this)},this._capability.reject)}}o.TextLayerRenderTask=S;function v(_){!_.textContentSource&&(_.textContent||_.textContentStream)&&((0,R.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),_.textContentSource=_.textContent||_.textContentStream);const{container:w,viewport:x}=_,A=getComputedStyle(w),n=A.getPropertyValue("visibility"),r=parseFloat(A.getPropertyValue("--scale-factor"));n==="visible"&&(!r||Math.abs(r-x.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const F=new S(_);return F._render(),F}function h({container:_,viewport:w,textDivs:x,textDivProperties:A,isOffscreenCanvasSupported:n,mustRotate:r=!0,mustRescale:F=!0}){if(r&&(0,R.setLayerDimensions)(_,{rotation:w.rotation}),F){const f=D(0,n),P={prevFontSize:null,prevFontFamily:null,div:null,scale:w.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:f};for(const g of x)P.properties=A.get(g),P.div=g,B(P)}}},(ot,o,at)=>{var m,O,B,M,S,v,h,_,w,x,A,Ve,r,Ee,f,ze,P,$e;Object.defineProperty(o,"__esModule",{value:!0}),o.AnnotationEditorLayer=void 0;var l=at(1),R=at(4),ht=at(28),q=at(33),ut=at(6),j=at(34);const W=class W{constructor({uiManager:E,pageIndex:z,div:nt,accessibilityManager:ct,annotationLayer:u,viewport:L,l10n:Y}){I(this,A);I(this,r);I(this,f);I(this,P);I(this,m,void 0);I(this,O,!1);I(this,B,null);I(this,M,this.pointerup.bind(this));I(this,S,this.pointerdown.bind(this));I(this,v,new Map);I(this,h,!1);I(this,_,!1);I(this,w,!1);I(this,x,void 0);const rt=[ht.FreeTextEditor,q.InkEditor,j.StampEditor];if(!W._initialized){W._initialized=!0;for(const _t of rt)_t.initialize(Y)}E.registerEditorTypes(rt),it(this,x,E),this.pageIndex=z,this.div=nt,it(this,m,ct),it(this,B,u),this.viewport=L,t(this,x).addLayer(this)}get isEmpty(){return t(this,v).size===0}updateToolbar(E){t(this,x).updateToolbar(E)}updateMode(E=t(this,x).getMode()){X(this,P,$e).call(this),E===l.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),E!==l.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",E===l.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",E===l.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",E===l.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(E){if(!E&&t(this,x).getMode()!==l.AnnotationEditorType.INK)return;if(!E){for(const nt of t(this,v).values())if(nt.isEmpty()){nt.setInBackground();return}}X(this,r,Ee).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(E){t(this,x).setEditingState(E)}addCommands(E){t(this,x).addCommands(E)}enable(){this.div.style.pointerEvents="auto";const E=new Set;for(const nt of t(this,v).values())nt.enableEditing(),nt.annotationElementId&&E.add(nt.annotationElementId);if(!t(this,B))return;const z=t(this,B).getEditableAnnotations();for(const nt of z){if(nt.hide(),t(this,x).isDeletedAnnotationElement(nt.data.id)||E.has(nt.data.id))continue;const ct=this.deserialize(nt);ct&&(this.addOrRebuild(ct),ct.enableEditing())}}disable(){var z;it(this,w,!0),this.div.style.pointerEvents="none";const E=new Set;for(const nt of t(this,v).values()){if(nt.disableEditing(),!nt.annotationElementId||nt.serialize()!==null){E.add(nt.annotationElementId);continue}(z=this.getEditableAnnotation(nt.annotationElementId))==null||z.show(),nt.remove()}if(t(this,B)){const nt=t(this,B).getEditableAnnotations();for(const ct of nt){const{id:u}=ct.data;E.has(u)||t(this,x).isDeletedAnnotationElement(u)||ct.show()}}X(this,P,$e).call(this),this.isEmpty&&(this.div.hidden=!0),it(this,w,!1)}getEditableAnnotation(E){var z;return((z=t(this,B))==null?void 0:z.getEditableAnnotation(E))||null}setActiveEditor(E){t(this,x).getActive()!==E&&t(this,x).setActiveEditor(E)}enableClick(){this.div.addEventListener("pointerdown",t(this,S)),this.div.addEventListener("pointerup",t(this,M))}disableClick(){this.div.removeEventListener("pointerdown",t(this,S)),this.div.removeEventListener("pointerup",t(this,M))}attach(E){t(this,v).set(E.id,E);const{annotationElementId:z}=E;z&&t(this,x).isDeletedAnnotationElement(z)&&t(this,x).removeDeletedAnnotationElement(E)}detach(E){var z;t(this,v).delete(E.id),(z=t(this,m))==null||z.removePointerInTextLayer(E.contentDiv),!t(this,w)&&E.annotationElementId&&t(this,x).addDeletedAnnotationElement(E)}remove(E){this.detach(E),t(this,x).removeEditor(E),E.div.contains(document.activeElement)&&setTimeout(()=>{t(this,x).focusMainContainer()},0),E.div.remove(),E.isAttachedToDOM=!1,t(this,_)||this.addInkEditorIfNeeded(!1)}changeParent(E){var z;E.parent!==this&&(E.annotationElementId&&(t(this,x).addDeletedAnnotationElement(E.annotationElementId),R.AnnotationEditor.deleteAnnotationElement(E),E.annotationElementId=null),this.attach(E),(z=E.parent)==null||z.detach(E),E.setParent(this),E.div&&E.isAttachedToDOM&&(E.div.remove(),this.div.append(E.div)))}add(E){if(this.changeParent(E),t(this,x).addEditor(E),this.attach(E),!E.isAttachedToDOM){const z=E.render();this.div.append(z),E.isAttachedToDOM=!0}this.moveEditorInDOM(E),E.onceAdded(),t(this,x).addToAnnotationStorage(E)}moveEditorInDOM(E){var nt;if(!E.isAttachedToDOM)return;const{activeElement:z}=document;E.div.contains(z)&&(E._focusEventsAllowed=!1,setTimeout(()=>{E.div.addEventListener("focusin",()=>{E._focusEventsAllowed=!0},{once:!0}),z.focus()},0)),(nt=t(this,m))==null||nt.moveElementInDOM(this.div,E.div,E.contentDiv,!0)}addOrRebuild(E){E.needsToBeRebuilt()?E.rebuild():this.add(E)}addUndoableEditor(E){const z=()=>E._uiManager.rebuild(E),nt=()=>{E.remove()};this.addCommands({cmd:z,undo:nt,mustExec:!1})}getNextId(){return t(this,x).getId()}pasteEditor(E,z){t(this,x).updateToolbar(E),t(this,x).updateMode(E);const{offsetX:nt,offsetY:ct}=X(this,f,ze).call(this),u=this.getNextId(),L=X(this,A,Ve).call(this,{parent:this,id:u,x:nt,y:ct,uiManager:t(this,x),isCentered:!0,...z});L&&this.add(L)}deserialize(E){switch(E.annotationType??E.annotationEditorType){case l.AnnotationEditorType.FREETEXT:return ht.FreeTextEditor.deserialize(E,this,t(this,x));case l.AnnotationEditorType.INK:return q.InkEditor.deserialize(E,this,t(this,x));case l.AnnotationEditorType.STAMP:return j.StampEditor.deserialize(E,this,t(this,x))}return null}addNewEditor(){X(this,r,Ee).call(this,X(this,f,ze).call(this),!0)}setSelected(E){t(this,x).setSelected(E)}toggleSelected(E){t(this,x).toggleSelected(E)}isSelected(E){return t(this,x).isSelected(E)}unselect(E){t(this,x).unselect(E)}pointerup(E){const{isMac:z}=l.FeatureTest.platform;if(!(E.button!==0||E.ctrlKey&&z)&&E.target===this.div&&t(this,h)){if(it(this,h,!1),!t(this,O)){it(this,O,!0);return}if(t(this,x).getMode()===l.AnnotationEditorType.STAMP){t(this,x).unselectAll();return}X(this,r,Ee).call(this,E,!1)}}pointerdown(E){if(t(this,h)){it(this,h,!1);return}const{isMac:z}=l.FeatureTest.platform;if(E.button!==0||E.ctrlKey&&z||E.target!==this.div)return;it(this,h,!0);const nt=t(this,x).getActive();it(this,O,!nt||nt.isEmpty())}findNewParent(E,z,nt){const ct=t(this,x).findParent(z,nt);return ct===null||ct===this?!1:(ct.changeParent(E),!0)}destroy(){var E,z;((E=t(this,x).getActive())==null?void 0:E.parent)===this&&t(this,x).setActiveEditor(null);for(const nt of t(this,v).values())(z=t(this,m))==null||z.removePointerInTextLayer(nt.contentDiv),nt.setParent(null),nt.isAttachedToDOM=!1,nt.div.remove();this.div=null,t(this,v).clear(),t(this,x).removeLayer(this)}render({viewport:E}){this.viewport=E,(0,ut.setLayerDimensions)(this.div,E);for(const z of t(this,x).getEditors(this.pageIndex))this.add(z);this.updateMode()}update({viewport:E}){t(this,x).commitOrRemove(),this.viewport=E,(0,ut.setLayerDimensions)(this.div,{rotation:E.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:E,pageHeight:z}=this.viewport.rawDims;return[E,z]}};m=new WeakMap,O=new WeakMap,B=new WeakMap,M=new WeakMap,S=new WeakMap,v=new WeakMap,h=new WeakMap,_=new WeakMap,w=new WeakMap,x=new WeakMap,A=new WeakSet,Ve=function(E){switch(t(this,x).getMode()){case l.AnnotationEditorType.FREETEXT:return new ht.FreeTextEditor(E);case l.AnnotationEditorType.INK:return new q.InkEditor(E);case l.AnnotationEditorType.STAMP:return new j.StampEditor(E)}return null},r=new WeakSet,Ee=function(E,z){const nt=this.getNextId(),ct=X(this,A,Ve).call(this,{parent:this,id:nt,x:E.offsetX,y:E.offsetY,uiManager:t(this,x),isCentered:z});return ct&&this.add(ct),ct},f=new WeakSet,ze=function(){const{x:E,y:z,width:nt,height:ct}=this.div.getBoundingClientRect(),u=Math.max(0,E),L=Math.max(0,z),Y=Math.min(window.innerWidth,E+nt),rt=Math.min(window.innerHeight,z+ct),_t=(u+Y)/2-E,d=(L+rt)/2-z,[e,s]=this.viewport.rotation%180===0?[_t,d]:[d,_t];return{offsetX:e,offsetY:s}},P=new WeakSet,$e=function(){it(this,_,!0);for(const E of t(this,v).values())E.isEmpty()&&E.remove();it(this,_,!1)},Yt(W,"_initialized",!1);let D=W;o.AnnotationEditorLayer=D},(ot,o,at)=>{var j,D,m,O,B,M,S,v,h,_,Us,x,js,n,Hs,F,ge,i,Xe,g,Ws,V,qe;Object.defineProperty(o,"__esModule",{value:!0}),o.FreeTextEditor=void 0;var l=at(1),R=at(5),ht=at(4),q=at(29);const z=class z extends ht.AnnotationEditor{constructor(u){super({...u,name:"freeTextEditor"});I(this,_);I(this,x);I(this,n);I(this,F);I(this,i);I(this,g);I(this,V);I(this,j,this.editorDivBlur.bind(this));I(this,D,this.editorDivFocus.bind(this));I(this,m,this.editorDivInput.bind(this));I(this,O,this.editorDivKeydown.bind(this));I(this,B,void 0);I(this,M,"");I(this,S,`${this.id}-editor`);I(this,v,void 0);I(this,h,null);it(this,B,u.color||z._defaultColor||ht.AnnotationEditor._defaultLineColor),it(this,v,u.fontSize||z._defaultFontSize)}static get _keyboardManager(){const u=z.prototype,L=_t=>_t.isEmpty(),Y=R.AnnotationEditorUIManager.TRANSLATE_SMALL,rt=R.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,l.shadow)(this,"_keyboardManager",new R.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],u.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],u.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],u._translateEmpty,{args:[-Y,0],checker:L}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],u._translateEmpty,{args:[-rt,0],checker:L}],[["ArrowRight","mac+ArrowRight"],u._translateEmpty,{args:[Y,0],checker:L}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],u._translateEmpty,{args:[rt,0],checker:L}],[["ArrowUp","mac+ArrowUp"],u._translateEmpty,{args:[0,-Y],checker:L}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],u._translateEmpty,{args:[0,-rt],checker:L}],[["ArrowDown","mac+ArrowDown"],u._translateEmpty,{args:[0,Y],checker:L}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],u._translateEmpty,{args:[0,rt],checker:L}]]))}static initialize(u){this._l10nPromise=new Map(["free_text2_default_content","editor_free_text2_aria_label"].map(Y=>[Y,u.get(Y)]));const L=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(L.getPropertyValue("--freetext-padding"))}static updateDefaultParams(u,L){switch(u){case l.AnnotationEditorParamsType.FREETEXT_SIZE:z._defaultFontSize=L;break;case l.AnnotationEditorParamsType.FREETEXT_COLOR:z._defaultColor=L;break}}updateParams(u,L){switch(u){case l.AnnotationEditorParamsType.FREETEXT_SIZE:X(this,_,Us).call(this,L);break;case l.AnnotationEditorParamsType.FREETEXT_COLOR:X(this,x,js).call(this,L);break}}static get defaultPropertiesToUpdate(){return[[l.AnnotationEditorParamsType.FREETEXT_SIZE,z._defaultFontSize],[l.AnnotationEditorParamsType.FREETEXT_COLOR,z._defaultColor||ht.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[l.AnnotationEditorParamsType.FREETEXT_SIZE,t(this,v)],[l.AnnotationEditorParamsType.FREETEXT_COLOR,t(this,B)]]}_translateEmpty(u,L){this._uiManager.translateSelectedEditors(u,L,!0)}getInitialTranslation(){const u=this.parentScale;return[-z._internalPadding*u,-(z._internalPadding+t(this,v))*u]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(l.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",t(this,O)),this.editorDiv.addEventListener("focus",t(this,D)),this.editorDiv.addEventListener("blur",t(this,j)),this.editorDiv.addEventListener("input",t(this,m)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",t(this,S)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",t(this,O)),this.editorDiv.removeEventListener("focus",t(this,D)),this.editorDiv.removeEventListener("blur",t(this,j)),this.editorDiv.removeEventListener("input",t(this,m)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(u){this._focusEventsAllowed&&(super.focusin(u),u.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var u;if(this.width){X(this,V,qe).call(this);return}this.enableEditMode(),this.editorDiv.focus(),(u=this._initialOptions)!=null&&u.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const u=t(this,M),L=it(this,M,X(this,n,Hs).call(this).trimEnd());if(u===L)return;const Y=rt=>{if(it(this,M,rt),!rt){this.remove();return}X(this,i,Xe).call(this),this._uiManager.rebuild(this),X(this,F,ge).call(this)};this.addCommands({cmd:()=>{Y(L)},undo:()=>{Y(u)},mustExec:!1}),X(this,F,ge).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(u){this.enterInEditMode()}keydown(u){u.target===this.div&&u.key==="Enter"&&(this.enterInEditMode(),u.preventDefault())}editorDivKeydown(u){z._keyboardManager.exec(this,u)}editorDivFocus(u){this.isEditing=!0}editorDivBlur(u){this.isEditing=!1}editorDivInput(u){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let u,L;this.width&&(u=this.x,L=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",t(this,S)),this.enableEditing(),z._l10nPromise.get("editor_free_text2_aria_label").then(rt=>{var _t;return(_t=this.editorDiv)==null?void 0:_t.setAttribute("aria-label",rt)}),z._l10nPromise.get("free_text2_default_content").then(rt=>{var _t;return(_t=this.editorDiv)==null?void 0:_t.setAttribute("default-content",rt)}),this.editorDiv.contentEditable=!0;const{style:Y}=this.editorDiv;if(Y.fontSize=`calc(${t(this,v)}px * var(--scale-factor))`,Y.color=t(this,B),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,R.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[rt,_t]=this.parentDimensions;if(this.annotationElementId){const{position:d}=t(this,h);let[e,s]=this.getInitialTranslation();[e,s]=this.pageTranslationToScreen(e,s);const[c,C]=this.pageDimensions,[y,N]=this.pageTranslation;let H,K;switch(this.rotation){case 0:H=u+(d[0]-y)/c,K=L+this.height-(d[1]-N)/C;break;case 90:H=u+(d[0]-y)/c,K=L-(d[1]-N)/C,[e,s]=[s,-e];break;case 180:H=u-this.width+(d[0]-y)/c,K=L-(d[1]-N)/C,[e,s]=[-e,-s];break;case 270:H=u+(d[0]-y-this.height*C)/c,K=L+(d[1]-N-this.width*c)/C,[e,s]=[-s,e];break}this.setAt(H*rt,K*_t,e,s)}else this.setAt(u*rt,L*_t,this.width*rt,this.height*_t);X(this,i,Xe).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(u,L,Y){let rt=null;if(u instanceof q.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:d,fontColor:e},rect:s,rotation:c,id:C},textContent:y,textPosition:N,parent:{page:{pageNumber:H}}}=u;if(!y||y.length===0)return null;rt=u={annotationType:l.AnnotationEditorType.FREETEXT,color:Array.from(e),fontSize:d,value:y.join(`
`),position:N,pageIndex:H-1,rect:s,rotation:c,id:C,deleted:!1}}const _t=super.deserialize(u,L,Y);return it(_t,v,u.fontSize),it(_t,B,l.Util.makeHexColor(...u.color)),it(_t,M,u.value),_t.annotationElementId=u.id||null,it(_t,h,rt),_t}serialize(u=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const L=z._internalPadding*this.parentScale,Y=this.getRect(L,L),rt=ht.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:t(this,B)),_t={annotationType:l.AnnotationEditorType.FREETEXT,color:rt,fontSize:t(this,v),value:t(this,M),pageIndex:this.pageIndex,rect:Y,rotation:this.rotation};return u?_t:this.annotationElementId&&!X(this,g,Ws).call(this,_t)?null:(_t.id=this.annotationElementId,_t)}};j=new WeakMap,D=new WeakMap,m=new WeakMap,O=new WeakMap,B=new WeakMap,M=new WeakMap,S=new WeakMap,v=new WeakMap,h=new WeakMap,_=new WeakSet,Us=function(u){const L=rt=>{this.editorDiv.style.fontSize=`calc(${rt}px * var(--scale-factor))`,this.translate(0,-(rt-t(this,v))*this.parentScale),it(this,v,rt),X(this,F,ge).call(this)},Y=t(this,v);this.addCommands({cmd:()=>{L(u)},undo:()=>{L(Y)},mustExec:!0,type:l.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},x=new WeakSet,js=function(u){const L=t(this,B);this.addCommands({cmd:()=>{it(this,B,this.editorDiv.style.color=u)},undo:()=>{it(this,B,this.editorDiv.style.color=L)},mustExec:!0,type:l.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},n=new WeakSet,Hs=function(){const u=this.editorDiv.getElementsByTagName("div");if(u.length===0)return this.editorDiv.innerText;const L=[];for(const Y of u)L.push(Y.innerText.replace(/\r\n?|\n/,""));return L.join(`
`)},F=new WeakSet,ge=function(){const[u,L]=this.parentDimensions;let Y;if(this.isAttachedToDOM)Y=this.div.getBoundingClientRect();else{const{currentLayer:rt,div:_t}=this,d=_t.style.display;_t.style.display="hidden",rt.div.append(this.div),Y=_t.getBoundingClientRect(),_t.remove(),_t.style.display=d}this.rotation%180===this.parentRotation%180?(this.width=Y.width/u,this.height=Y.height/L):(this.width=Y.height/u,this.height=Y.width/L),this.fixAndSetPosition()},i=new WeakSet,Xe=function(){if(this.editorDiv.replaceChildren(),!!t(this,M))for(const u of t(this,M).split(`
`)){const L=document.createElement("div");L.append(u?document.createTextNode(u):document.createElement("br")),this.editorDiv.append(L)}},g=new WeakSet,Ws=function(u){const{value:L,fontSize:Y,color:rt,rect:_t,pageIndex:d}=t(this,h);return u.value!==L||u.fontSize!==Y||u.rect.some((e,s)=>Math.abs(e-_t[s])>=1)||u.color.some((e,s)=>e!==rt[s])||u.pageIndex!==d},V=new WeakSet,qe=function(u=!1){if(!this.annotationElementId)return;if(X(this,F,ge).call(this),!u&&(this.width===0||this.height===0)){setTimeout(()=>X(this,V,qe).call(this,!0),0);return}const L=z._internalPadding*this.parentScale;t(this,h).rect=this.getRect(L,L)},Yt(z,"_freeTextDefaultContent",""),Yt(z,"_l10nPromise"),Yt(z,"_internalPadding",0),Yt(z,"_defaultColor",null),Yt(z,"_defaultFontSize",10),Yt(z,"_type","freetext");let ut=z;o.FreeTextEditor=ut},(ot,o,at)=>{var s,c,ne,y,Gs,H,K,ft,lt,dt,pt,kt,wt,Lt,Ut,Pt,Bt,Ct,st,tt,gt,Ft,Ye,Ht,Ke,Rt,Je,Gt,jt,mt,G,J,Tt,Vt,Nt,qt,Jt,Vs,St,Qe;Object.defineProperty(o,"__esModule",{value:!0}),o.StampAnnotationElement=o.InkAnnotationElement=o.FreeTextAnnotationElement=o.AnnotationLayer=void 0;var l=at(1),R=at(6),ht=at(3),q=at(30),ut=at(31),j=at(32);const D=1e3,m=9,O=new WeakSet;function B(Et){return{width:Et[2]-Et[0],height:Et[3]-Et[1]}}class M{static create(p){switch(p.data.annotationType){case l.AnnotationType.LINK:return new v(p);case l.AnnotationType.TEXT:return new h(p);case l.AnnotationType.WIDGET:switch(p.data.fieldType){case"Tx":return new w(p);case"Btn":return p.data.radioButton?new n(p):p.data.checkBox?new A(p):new r(p);case"Ch":return new F(p);case"Sig":return new x(p)}return new _(p);case l.AnnotationType.POPUP:return new f(p);case l.AnnotationType.FREETEXT:return new P(p);case l.AnnotationType.LINE:return new g(p);case l.AnnotationType.SQUARE:return new W(p);case l.AnnotationType.CIRCLE:return new V(p);case l.AnnotationType.POLYLINE:return new E(p);case l.AnnotationType.CARET:return new nt(p);case l.AnnotationType.INK:return new ct(p);case l.AnnotationType.POLYGON:return new z(p);case l.AnnotationType.HIGHLIGHT:return new u(p);case l.AnnotationType.UNDERLINE:return new L(p);case l.AnnotationType.SQUIGGLY:return new Y(p);case l.AnnotationType.STRIKEOUT:return new rt(p);case l.AnnotationType.STAMP:return new _t(p);case l.AnnotationType.FILEATTACHMENT:return new d(p);default:return new S(p)}}}class S{constructor(p,{isRenderable:a=!1,ignoreBorder:k=!1,createQuadrilaterals:T=!1}={}){I(this,s,!1);this.isRenderable=a,this.data=p.data,this.layer=p.layer,this.linkService=p.linkService,this.downloadManager=p.downloadManager,this.imageResourcesPath=p.imageResourcesPath,this.renderForms=p.renderForms,this.svgFactory=p.svgFactory,this.annotationStorage=p.annotationStorage,this.enableScripting=p.enableScripting,this.hasJSActions=p.hasJSActions,this._fieldObjects=p.fieldObjects,this.parent=p.parent,a&&(this.container=this._createContainer(k)),T&&this._createQuadrilaterals()}_createContainer(p){const{data:a,parent:{page:k,viewport:T}}=this,U=document.createElement("section");U.setAttribute("data-annotation-id",a.id),U.style.zIndex=this.parent.zIndex++,this.data.popupRef&&U.setAttribute("aria-haspopup","dialog"),a.noRotate&&U.classList.add("norotate");const{pageWidth:Z,pageHeight:At,pageX:b,pageY:$}=T.rawDims;if(!a.rect||this instanceof f){const{rotation:xt}=a;return!a.hasOwnCanvas&&xt!==0&&this.setRotation(xt,U),U}const{width:et,height:vt}=B(a.rect),bt=l.Util.normalizeRect([a.rect[0],k.view[3]-a.rect[1]+k.view[1],a.rect[2],k.view[3]-a.rect[3]+k.view[1]]);if(!p&&a.borderStyle.width>0){U.style.borderWidth=`${a.borderStyle.width}px`;const xt=a.borderStyle.horizontalCornerRadius,It=a.borderStyle.verticalCornerRadius;if(xt>0||It>0){const $t=`calc(${xt}px * var(--scale-factor)) / calc(${It}px * var(--scale-factor))`;U.style.borderRadius=$t}else if(this instanceof n){const $t=`calc(${et}px * var(--scale-factor)) / calc(${vt}px * var(--scale-factor))`;U.style.borderRadius=$t}switch(a.borderStyle.style){case l.AnnotationBorderStyleType.SOLID:U.style.borderStyle="solid";break;case l.AnnotationBorderStyleType.DASHED:U.style.borderStyle="dashed";break;case l.AnnotationBorderStyleType.BEVELED:(0,l.warn)("Unimplemented border style: beveled");break;case l.AnnotationBorderStyleType.INSET:(0,l.warn)("Unimplemented border style: inset");break;case l.AnnotationBorderStyleType.UNDERLINE:U.style.borderBottomStyle="solid";break}const zt=a.borderColor||null;zt?(it(this,s,!0),U.style.borderColor=l.Util.makeHexColor(zt[0]|0,zt[1]|0,zt[2]|0)):U.style.borderWidth=0}U.style.left=`${100*(bt[0]-b)/Z}%`,U.style.top=`${100*(bt[1]-$)/At}%`;const{rotation:yt}=a;return a.hasOwnCanvas||yt===0?(U.style.width=`${100*et/Z}%`,U.style.height=`${100*vt/At}%`):this.setRotation(yt,U),U}setRotation(p,a=this.container){if(!this.data.rect)return;const{pageWidth:k,pageHeight:T}=this.parent.viewport.rawDims,{width:U,height:Z}=B(this.data.rect);let At,b;p%180===0?(At=100*U/k,b=100*Z/T):(At=100*Z/k,b=100*U/T),a.style.width=`${At}%`,a.style.height=`${b}%`,a.setAttribute("data-main-rotation",(360-p)%360)}get _commonActions(){const p=(a,k,T)=>{const U=T.detail[a],Z=U[0],At=U.slice(1);T.target.style[k]=q.ColorConverters[`${Z}_HTML`](At),this.annotationStorage.setValue(this.data.id,{[k]:q.ColorConverters[`${Z}_rgb`](At)})};return(0,l.shadow)(this,"_commonActions",{display:a=>{const{display:k}=a.detail,T=k%2===1;this.container.style.visibility=T?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:T,noPrint:k===1||k===2})},print:a=>{this.annotationStorage.setValue(this.data.id,{noPrint:!a.detail.print})},hidden:a=>{const{hidden:k}=a.detail;this.container.style.visibility=k?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:k,noView:k})},focus:a=>{setTimeout(()=>a.target.focus({preventScroll:!1}),0)},userName:a=>{a.target.title=a.detail.userName},readonly:a=>{a.target.disabled=a.detail.readonly},required:a=>{this._setRequired(a.target,a.detail.required)},bgColor:a=>{p("bgColor","backgroundColor",a)},fillColor:a=>{p("fillColor","backgroundColor",a)},fgColor:a=>{p("fgColor","color",a)},textColor:a=>{p("textColor","color",a)},borderColor:a=>{p("borderColor","borderColor",a)},strokeColor:a=>{p("strokeColor","borderColor",a)},rotation:a=>{const k=a.detail.rotation;this.setRotation(k),this.annotationStorage.setValue(this.data.id,{rotation:k})}})}_dispatchEventFromSandbox(p,a){const k=this._commonActions;for(const T of Object.keys(a.detail)){const U=p[T]||k[T];U==null||U(a)}}_setDefaultPropertiesFromJS(p){if(!this.enableScripting)return;const a=this.annotationStorage.getRawValue(this.data.id);if(!a)return;const k=this._commonActions;for(const[T,U]of Object.entries(a)){const Z=k[T];if(Z){const At={detail:{[T]:U},target:p};Z(At),delete a[T]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:p}=this.data;if(!p)return;const[a,k,T,U]=this.data.rect;if(p.length===1){const[,{x:It,y:zt},{x:$t,y:Kt}]=p[0];if(T===It&&U===zt&&a===$t&&k===Kt)return}const{style:Z}=this.container;let At;if(t(this,s)){const{borderColor:It,borderWidth:zt}=Z;Z.borderWidth=0,At=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${It}" stroke-width="${zt}">`],this.container.classList.add("hasBorder")}const b=T-a,$=U-k,{svgFactory:et}=this,vt=et.createElement("svg");vt.classList.add("quadrilateralsContainer"),vt.setAttribute("width",0),vt.setAttribute("height",0);const bt=et.createElement("defs");vt.append(bt);const yt=et.createElement("clipPath"),xt=`clippath_${this.data.id}`;yt.setAttribute("id",xt),yt.setAttribute("clipPathUnits","objectBoundingBox"),bt.append(yt);for(const[,{x:It,y:zt},{x:$t,y:Kt}]of p){const Xt=et.createElement("rect"),Qt=($t-a)/b,te=(U-zt)/$,Zt=(It-$t)/b,ie=(zt-Kt)/$;Xt.setAttribute("x",Qt),Xt.setAttribute("y",te),Xt.setAttribute("width",Zt),Xt.setAttribute("height",ie),yt.append(Xt),At==null||At.push(`<rect vector-effect="non-scaling-stroke" x="${Qt}" y="${te}" width="${Zt}" height="${ie}"/>`)}t(this,s)&&(At.push("</g></svg>')"),Z.backgroundImage=At.join("")),this.container.append(vt),this.container.style.clipPath=`url(#${xt})`}_createPopup(){const{container:p,data:a}=this;p.setAttribute("aria-haspopup","dialog");const k=new f({data:{color:a.color,titleObj:a.titleObj,modificationDate:a.modificationDate,contentsObj:a.contentsObj,richText:a.richText,parentRect:a.rect,borderStyle:0,id:`popup_${a.id}`,rotation:a.rotation},parent:this.parent,elements:[this]});this.parent.div.append(k.render())}render(){(0,l.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(p,a=null){const k=[];if(this._fieldObjects){const T=this._fieldObjects[p];if(T)for(const{page:U,id:Z,exportValues:At}of T){if(U===-1||Z===a)continue;const b=typeof At=="string"?At:null,$=document.querySelector(`[data-element-id="${Z}"]`);if($&&!O.has($)){(0,l.warn)(`_getElementsByName - element not allowed: ${Z}`);continue}k.push({id:Z,exportValue:b,domElement:$})}return k}for(const T of document.getElementsByName(p)){const{exportValue:U}=T,Z=T.getAttribute("data-element-id");Z!==a&&O.has(T)&&k.push({id:Z,exportValue:U,domElement:T})}return k}show(){var p;this.container&&(this.container.hidden=!1),(p=this.popup)==null||p.maybeShow()}hide(){var p;this.container&&(this.container.hidden=!0),(p=this.popup)==null||p.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const p=this.getElementsToTriggerPopup();if(Array.isArray(p))for(const a of p)a.classList.add("highlightArea");else p.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:p,data:{id:a}}=this;this.container.addEventListener("dblclick",()=>{var k;(k=this.linkService.eventBus)==null||k.dispatch("switchannotationeditormode",{source:this,mode:p,editId:a})})}}s=new WeakMap;class v extends S{constructor(a,k=null){super(a,{isRenderable:!0,ignoreBorder:!!(k!=null&&k.ignoreBorder),createQuadrilaterals:!0});I(this,c);I(this,y);this.isTooltipOnly=a.data.isTooltipOnly}render(){const{data:a,linkService:k}=this,T=document.createElement("a");T.setAttribute("data-element-id",a.id);let U=!1;return a.url?(k.addLinkAttributes(T,a.url,a.newWindow),U=!0):a.action?(this._bindNamedAction(T,a.action),U=!0):a.attachment?(this._bindAttachment(T,a.attachment),U=!0):a.setOCGState?(X(this,y,Gs).call(this,T,a.setOCGState),U=!0):a.dest?(this._bindLink(T,a.dest),U=!0):(a.actions&&(a.actions.Action||a.actions["Mouse Up"]||a.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(T,a),U=!0),a.resetForm?(this._bindResetFormAction(T,a.resetForm),U=!0):this.isTooltipOnly&&!U&&(this._bindLink(T,""),U=!0)),this.container.classList.add("linkAnnotation"),U&&this.container.append(T),this.container}_bindLink(a,k){a.href=this.linkService.getDestinationHash(k),a.onclick=()=>(k&&this.linkService.goToDestination(k),!1),(k||k==="")&&X(this,c,ne).call(this)}_bindNamedAction(a,k){a.href=this.linkService.getAnchorUrl(""),a.onclick=()=>(this.linkService.executeNamedAction(k),!1),X(this,c,ne).call(this)}_bindAttachment(a,k){a.href=this.linkService.getAnchorUrl(""),a.onclick=()=>{var T;return(T=this.downloadManager)==null||T.openOrDownloadData(this.container,k.content,k.filename),!1},X(this,c,ne).call(this)}_bindJSAction(a,k){a.href=this.linkService.getAnchorUrl("");const T=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const U of Object.keys(k.actions)){const Z=T.get(U);Z&&(a[Z]=()=>{var At;return(At=this.linkService.eventBus)==null||At.dispatch("dispatcheventinsandbox",{source:this,detail:{id:k.id,name:U}}),!1})}a.onclick||(a.onclick=()=>!1),X(this,c,ne).call(this)}_bindResetFormAction(a,k){const T=a.onclick;if(T||(a.href=this.linkService.getAnchorUrl("")),X(this,c,ne).call(this),!this._fieldObjects){(0,l.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),T||(a.onclick=()=>!1);return}a.onclick=()=>{var vt;T==null||T();const{fields:U,refs:Z,include:At}=k,b=[];if(U.length!==0||Z.length!==0){const bt=new Set(Z);for(const yt of U){const xt=this._fieldObjects[yt]||[];for(const{id:It}of xt)bt.add(It)}for(const yt of Object.values(this._fieldObjects))for(const xt of yt)bt.has(xt.id)===At&&b.push(xt)}else for(const bt of Object.values(this._fieldObjects))b.push(...bt);const $=this.annotationStorage,et=[];for(const bt of b){const{id:yt}=bt;switch(et.push(yt),bt.type){case"text":{const It=bt.defaultValue||"";$.setValue(yt,{value:It});break}case"checkbox":case"radiobutton":{const It=bt.defaultValue===bt.exportValues;$.setValue(yt,{value:It});break}case"combobox":case"listbox":{const It=bt.defaultValue||"";$.setValue(yt,{value:It});break}default:continue}const xt=document.querySelector(`[data-element-id="${yt}"]`);if(xt){if(!O.has(xt)){(0,l.warn)(`_bindResetFormAction - element not allowed: ${yt}`);continue}}else continue;xt.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((vt=this.linkService.eventBus)==null||vt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:et,name:"ResetForm"}})),!1}}}c=new WeakSet,ne=function(){this.container.setAttribute("data-internal-link","")},y=new WeakSet,Gs=function(a,k){a.href=this.linkService.getAnchorUrl(""),a.onclick=()=>(this.linkService.executeSetOCGState(k),!1),X(this,c,ne).call(this)};class h extends S{constructor(p){var k,T,U;const a=!!(p.data.popupRef||(k=p.data.titleObj)!=null&&k.str||(T=p.data.contentsObj)!=null&&T.str||(U=p.data.richText)!=null&&U.str);super(p,{isRenderable:a})}render(){this.container.classList.add("textAnnotation");const p=document.createElement("img");return p.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",p.alt="[{{type}} Annotation]",p.dataset.l10nId="text_annotation_type",p.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.popupRef||this._createPopup(),this.container.append(p),this.container}}class _ extends S{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(p){var a;this.data.hasOwnCanvas&&(((a=p.previousSibling)==null?void 0:a.nodeName)==="CANVAS"&&(p.previousSibling.hidden=!0),p.hidden=!1)}_getKeyModifier(p){const{isWin:a,isMac:k}=l.FeatureTest.platform;return a&&p.ctrlKey||k&&p.metaKey}_setEventListener(p,a,k,T){a.includes("mouse")?p.addEventListener(a,U=>{var Z;(Z=this.linkService.eventBus)==null||Z.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:k,value:T(U),shift:U.shiftKey,modifier:this._getKeyModifier(U)}})}):p.addEventListener(a,U=>{var Z;(Z=this.linkService.eventBus)==null||Z.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:k,value:T(U)}})})}_setEventListeners(p,a,k){var T;for(const[U,Z]of a)(Z==="Action"||(T=this.data.actions)!=null&&T[Z])&&this._setEventListener(p,U,Z,k)}_setBackgroundColor(p){const a=this.data.backgroundColor||null;p.style.backgroundColor=a===null?"transparent":l.Util.makeHexColor(a[0],a[1],a[2])}_setTextStyle(p){const a=["left","center","right"],{fontColor:k}=this.data.defaultAppearanceData,T=this.data.defaultAppearanceData.fontSize||m,U=p.style;let Z;const At=2,b=$=>Math.round(10*$)/10;if(this.data.multiLine){const $=Math.abs(this.data.rect[3]-this.data.rect[1]-At),et=Math.round($/(l.LINE_FACTOR*T))||1,vt=$/et;Z=Math.min(T,b(vt/l.LINE_FACTOR))}else{const $=Math.abs(this.data.rect[3]-this.data.rect[1]-At);Z=Math.min(T,b($/l.LINE_FACTOR))}U.fontSize=`calc(${Z}px * var(--scale-factor))`,U.color=l.Util.makeHexColor(k[0],k[1],k[2]),this.data.textAlignment!==null&&(U.textAlign=a[this.data.textAlignment])}_setRequired(p,a){a?p.setAttribute("required",!0):p.removeAttribute("required"),p.setAttribute("aria-required",a)}}class w extends _{constructor(p){const a=p.renderForms||!p.data.hasAppearance&&!!p.data.fieldValue;super(p,{isRenderable:a})}setPropertyOnSiblings(p,a,k,T){const U=this.annotationStorage;for(const Z of this._getElementsByName(p.name,p.id))Z.domElement&&(Z.domElement[a]=k),U.setValue(Z.id,{[T]:k})}render(){var T,U;const p=this.annotationStorage,a=this.data.id;this.container.classList.add("textWidgetAnnotation");let k=null;if(this.renderForms){const Z=p.getValue(a,{value:this.data.fieldValue});let At=Z.value||"";const b=p.getValue(a,{charLimit:this.data.maxLen}).charLimit;b&&At.length>b&&(At=At.slice(0,b));let $=Z.formattedValue||((T=this.data.textContent)==null?void 0:T.join(`
`))||null;$&&this.data.comb&&($=$.replaceAll(/\s+/g,""));const et={userValue:At,formattedValue:$,lastCommittedValue:null,commitKey:1};this.data.multiLine?(k=document.createElement("textarea"),k.textContent=$??At,this.data.doNotScroll&&(k.style.overflowY="hidden")):(k=document.createElement("input"),k.type="text",k.setAttribute("value",$??At),this.data.doNotScroll&&(k.style.overflowX="hidden")),this.data.hasOwnCanvas&&(k.hidden=!0),O.add(k),k.setAttribute("data-element-id",a),k.disabled=this.data.readOnly,k.name=this.data.fieldName,k.tabIndex=D,this._setRequired(k,this.data.required),b&&(k.maxLength=b),k.addEventListener("input",bt=>{p.setValue(a,{value:bt.target.value}),this.setPropertyOnSiblings(k,"value",bt.target.value,"value"),et.formattedValue=null}),k.addEventListener("resetform",bt=>{const yt=this.data.defaultFieldValue??"";k.value=et.userValue=yt,et.formattedValue=null});let vt=bt=>{const{formattedValue:yt}=et;yt!=null&&(bt.target.value=yt),bt.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){k.addEventListener("focus",yt=>{const{target:xt}=yt;et.userValue&&(xt.value=et.userValue),et.lastCommittedValue=xt.value,et.commitKey=1}),k.addEventListener("updatefromsandbox",yt=>{this.showElementAndHideCanvas(yt.target);const xt={value(It){et.userValue=It.detail.value??"",p.setValue(a,{value:et.userValue.toString()}),It.target.value=et.userValue},formattedValue(It){const{formattedValue:zt}=It.detail;et.formattedValue=zt,zt!=null&&It.target!==document.activeElement&&(It.target.value=zt),p.setValue(a,{formattedValue:zt})},selRange(It){It.target.setSelectionRange(...It.detail.selRange)},charLimit:It=>{var Xt;const{charLimit:zt}=It.detail,{target:$t}=It;if(zt===0){$t.removeAttribute("maxLength");return}$t.setAttribute("maxLength",zt);let Kt=et.userValue;!Kt||Kt.length<=zt||(Kt=Kt.slice(0,zt),$t.value=et.userValue=Kt,p.setValue(a,{value:Kt}),(Xt=this.linkService.eventBus)==null||Xt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:a,name:"Keystroke",value:Kt,willCommit:!0,commitKey:1,selStart:$t.selectionStart,selEnd:$t.selectionEnd}}))}};this._dispatchEventFromSandbox(xt,yt)}),k.addEventListener("keydown",yt=>{var zt;et.commitKey=1;let xt=-1;if(yt.key==="Escape"?xt=0:yt.key==="Enter"&&!this.data.multiLine?xt=2:yt.key==="Tab"&&(et.commitKey=3),xt===-1)return;const{value:It}=yt.target;et.lastCommittedValue!==It&&(et.lastCommittedValue=It,et.userValue=It,(zt=this.linkService.eventBus)==null||zt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:a,name:"Keystroke",value:It,willCommit:!0,commitKey:xt,selStart:yt.target.selectionStart,selEnd:yt.target.selectionEnd}}))});const bt=vt;vt=null,k.addEventListener("blur",yt=>{var It;if(!yt.relatedTarget)return;const{value:xt}=yt.target;et.userValue=xt,et.lastCommittedValue!==xt&&((It=this.linkService.eventBus)==null||It.dispatch("dispatcheventinsandbox",{source:this,detail:{id:a,name:"Keystroke",value:xt,willCommit:!0,commitKey:et.commitKey,selStart:yt.target.selectionStart,selEnd:yt.target.selectionEnd}})),bt(yt)}),(U=this.data.actions)!=null&&U.Keystroke&&k.addEventListener("beforeinput",yt=>{var te;et.lastCommittedValue=null;const{data:xt,target:It}=yt,{value:zt,selectionStart:$t,selectionEnd:Kt}=It;let Xt=$t,Qt=Kt;switch(yt.inputType){case"deleteWordBackward":{const Zt=zt.substring(0,$t).match(/\w*[^\w]*$/);Zt&&(Xt-=Zt[0].length);break}case"deleteWordForward":{const Zt=zt.substring($t).match(/^[^\w]*\w*/);Zt&&(Qt+=Zt[0].length);break}case"deleteContentBackward":$t===Kt&&(Xt-=1);break;case"deleteContentForward":$t===Kt&&(Qt+=1);break}yt.preventDefault(),(te=this.linkService.eventBus)==null||te.dispatch("dispatcheventinsandbox",{source:this,detail:{id:a,name:"Keystroke",value:zt,change:xt||"",willCommit:!1,selStart:Xt,selEnd:Qt}})}),this._setEventListeners(k,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],yt=>yt.target.value)}if(vt&&k.addEventListener("blur",vt),this.data.comb){const yt=(this.data.rect[2]-this.data.rect[0])/b;k.classList.add("comb"),k.style.letterSpacing=`calc(${yt}px * var(--scale-factor) - 1ch)`}}else k=document.createElement("div"),k.textContent=this.data.fieldValue,k.style.verticalAlign="middle",k.style.display="table-cell";return this._setTextStyle(k),this._setBackgroundColor(k),this._setDefaultPropertiesFromJS(k),this.container.append(k),this.container}}class x extends _{constructor(p){super(p,{isRenderable:!!p.data.hasOwnCanvas})}}class A extends _{constructor(p){super(p,{isRenderable:p.renderForms})}render(){const p=this.annotationStorage,a=this.data,k=a.id;let T=p.getValue(k,{value:a.exportValue===a.fieldValue}).value;typeof T=="string"&&(T=T!=="Off",p.setValue(k,{value:T})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const U=document.createElement("input");return O.add(U),U.setAttribute("data-element-id",k),U.disabled=a.readOnly,this._setRequired(U,this.data.required),U.type="checkbox",U.name=a.fieldName,T&&U.setAttribute("checked",!0),U.setAttribute("exportValue",a.exportValue),U.tabIndex=D,U.addEventListener("change",Z=>{const{name:At,checked:b}=Z.target;for(const $ of this._getElementsByName(At,k)){const et=b&&$.exportValue===a.exportValue;$.domElement&&($.domElement.checked=et),p.setValue($.id,{value:et})}p.setValue(k,{value:b})}),U.addEventListener("resetform",Z=>{const At=a.defaultFieldValue||"Off";Z.target.checked=At===a.exportValue}),this.enableScripting&&this.hasJSActions&&(U.addEventListener("updatefromsandbox",Z=>{const At={value(b){b.target.checked=b.detail.value!=="Off",p.setValue(k,{value:b.target.checked})}};this._dispatchEventFromSandbox(At,Z)}),this._setEventListeners(U,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Z=>Z.target.checked)),this._setBackgroundColor(U),this._setDefaultPropertiesFromJS(U),this.container.append(U),this.container}}class n extends _{constructor(p){super(p,{isRenderable:p.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const p=this.annotationStorage,a=this.data,k=a.id;let T=p.getValue(k,{value:a.fieldValue===a.buttonValue}).value;typeof T=="string"&&(T=T!==a.buttonValue,p.setValue(k,{value:T}));const U=document.createElement("input");if(O.add(U),U.setAttribute("data-element-id",k),U.disabled=a.readOnly,this._setRequired(U,this.data.required),U.type="radio",U.name=a.fieldName,T&&U.setAttribute("checked",!0),U.tabIndex=D,U.addEventListener("change",Z=>{const{name:At,checked:b}=Z.target;for(const $ of this._getElementsByName(At,k))p.setValue($.id,{value:!1});p.setValue(k,{value:b})}),U.addEventListener("resetform",Z=>{const At=a.defaultFieldValue;Z.target.checked=At!=null&&At===a.buttonValue}),this.enableScripting&&this.hasJSActions){const Z=a.buttonValue;U.addEventListener("updatefromsandbox",At=>{const b={value:$=>{const et=Z===$.detail.value;for(const vt of this._getElementsByName($.target.name)){const bt=et&&vt.id===k;vt.domElement&&(vt.domElement.checked=bt),p.setValue(vt.id,{value:bt})}}};this._dispatchEventFromSandbox(b,At)}),this._setEventListeners(U,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],At=>At.target.checked)}return this._setBackgroundColor(U),this._setDefaultPropertiesFromJS(U),this.container.append(U),this.container}}class r extends v{constructor(p){super(p,{ignoreBorder:p.data.hasAppearance})}render(){const p=super.render();p.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(p.title=this.data.alternativeText);const a=p.lastChild;return this.enableScripting&&this.hasJSActions&&a&&(this._setDefaultPropertiesFromJS(a),a.addEventListener("updatefromsandbox",k=>{this._dispatchEventFromSandbox({},k)})),p}}class F extends _{constructor(p){super(p,{isRenderable:p.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const p=this.annotationStorage,a=this.data.id,k=p.getValue(a,{value:this.data.fieldValue}),T=document.createElement("select");O.add(T),T.setAttribute("data-element-id",a),T.disabled=this.data.readOnly,this._setRequired(T,this.data.required),T.name=this.data.fieldName,T.tabIndex=D;let U=this.data.combo&&this.data.options.length>0;this.data.combo||(T.size=this.data.options.length,this.data.multiSelect&&(T.multiple=!0)),T.addEventListener("resetform",et=>{const vt=this.data.defaultFieldValue;for(const bt of T.options)bt.selected=bt.value===vt});for(const et of this.data.options){const vt=document.createElement("option");vt.textContent=et.displayValue,vt.value=et.exportValue,k.value.includes(et.exportValue)&&(vt.setAttribute("selected",!0),U=!1),T.append(vt)}let Z=null;if(U){const et=document.createElement("option");et.value=" ",et.setAttribute("hidden",!0),et.setAttribute("selected",!0),T.prepend(et),Z=()=>{et.remove(),T.removeEventListener("input",Z),Z=null},T.addEventListener("input",Z)}const At=et=>{const vt=et?"value":"textContent",{options:bt,multiple:yt}=T;return yt?Array.prototype.filter.call(bt,xt=>xt.selected).map(xt=>xt[vt]):bt.selectedIndex===-1?null:bt[bt.selectedIndex][vt]};let b=At(!1);const $=et=>{const vt=et.target.options;return Array.prototype.map.call(vt,bt=>({displayValue:bt.textContent,exportValue:bt.value}))};return this.enableScripting&&this.hasJSActions?(T.addEventListener("updatefromsandbox",et=>{const vt={value(bt){Z==null||Z();const yt=bt.detail.value,xt=new Set(Array.isArray(yt)?yt:[yt]);for(const It of T.options)It.selected=xt.has(It.value);p.setValue(a,{value:At(!0)}),b=At(!1)},multipleSelection(bt){T.multiple=!0},remove(bt){const yt=T.options,xt=bt.detail.remove;yt[xt].selected=!1,T.remove(xt),yt.length>0&&Array.prototype.findIndex.call(yt,zt=>zt.selected)===-1&&(yt[0].selected=!0),p.setValue(a,{value:At(!0),items:$(bt)}),b=At(!1)},clear(bt){for(;T.length!==0;)T.remove(0);p.setValue(a,{value:null,items:[]}),b=At(!1)},insert(bt){const{index:yt,displayValue:xt,exportValue:It}=bt.detail.insert,zt=T.children[yt],$t=document.createElement("option");$t.textContent=xt,$t.value=It,zt?zt.before($t):T.append($t),p.setValue(a,{value:At(!0),items:$(bt)}),b=At(!1)},items(bt){const{items:yt}=bt.detail;for(;T.length!==0;)T.remove(0);for(const xt of yt){const{displayValue:It,exportValue:zt}=xt,$t=document.createElement("option");$t.textContent=It,$t.value=zt,T.append($t)}T.options.length>0&&(T.options[0].selected=!0),p.setValue(a,{value:At(!0),items:$(bt)}),b=At(!1)},indices(bt){const yt=new Set(bt.detail.indices);for(const xt of bt.target.options)xt.selected=yt.has(xt.index);p.setValue(a,{value:At(!0)}),b=At(!1)},editable(bt){bt.target.disabled=!bt.detail.editable}};this._dispatchEventFromSandbox(vt,et)}),T.addEventListener("input",et=>{var bt;const vt=At(!0);p.setValue(a,{value:vt}),et.preventDefault(),(bt=this.linkService.eventBus)==null||bt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:a,name:"Keystroke",value:b,changeEx:vt,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(T,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],et=>et.target.value)):T.addEventListener("input",function(et){p.setValue(a,{value:At(!0)})}),this.data.combo&&this._setTextStyle(T),this._setBackgroundColor(T),this._setDefaultPropertiesFromJS(T),this.container.append(T),this.container}}class f extends S{constructor(p){var U,Z,At;const{data:a,elements:k}=p,T=!!((U=a.titleObj)!=null&&U.str||(Z=a.contentsObj)!=null&&Z.str||(At=a.richText)!=null&&At.str);super(p,{isRenderable:T}),this.elements=k}render(){this.container.classList.add("popupAnnotation");const p=new i({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),a=[];for(const k of this.elements)k.popup=p,a.push(k.data.id),k.addHighlightArea();return this.container.setAttribute("aria-controls",a.join(",")),this.container}}class i{constructor({container:p,color:a,elements:k,titleObj:T,modificationDate:U,contentsObj:Z,richText:At,parent:b,rect:$,parentRect:et,open:vt}){I(this,Ft);I(this,Ht);I(this,Rt);I(this,H,null);I(this,K,X(this,Rt,Je).bind(this));I(this,ft,X(this,Ht,Ke).bind(this));I(this,lt,X(this,Ft,Ye).bind(this));I(this,dt,null);I(this,pt,null);I(this,kt,null);I(this,wt,null);I(this,Lt,null);I(this,Ut,null);I(this,Pt,!1);I(this,Bt,null);I(this,Ct,null);I(this,st,null);I(this,tt,null);I(this,gt,!1);it(this,pt,p),it(this,tt,T),it(this,kt,Z),it(this,st,At),it(this,Lt,b),it(this,dt,a),it(this,Ct,$),it(this,Ut,et),it(this,wt,k);const bt=R.PDFDateString.toDateObject(U);bt&&it(this,H,b.l10n.get("annotation_date_string",{date:bt.toLocaleDateString(),time:bt.toLocaleTimeString()})),this.trigger=k.flatMap(yt=>yt.getElementsToTriggerPopup());for(const yt of this.trigger)yt.addEventListener("click",t(this,lt)),yt.addEventListener("mouseenter",t(this,ft)),yt.addEventListener("mouseleave",t(this,K));t(this,pt).hidden=!0,vt&&X(this,Ft,Ye).call(this)}render(){if(t(this,Bt))return;const{page:{view:p},viewport:{rawDims:{pageWidth:a,pageHeight:k,pageX:T,pageY:U}}}=t(this,Lt),Z=it(this,Bt,document.createElement("div"));if(Z.className="popup",t(this,dt)){const Xt=Z.style.outlineColor=l.Util.makeHexColor(...t(this,dt));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?Z.style.backgroundColor=`color-mix(in srgb, ${Xt} 30%, white)`:Z.style.backgroundColor=l.Util.makeHexColor(...t(this,dt).map(te=>Math.floor(.7*(255-te)+te)))}const At=document.createElement("span");At.className="header";const b=document.createElement("h1");if(At.append(b),{dir:b.dir,str:b.textContent}=t(this,tt),Z.append(At),t(this,H)){const Xt=document.createElement("span");Xt.classList.add("popupDate"),t(this,H).then(Qt=>{Xt.textContent=Qt}),At.append(Xt)}const $=t(this,kt),et=t(this,st);if(et!=null&&et.str&&(!($!=null&&$.str)||$.str===et.str))j.XfaLayer.render({xfaHtml:et.html,intent:"richText",div:Z}),Z.lastChild.classList.add("richText","popupContent");else{const Xt=this._formatContents($);Z.append(Xt)}let vt=!!t(this,Ut),bt=vt?t(this,Ut):t(this,Ct);for(const Xt of t(this,wt))if(!bt||l.Util.intersect(Xt.data.rect,bt)!==null){bt=Xt.data.rect,vt=!0;break}const yt=l.Util.normalizeRect([bt[0],p[3]-bt[1]+p[1],bt[2],p[3]-bt[3]+p[1]]),xt=5,It=vt?bt[2]-bt[0]+xt:0,zt=yt[0]+It,$t=yt[1],{style:Kt}=t(this,pt);Kt.left=`${100*(zt-T)/a}%`,Kt.top=`${100*($t-U)/k}%`,t(this,pt).append(Z)}_formatContents({str:p,dir:a}){const k=document.createElement("p");k.classList.add("popupContent"),k.dir=a;const T=p.split(/(?:\r\n?|\n)/);for(let U=0,Z=T.length;U<Z;++U){const At=T[U];k.append(document.createTextNode(At)),U<Z-1&&k.append(document.createElement("br"))}return k}forceHide(){it(this,gt,this.isVisible),t(this,gt)&&(t(this,pt).hidden=!0)}maybeShow(){t(this,gt)&&(it(this,gt,!1),t(this,pt).hidden=!1)}get isVisible(){return t(this,pt).hidden===!1}}H=new WeakMap,K=new WeakMap,ft=new WeakMap,lt=new WeakMap,dt=new WeakMap,pt=new WeakMap,kt=new WeakMap,wt=new WeakMap,Lt=new WeakMap,Ut=new WeakMap,Pt=new WeakMap,Bt=new WeakMap,Ct=new WeakMap,st=new WeakMap,tt=new WeakMap,gt=new WeakMap,Ft=new WeakSet,Ye=function(){it(this,Pt,!t(this,Pt)),t(this,Pt)?(X(this,Ht,Ke).call(this),t(this,pt).addEventListener("click",t(this,lt))):(X(this,Rt,Je).call(this),t(this,pt).removeEventListener("click",t(this,lt)))},Ht=new WeakSet,Ke=function(){t(this,Bt)||this.render(),this.isVisible?t(this,Pt)&&t(this,pt).classList.add("focused"):(t(this,pt).hidden=!1,t(this,pt).style.zIndex=parseInt(t(this,pt).style.zIndex)+1e3)},Rt=new WeakSet,Je=function(){t(this,pt).classList.remove("focused"),!(t(this,Pt)||!this.isVisible)&&(t(this,pt).hidden=!0,t(this,pt).style.zIndex=parseInt(t(this,pt).style.zIndex)-1e3)};class P extends S{constructor(p){var k,T,U;const a=!!(p.data.popupRef||(k=p.data.titleObj)!=null&&k.str||(T=p.data.contentsObj)!=null&&T.str||(U=p.data.richText)!=null&&U.str);super(p,{isRenderable:a,ignoreBorder:!0}),this.textContent=p.data.textContent,this.textPosition=p.data.textPosition,this.annotationEditorType=l.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const p=document.createElement("div");p.classList.add("annotationTextContent"),p.setAttribute("role","comment");for(const a of this.textContent){const k=document.createElement("span");k.textContent=a,p.append(k)}this.container.append(p)}return this.data.popupRef||this._createPopup(),this._editOnDoubleClick(),this.container}}o.FreeTextAnnotationElement=P;class g extends S{constructor(a){var T,U,Z;const k=!!(a.data.popupRef||(T=a.data.titleObj)!=null&&T.str||(U=a.data.contentsObj)!=null&&U.str||(Z=a.data.richText)!=null&&Z.str);super(a,{isRenderable:k,ignoreBorder:!0});I(this,Gt,null)}render(){this.container.classList.add("lineAnnotation");const a=this.data,{width:k,height:T}=B(a.rect),U=this.svgFactory.create(k,T,!0),Z=it(this,Gt,this.svgFactory.createElement("svg:line"));return Z.setAttribute("x1",a.rect[2]-a.lineCoordinates[0]),Z.setAttribute("y1",a.rect[3]-a.lineCoordinates[1]),Z.setAttribute("x2",a.rect[2]-a.lineCoordinates[2]),Z.setAttribute("y2",a.rect[3]-a.lineCoordinates[3]),Z.setAttribute("stroke-width",a.borderStyle.width||1),Z.setAttribute("stroke","transparent"),Z.setAttribute("fill","transparent"),U.append(Z),this.container.append(U),a.popupRef||this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,Gt)}addHighlightArea(){this.container.classList.add("highlightArea")}}Gt=new WeakMap;class W extends S{constructor(a){var T,U,Z;const k=!!(a.data.popupRef||(T=a.data.titleObj)!=null&&T.str||(U=a.data.contentsObj)!=null&&U.str||(Z=a.data.richText)!=null&&Z.str);super(a,{isRenderable:k,ignoreBorder:!0});I(this,jt,null)}render(){this.container.classList.add("squareAnnotation");const a=this.data,{width:k,height:T}=B(a.rect),U=this.svgFactory.create(k,T,!0),Z=a.borderStyle.width,At=it(this,jt,this.svgFactory.createElement("svg:rect"));return At.setAttribute("x",Z/2),At.setAttribute("y",Z/2),At.setAttribute("width",k-Z),At.setAttribute("height",T-Z),At.setAttribute("stroke-width",Z||1),At.setAttribute("stroke","transparent"),At.setAttribute("fill","transparent"),U.append(At),this.container.append(U),a.popupRef||this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,jt)}addHighlightArea(){this.container.classList.add("highlightArea")}}jt=new WeakMap;class V extends S{constructor(a){var T,U,Z;const k=!!(a.data.popupRef||(T=a.data.titleObj)!=null&&T.str||(U=a.data.contentsObj)!=null&&U.str||(Z=a.data.richText)!=null&&Z.str);super(a,{isRenderable:k,ignoreBorder:!0});I(this,mt,null)}render(){this.container.classList.add("circleAnnotation");const a=this.data,{width:k,height:T}=B(a.rect),U=this.svgFactory.create(k,T,!0),Z=a.borderStyle.width,At=it(this,mt,this.svgFactory.createElement("svg:ellipse"));return At.setAttribute("cx",k/2),At.setAttribute("cy",T/2),At.setAttribute("rx",k/2-Z/2),At.setAttribute("ry",T/2-Z/2),At.setAttribute("stroke-width",Z||1),At.setAttribute("stroke","transparent"),At.setAttribute("fill","transparent"),U.append(At),this.container.append(U),a.popupRef||this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,mt)}addHighlightArea(){this.container.classList.add("highlightArea")}}mt=new WeakMap;class E extends S{constructor(a){var T,U,Z;const k=!!(a.data.popupRef||(T=a.data.titleObj)!=null&&T.str||(U=a.data.contentsObj)!=null&&U.str||(Z=a.data.richText)!=null&&Z.str);super(a,{isRenderable:k,ignoreBorder:!0});I(this,G,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const a=this.data,{width:k,height:T}=B(a.rect),U=this.svgFactory.create(k,T,!0);let Z=[];for(const b of a.vertices){const $=b.x-a.rect[0],et=a.rect[3]-b.y;Z.push($+","+et)}Z=Z.join(" ");const At=it(this,G,this.svgFactory.createElement(this.svgElementName));return At.setAttribute("points",Z),At.setAttribute("stroke-width",a.borderStyle.width||1),At.setAttribute("stroke","transparent"),At.setAttribute("fill","transparent"),U.append(At),this.container.append(U),a.popupRef||this._createPopup(At,a),this.container}getElementsToTriggerPopup(){return t(this,G)}addHighlightArea(){this.container.classList.add("highlightArea")}}G=new WeakMap;class z extends E{constructor(p){super(p),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class nt extends S{constructor(p){var k,T,U;const a=!!(p.data.popupRef||(k=p.data.titleObj)!=null&&k.str||(T=p.data.contentsObj)!=null&&T.str||(U=p.data.richText)!=null&&U.str);super(p,{isRenderable:a,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),this.data.popupRef||this._createPopup(),this.container}}class ct extends S{constructor(a){var T,U,Z;const k=!!(a.data.popupRef||(T=a.data.titleObj)!=null&&T.str||(U=a.data.contentsObj)!=null&&U.str||(Z=a.data.richText)!=null&&Z.str);super(a,{isRenderable:k,ignoreBorder:!0});I(this,J,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=l.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const a=this.data,{width:k,height:T}=B(a.rect),U=this.svgFactory.create(k,T,!0);for(const Z of a.inkLists){let At=[];for(const $ of Z){const et=$.x-a.rect[0],vt=a.rect[3]-$.y;At.push(`${et},${vt}`)}At=At.join(" ");const b=this.svgFactory.createElement(this.svgElementName);t(this,J).push(b),b.setAttribute("points",At),b.setAttribute("stroke-width",a.borderStyle.width||1),b.setAttribute("stroke","transparent"),b.setAttribute("fill","transparent"),a.popupRef||this._createPopup(b,a),U.append(b)}return this.container.append(U),this.container}getElementsToTriggerPopup(){return t(this,J)}addHighlightArea(){this.container.classList.add("highlightArea")}}J=new WeakMap,o.InkAnnotationElement=ct;class u extends S{constructor(p){var k,T,U;const a=!!(p.data.popupRef||(k=p.data.titleObj)!=null&&k.str||(T=p.data.contentsObj)!=null&&T.str||(U=p.data.richText)!=null&&U.str);super(p,{isRenderable:a,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.popupRef||this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class L extends S{constructor(p){var k,T,U;const a=!!(p.data.popupRef||(k=p.data.titleObj)!=null&&k.str||(T=p.data.contentsObj)!=null&&T.str||(U=p.data.richText)!=null&&U.str);super(p,{isRenderable:a,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.popupRef||this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class Y extends S{constructor(p){var k,T,U;const a=!!(p.data.popupRef||(k=p.data.titleObj)!=null&&k.str||(T=p.data.contentsObj)!=null&&T.str||(U=p.data.richText)!=null&&U.str);super(p,{isRenderable:a,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.popupRef||this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class rt extends S{constructor(p){var k,T,U;const a=!!(p.data.popupRef||(k=p.data.titleObj)!=null&&k.str||(T=p.data.contentsObj)!=null&&T.str||(U=p.data.richText)!=null&&U.str);super(p,{isRenderable:a,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.popupRef||this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class _t extends S{constructor(p){var k,T,U;const a=!!(p.data.popupRef||(k=p.data.titleObj)!=null&&k.str||(T=p.data.contentsObj)!=null&&T.str||(U=p.data.richText)!=null&&U.str);super(p,{isRenderable:a,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),this.data.popupRef||this._createPopup(),this.container}}o.StampAnnotationElement=_t;class d extends S{constructor(a){var U;super(a,{isRenderable:!0});I(this,Tt,null);const{filename:k,content:T}=this.data.file;this.filename=(0,R.getFilenameFromUrl)(k,!0),this.content=T,(U=this.linkService.eventBus)==null||U.dispatch("fileattachmentannotation",{source:this,filename:k,content:T})}render(){var T,U;this.container.classList.add("fileAttachmentAnnotation");const{data:a}=this;let k;return a.hasAppearance||a.fillAlpha===0?k=document.createElement("div"):(k=document.createElement("img"),k.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(a.name)?"paperclip":"pushpin"}.svg`,a.fillAlpha&&a.fillAlpha<1&&(k.style=`filter: opacity(${Math.round(a.fillAlpha*100)}%);`)),k.classList.add("popupTriggerArea"),k.addEventListener("dblclick",this._download.bind(this)),it(this,Tt,k),!a.popupRef&&((T=a.titleObj)!=null&&T.str||(U=a.contentsObj)!=null&&U.str||a.richText)&&this._createPopup(),this.container.append(k),this.container}getElementsToTriggerPopup(){return t(this,Tt)}addHighlightArea(){this.container.classList.add("highlightArea")}_download(){var a;(a=this.downloadManager)==null||a.openOrDownloadData(this.container,this.content,this.filename)}}Tt=new WeakMap;class e{constructor({div:p,accessibilityManager:a,annotationCanvasMap:k,l10n:T,page:U,viewport:Z}){I(this,Jt);I(this,St);I(this,Vt,null);I(this,Nt,null);I(this,qt,new Map);this.div=p,it(this,Vt,a),it(this,Nt,k),this.l10n=T,this.page=U,this.viewport=Z,this.zIndex=0,this.l10n||(this.l10n=ut.NullL10n)}async render(p){const{annotations:a}=p,k=this.div;(0,R.setLayerDimensions)(k,this.viewport);const T=new Map,U={data:null,layer:k,linkService:p.linkService,downloadManager:p.downloadManager,imageResourcesPath:p.imageResourcesPath||"",renderForms:p.renderForms!==!1,svgFactory:new R.DOMSVGFactory,annotationStorage:p.annotationStorage||new ht.AnnotationStorage,enableScripting:p.enableScripting===!0,hasJSActions:p.hasJSActions,fieldObjects:p.fieldObjects,parent:this,elements:null};for(const Z of a){if(Z.noHTML)continue;const At=Z.annotationType===l.AnnotationType.POPUP;if(At){const et=T.get(Z.id);if(!et)continue;U.elements=et}else{const{width:et,height:vt}=B(Z.rect);if(et<=0||vt<=0)continue}U.data=Z;const b=M.create(U);if(!b.isRenderable)continue;if(!At&&Z.popupRef){const et=T.get(Z.popupRef);et?et.push(b):T.set(Z.popupRef,[b])}b.annotationEditorType>0&&t(this,qt).set(b.data.id,b);const $=b.render();Z.hidden&&($.style.visibility="hidden"),X(this,Jt,Vs).call(this,$,Z.id)}X(this,St,Qe).call(this),await this.l10n.translate(k)}update({viewport:p}){const a=this.div;this.viewport=p,(0,R.setLayerDimensions)(a,{rotation:p.rotation}),X(this,St,Qe).call(this),a.hidden=!1}getEditableAnnotations(){return Array.from(t(this,qt).values())}getEditableAnnotation(p){return t(this,qt).get(p)}}Vt=new WeakMap,Nt=new WeakMap,qt=new WeakMap,Jt=new WeakSet,Vs=function(p,a){var T;const k=p.firstChild||p;k.id=`${R.AnnotationPrefix}${a}`,this.div.append(p),(T=t(this,Vt))==null||T.moveElementInDOM(this.div,p,k,!1)},St=new WeakSet,Qe=function(){if(!t(this,Nt))return;const p=this.div;for(const[a,k]of t(this,Nt)){const T=p.querySelector(`[data-annotation-id="${a}"]`);if(!T)continue;const{firstChild:U}=T;U?U.nodeName==="CANVAS"?U.replaceWith(k):U.before(k):T.append(k)}t(this,Nt).clear()},o.AnnotationLayer=e},(ot,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.ColorConverters=void 0;function at(ht){return Math.floor(Math.max(0,Math.min(1,ht))*255).toString(16).padStart(2,"0")}function l(ht){return Math.max(0,Math.min(255,255*ht))}class R{static CMYK_G([q,ut,j,D]){return["G",1-Math.min(1,.3*q+.59*j+.11*ut+D)]}static G_CMYK([q]){return["CMYK",0,0,0,1-q]}static G_RGB([q]){return["RGB",q,q,q]}static G_rgb([q]){return q=l(q),[q,q,q]}static G_HTML([q]){const ut=at(q);return`#${ut}${ut}${ut}`}static RGB_G([q,ut,j]){return["G",.3*q+.59*ut+.11*j]}static RGB_rgb(q){return q.map(l)}static RGB_HTML(q){return`#${q.map(at).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([q,ut,j,D]){return["RGB",1-Math.min(1,q+D),1-Math.min(1,j+D),1-Math.min(1,ut+D)]}static CMYK_rgb([q,ut,j,D]){return[l(1-Math.min(1,q+D)),l(1-Math.min(1,j+D)),l(1-Math.min(1,ut+D))]}static CMYK_HTML(q){const ut=this.CMYK_RGB(q).slice(1);return this.RGB_HTML(ut)}static RGB_CMYK([q,ut,j]){const D=1-q,m=1-ut,O=1-j,B=Math.min(D,m,O);return["CMYK",D,m,O,B]}}o.ColorConverters=R},(ot,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.NullL10n=void 0,o.getL10nFallback=l;const at={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing…",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image"};at.print_progress_percent="{{progress}}%";function l(q,ut){switch(q){case"find_match_count":q=`find_match_count[${ut.total===1?"one":"other"}]`;break;case"find_match_count_limit":q=`find_match_count_limit[${ut.limit===1?"one":"other"}]`;break}return at[q]||""}function R(q,ut){return ut?q.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(j,D)=>D in ut?ut[D]:"{{"+D+"}}"):q}const ht={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(q,ut=null,j=l(q,ut)){return R(j,ut)},async translate(q){}};o.NullL10n=ht},(ot,o,at)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.XfaLayer=void 0;var l=at(25);class R{static setupStorage(q,ut,j,D,m){const O=D.getValue(ut,{value:null});switch(j.name){case"textarea":if(O.value!==null&&(q.textContent=O.value),m==="print")break;q.addEventListener("input",B=>{D.setValue(ut,{value:B.target.value})});break;case"input":if(j.attributes.type==="radio"||j.attributes.type==="checkbox"){if(O.value===j.attributes.xfaOn?q.setAttribute("checked",!0):O.value===j.attributes.xfaOff&&q.removeAttribute("checked"),m==="print")break;q.addEventListener("change",B=>{D.setValue(ut,{value:B.target.checked?B.target.getAttribute("xfaOn"):B.target.getAttribute("xfaOff")})})}else{if(O.value!==null&&q.setAttribute("value",O.value),m==="print")break;q.addEventListener("input",B=>{D.setValue(ut,{value:B.target.value})})}break;case"select":if(O.value!==null){q.setAttribute("value",O.value);for(const B of j.children)B.attributes.value===O.value?B.attributes.selected=!0:B.attributes.hasOwnProperty("selected")&&delete B.attributes.selected}q.addEventListener("input",B=>{const M=B.target.options,S=M.selectedIndex===-1?"":M[M.selectedIndex].value;D.setValue(ut,{value:S})});break}}static setAttributes({html:q,element:ut,storage:j=null,intent:D,linkService:m}){const{attributes:O}=ut,B=q instanceof HTMLAnchorElement;O.type==="radio"&&(O.name=`${O.name}-${D}`);for(const[M,S]of Object.entries(O))if(S!=null)switch(M){case"class":S.length&&q.setAttribute(M,S.join(" "));break;case"dataId":break;case"id":q.setAttribute("data-element-id",S);break;case"style":Object.assign(q.style,S);break;case"textContent":q.textContent=S;break;default:(!B||M!=="href"&&M!=="newWindow")&&q.setAttribute(M,S)}B&&m.addLinkAttributes(q,O.href,O.newWindow),j&&O.dataId&&this.setupStorage(q,O.dataId,ut,j)}static render(q){var v;const ut=q.annotationStorage,j=q.linkService,D=q.xfaHtml,m=q.intent||"display",O=document.createElement(D.name);D.attributes&&this.setAttributes({html:O,element:D,intent:m,linkService:j});const B=[[D,-1,O]],M=q.div;if(M.append(O),q.viewport){const h=`matrix(${q.viewport.transform.join(",")})`;M.style.transform=h}m!=="richText"&&M.setAttribute("class","xfaLayer xfaFont");const S=[];for(;B.length>0;){const[h,_,w]=B.at(-1);if(_+1===h.children.length){B.pop();continue}const x=h.children[++B.at(-1)[1]];if(x===null)continue;const{name:A}=x;if(A==="#text"){const r=document.createTextNode(x.value);S.push(r),w.append(r);continue}const n=(v=x==null?void 0:x.attributes)!=null&&v.xmlns?document.createElementNS(x.attributes.xmlns,A):document.createElement(A);if(w.append(n),x.attributes&&this.setAttributes({html:n,element:x,storage:ut,intent:m,linkService:j}),x.children&&x.children.length>0)B.push([x,-1,n]);else if(x.value){const r=document.createTextNode(x.value);l.XfaText.shouldBuildText(A)&&S.push(r),n.append(r)}}for(const h of M.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))h.setAttribute("readOnly",!0);return{textDivs:S}}static update(q){const ut=`matrix(${q.viewport.transform.join(",")})`;q.div.style.transform=ut,q.div.hidden=!1}}o.XfaLayer=R},(ot,o,at)=>{var j,D,m,O,B,M,S,v,h,_,w,x,A,n,r,F,zs,i,$s,g,Xs,V,qs,z,Ze,ct,Ys,L,ts,rt,Ks,d,Js,s,Qs,C,Zs,N,ti,K,se,lt,es,pt,we,wt,Ce,Ut,le,Bt,ss,st,Te,gt,ei,Mt,is,Wt,si,Dt,ii,jt,ns,G,Pe,Tt,ce;Object.defineProperty(o,"__esModule",{value:!0}),o.InkEditor=void 0;var l=at(1),R=at(4),ht=at(29),q=at(5);const Nt=class Nt extends R.AnnotationEditor{constructor(Q){super({...Q,name:"inkEditor"});I(this,F);I(this,i);I(this,g);I(this,V);I(this,z);I(this,ct);I(this,L);I(this,rt);I(this,d);I(this,s);I(this,C);I(this,N);I(this,K);I(this,lt);I(this,pt);I(this,wt);I(this,Ut);I(this,Bt);I(this,st);I(this,Dt);I(this,jt);I(this,G);I(this,Tt);I(this,j,0);I(this,D,0);I(this,m,this.canvasContextMenu.bind(this));I(this,O,this.canvasPointermove.bind(this));I(this,B,this.canvasPointerleave.bind(this));I(this,M,this.canvasPointerup.bind(this));I(this,S,this.canvasPointerdown.bind(this));I(this,v,new Path2D);I(this,h,!1);I(this,_,!1);I(this,w,!1);I(this,x,null);I(this,A,0);I(this,n,0);I(this,r,null);this.color=Q.color||null,this.thickness=Q.thickness||null,this.opacity=Q.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(Q){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink2_aria_label"].map(St=>[St,Q.get(St)]))}static updateDefaultParams(Q,St){switch(Q){case l.AnnotationEditorParamsType.INK_THICKNESS:Nt._defaultThickness=St;break;case l.AnnotationEditorParamsType.INK_COLOR:Nt._defaultColor=St;break;case l.AnnotationEditorParamsType.INK_OPACITY:Nt._defaultOpacity=St/100;break}}updateParams(Q,St){switch(Q){case l.AnnotationEditorParamsType.INK_THICKNESS:X(this,F,zs).call(this,St);break;case l.AnnotationEditorParamsType.INK_COLOR:X(this,i,$s).call(this,St);break;case l.AnnotationEditorParamsType.INK_OPACITY:X(this,g,Xs).call(this,St);break}}static get defaultPropertiesToUpdate(){return[[l.AnnotationEditorParamsType.INK_THICKNESS,Nt._defaultThickness],[l.AnnotationEditorParamsType.INK_COLOR,Nt._defaultColor||R.AnnotationEditor._defaultLineColor],[l.AnnotationEditorParamsType.INK_OPACITY,Math.round(Nt._defaultOpacity*100)]]}get propertiesToUpdate(){return[[l.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||Nt._defaultThickness],[l.AnnotationEditorParamsType.INK_COLOR,this.color||Nt._defaultColor||R.AnnotationEditor._defaultLineColor],[l.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??Nt._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(X(this,pt,we).call(this),X(this,wt,Ce).call(this)),this.isAttachedToDOM||(this.parent.add(this),X(this,Ut,le).call(this)),X(this,Tt,ce).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,t(this,x).disconnect(),it(this,x,null),super.remove())}setParent(Q){!this.parent&&Q?this._uiManager.removeShouldRescale(this):this.parent&&Q===null&&this._uiManager.addShouldRescale(this),super.setParent(Q)}onScaleChanging(){const[Q,St]=this.parentDimensions,Ot=this.width*Q,Et=this.height*St;this.setDimensions(Ot,Et)}enableEditMode(){t(this,h)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",t(this,S)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",t(this,S)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){t(this,h)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),it(this,h,!0),this.div.classList.add("disabled"),X(this,Tt,ce).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(Q){this._focusEventsAllowed&&(super.focusin(Q),this.enableEditMode())}canvasPointerdown(Q){Q.button!==0||!this.isInEditMode()||t(this,h)||(this.setInForeground(),Q.preventDefault(),Q.type!=="mouse"&&this.div.focus(),X(this,ct,Ys).call(this,Q.offsetX,Q.offsetY))}canvasContextMenu(Q){Q.preventDefault()}canvasPointermove(Q){Q.preventDefault(),X(this,L,ts).call(this,Q.offsetX,Q.offsetY)}canvasPointerup(Q){Q.preventDefault(),X(this,lt,es).call(this,Q)}canvasPointerleave(Q){X(this,lt,es).call(this,Q)}get isResizable(){return!this.isEmpty()&&t(this,h)}render(){if(this.div)return this.div;let Q,St;this.width&&(Q=this.x,St=this.y),super.render(),Nt._l10nPromise.get("editor_ink2_aria_label").then(k=>{var T;return(T=this.div)==null?void 0:T.setAttribute("aria-label",k)});const[Ot,Et,p,a]=X(this,V,qs).call(this);if(this.setAt(Ot,Et,0,0),this.setDims(p,a),X(this,pt,we).call(this),this.width){const[k,T]=this.parentDimensions;this.setAspectRatio(this.width*k,this.height*T),this.setAt(Q*k,St*T,this.width*k,this.height*T),it(this,w,!0),X(this,Ut,le).call(this),this.setDims(this.width*k,this.height*T),X(this,K,se).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return X(this,wt,Ce).call(this),this.div}setDimensions(Q,St){const Ot=Math.round(Q),Et=Math.round(St);if(t(this,A)===Ot&&t(this,n)===Et)return;it(this,A,Ot),it(this,n,Et),this.canvas.style.visibility="hidden";const[p,a]=this.parentDimensions;this.width=Q/p,this.height=St/a,this.fixAndSetPosition(),t(this,h)&&X(this,Bt,ss).call(this,Q,St),X(this,Ut,le).call(this),X(this,K,se).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(Q,St,Ot){var vt,bt,yt;if(Q instanceof ht.InkAnnotationElement)return null;const Et=super.deserialize(Q,St,Ot);Et.thickness=Q.thickness,Et.color=l.Util.makeHexColor(...Q.color),Et.opacity=Q.opacity;const[p,a]=Et.pageDimensions,k=Et.width*p,T=Et.height*a,U=Et.parentScale,Z=Q.thickness/2;it(Et,h,!0),it(Et,A,Math.round(k)),it(Et,n,Math.round(T));const{paths:At,rect:b,rotation:$}=Q;for(let{bezier:xt}of At){xt=X(vt=Nt,Wt,si).call(vt,xt,b,$);const It=[];Et.paths.push(It);let zt=U*(xt[0]-Z),$t=U*(xt[1]-Z);for(let Xt=2,Qt=xt.length;Xt<Qt;Xt+=6){const te=U*(xt[Xt]-Z),Zt=U*(xt[Xt+1]-Z),ie=U*(xt[Xt+2]-Z),oi=U*(xt[Xt+3]-Z),os=U*(xt[Xt+4]-Z),ls=U*(xt[Xt+5]-Z);It.push([[zt,$t],[te,Zt],[ie,oi],[os,ls]]),zt=os,$t=ls}const Kt=X(this,gt,ei).call(this,It);Et.bezierPath2D.push(Kt)}const et=X(bt=Et,jt,ns).call(bt);return it(Et,D,Math.max(R.AnnotationEditor.MIN_SIZE,et[2]-et[0])),it(Et,j,Math.max(R.AnnotationEditor.MIN_SIZE,et[3]-et[1])),X(yt=Et,Bt,ss).call(yt,k,T),Et}serialize(){if(this.isEmpty())return null;const Q=this.getRect(0,0),St=R.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:l.AnnotationEditorType.INK,color:St,thickness:this.thickness,opacity:this.opacity,paths:X(this,Dt,ii).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,Q),pageIndex:this.pageIndex,rect:Q,rotation:this.rotation}}};j=new WeakMap,D=new WeakMap,m=new WeakMap,O=new WeakMap,B=new WeakMap,M=new WeakMap,S=new WeakMap,v=new WeakMap,h=new WeakMap,_=new WeakMap,w=new WeakMap,x=new WeakMap,A=new WeakMap,n=new WeakMap,r=new WeakMap,F=new WeakSet,zs=function(Q){const St=this.thickness;this.addCommands({cmd:()=>{this.thickness=Q,X(this,Tt,ce).call(this)},undo:()=>{this.thickness=St,X(this,Tt,ce).call(this)},mustExec:!0,type:l.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},i=new WeakSet,$s=function(Q){const St=this.color;this.addCommands({cmd:()=>{this.color=Q,X(this,K,se).call(this)},undo:()=>{this.color=St,X(this,K,se).call(this)},mustExec:!0,type:l.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},g=new WeakSet,Xs=function(Q){Q/=100;const St=this.opacity;this.addCommands({cmd:()=>{this.opacity=Q,X(this,K,se).call(this)},undo:()=>{this.opacity=St,X(this,K,se).call(this)},mustExec:!0,type:l.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},V=new WeakSet,qs=function(){const{parentRotation:Q,parentDimensions:[St,Ot]}=this;switch(Q){case 90:return[0,Ot,Ot,St];case 180:return[St,Ot,St,Ot];case 270:return[St,0,Ot,St];default:return[0,0,St,Ot]}},z=new WeakSet,Ze=function(){const{ctx:Q,color:St,opacity:Ot,thickness:Et,parentScale:p,scaleFactor:a}=this;Q.lineWidth=Et*p/a,Q.lineCap="round",Q.lineJoin="round",Q.miterLimit=10,Q.strokeStyle=`${St}${(0,q.opacityToHex)(Ot)}`},ct=new WeakSet,Ys=function(Q,St){this.canvas.addEventListener("contextmenu",t(this,m)),this.canvas.addEventListener("pointerleave",t(this,B)),this.canvas.addEventListener("pointermove",t(this,O)),this.canvas.addEventListener("pointerup",t(this,M)),this.canvas.removeEventListener("pointerdown",t(this,S)),this.isEditing=!0,t(this,w)||(it(this,w,!0),X(this,Ut,le).call(this),this.thickness||(this.thickness=Nt._defaultThickness),this.color||(this.color=Nt._defaultColor||R.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=Nt._defaultOpacity)),this.currentPath.push([Q,St]),it(this,_,!1),X(this,z,Ze).call(this),it(this,r,()=>{X(this,s,Qs).call(this),t(this,r)&&window.requestAnimationFrame(t(this,r))}),window.requestAnimationFrame(t(this,r))},L=new WeakSet,ts=function(Q,St){const[Ot,Et]=this.currentPath.at(-1);if(this.currentPath.length>1&&Q===Ot&&St===Et)return;const p=this.currentPath;let a=t(this,v);if(p.push([Q,St]),it(this,_,!0),p.length<=2){a.moveTo(...p[0]),a.lineTo(Q,St);return}p.length===3&&(it(this,v,a=new Path2D),a.moveTo(...p[0])),X(this,C,Zs).call(this,a,...p.at(-3),...p.at(-2),Q,St)},rt=new WeakSet,Ks=function(){if(this.currentPath.length===0)return;const Q=this.currentPath.at(-1);t(this,v).lineTo(...Q)},d=new WeakSet,Js=function(Q,St){it(this,r,null),Q=Math.min(Math.max(Q,0),this.canvas.width),St=Math.min(Math.max(St,0),this.canvas.height),X(this,L,ts).call(this,Q,St),X(this,rt,Ks).call(this);let Ot;if(this.currentPath.length!==1)Ot=X(this,N,ti).call(this);else{const T=[Q,St];Ot=[[T,T.slice(),T.slice(),T]]}const Et=t(this,v),p=this.currentPath;this.currentPath=[],it(this,v,new Path2D);const a=()=>{this.allRawPaths.push(p),this.paths.push(Ot),this.bezierPath2D.push(Et),this.rebuild()},k=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(X(this,pt,we).call(this),X(this,wt,Ce).call(this)),X(this,Tt,ce).call(this))};this.addCommands({cmd:a,undo:k,mustExec:!0})},s=new WeakSet,Qs=function(){if(!t(this,_))return;it(this,_,!1);const Q=Math.ceil(this.thickness*this.parentScale),St=this.currentPath.slice(-3),Ot=St.map(a=>a[0]),Et=St.map(a=>a[1]);Math.min(...Ot)-Q,Math.max(...Ot)+Q,Math.min(...Et)-Q,Math.max(...Et)+Q;const{ctx:p}=this;p.save(),p.clearRect(0,0,this.canvas.width,this.canvas.height);for(const a of this.bezierPath2D)p.stroke(a);p.stroke(t(this,v)),p.restore()},C=new WeakSet,Zs=function(Q,St,Ot,Et,p,a,k){const T=(St+Et)/2,U=(Ot+p)/2,Z=(Et+a)/2,At=(p+k)/2;Q.bezierCurveTo(T+2*(Et-T)/3,U+2*(p-U)/3,Z+2*(Et-Z)/3,At+2*(p-At)/3,Z,At)},N=new WeakSet,ti=function(){const Q=this.currentPath;if(Q.length<=2)return[[Q[0],Q[0],Q.at(-1),Q.at(-1)]];const St=[];let Ot,[Et,p]=Q[0];for(Ot=1;Ot<Q.length-2;Ot++){const[b,$]=Q[Ot],[et,vt]=Q[Ot+1],bt=(b+et)/2,yt=($+vt)/2,xt=[Et+2*(b-Et)/3,p+2*($-p)/3],It=[bt+2*(b-bt)/3,yt+2*($-yt)/3];St.push([[Et,p],xt,It,[bt,yt]]),[Et,p]=[bt,yt]}const[a,k]=Q[Ot],[T,U]=Q[Ot+1],Z=[Et+2*(a-Et)/3,p+2*(k-p)/3],At=[T+2*(a-T)/3,U+2*(k-U)/3];return St.push([[Et,p],Z,At,[T,U]]),St},K=new WeakSet,se=function(){if(this.isEmpty()){X(this,st,Te).call(this);return}X(this,z,Ze).call(this);const{canvas:Q,ctx:St}=this;St.setTransform(1,0,0,1,0,0),St.clearRect(0,0,Q.width,Q.height),X(this,st,Te).call(this);for(const Ot of this.bezierPath2D)St.stroke(Ot)},lt=new WeakSet,es=function(Q){this.canvas.removeEventListener("pointerleave",t(this,B)),this.canvas.removeEventListener("pointermove",t(this,O)),this.canvas.removeEventListener("pointerup",t(this,M)),this.canvas.addEventListener("pointerdown",t(this,S)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",t(this,m))},10),X(this,d,Js).call(this,Q.offsetX,Q.offsetY),this.addToAnnotationStorage(),this.setInBackground()},pt=new WeakSet,we=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",Nt._l10nPromise.get("editor_ink_canvas_aria_label").then(Q=>{var St;return(St=this.canvas)==null?void 0:St.setAttribute("aria-label",Q)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},wt=new WeakSet,Ce=function(){it(this,x,new ResizeObserver(Q=>{const St=Q[0].contentRect;St.width&&St.height&&this.setDimensions(St.width,St.height)})),t(this,x).observe(this.div)},Ut=new WeakSet,le=function(){if(!t(this,w))return;const[Q,St]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*Q),this.canvas.height=Math.ceil(this.height*St),X(this,st,Te).call(this)},Bt=new WeakSet,ss=function(Q,St){const Ot=X(this,G,Pe).call(this),Et=(Q-Ot)/t(this,D),p=(St-Ot)/t(this,j);this.scaleFactor=Math.min(Et,p)},st=new WeakSet,Te=function(){const Q=X(this,G,Pe).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+Q,this.translationY*this.scaleFactor+Q)},gt=new WeakSet,ei=function(Q){const St=new Path2D;for(let Ot=0,Et=Q.length;Ot<Et;Ot++){const[p,a,k,T]=Q[Ot];Ot===0&&St.moveTo(...p),St.bezierCurveTo(a[0],a[1],k[0],k[1],T[0],T[1])}return St},Mt=new WeakSet,is=function(Q,St,Ot){const[Et,p,a,k]=St;switch(Ot){case 0:for(let T=0,U=Q.length;T<U;T+=2)Q[T]+=Et,Q[T+1]=k-Q[T+1];break;case 90:for(let T=0,U=Q.length;T<U;T+=2){const Z=Q[T];Q[T]=Q[T+1]+Et,Q[T+1]=Z+p}break;case 180:for(let T=0,U=Q.length;T<U;T+=2)Q[T]=a-Q[T],Q[T+1]+=p;break;case 270:for(let T=0,U=Q.length;T<U;T+=2){const Z=Q[T];Q[T]=a-Q[T+1],Q[T+1]=k-Z}break;default:throw new Error("Invalid rotation")}return Q},Wt=new WeakSet,si=function(Q,St,Ot){const[Et,p,a,k]=St;switch(Ot){case 0:for(let T=0,U=Q.length;T<U;T+=2)Q[T]-=Et,Q[T+1]=k-Q[T+1];break;case 90:for(let T=0,U=Q.length;T<U;T+=2){const Z=Q[T];Q[T]=Q[T+1]-p,Q[T+1]=Z-Et}break;case 180:for(let T=0,U=Q.length;T<U;T+=2)Q[T]=a-Q[T],Q[T+1]-=p;break;case 270:for(let T=0,U=Q.length;T<U;T+=2){const Z=Q[T];Q[T]=k-Q[T+1],Q[T+1]=a-Z}break;default:throw new Error("Invalid rotation")}return Q},Dt=new WeakSet,ii=function(Q,St,Ot,Et){var U,Z;const p=[],a=this.thickness/2,k=Q*St+a,T=Q*Ot+a;for(const At of this.paths){const b=[],$=[];for(let et=0,vt=At.length;et<vt;et++){const[bt,yt,xt,It]=At[et],zt=Q*bt[0]+k,$t=Q*bt[1]+T,Kt=Q*yt[0]+k,Xt=Q*yt[1]+T,Qt=Q*xt[0]+k,te=Q*xt[1]+T,Zt=Q*It[0]+k,ie=Q*It[1]+T;et===0&&(b.push(zt,$t),$.push(zt,$t)),b.push(Kt,Xt,Qt,te,Zt,ie),$.push(Kt,Xt),et===vt-1&&$.push(Zt,ie)}p.push({bezier:X(U=Nt,Mt,is).call(U,b,Et,this.rotation),points:X(Z=Nt,Mt,is).call(Z,$,Et,this.rotation)})}return p},jt=new WeakSet,ns=function(){let Q=1/0,St=-1/0,Ot=1/0,Et=-1/0;for(const p of this.paths)for(const[a,k,T,U]of p){const Z=l.Util.bezierBoundingBox(...a,...k,...T,...U);Q=Math.min(Q,Z[0]),Ot=Math.min(Ot,Z[1]),St=Math.max(St,Z[2]),Et=Math.max(Et,Z[3])}return[Q,Ot,St,Et]},G=new WeakSet,Pe=function(){return t(this,h)?Math.ceil(this.thickness*this.parentScale):0},Tt=new WeakSet,ce=function(Q=!1){if(this.isEmpty())return;if(!t(this,h)){X(this,K,se).call(this);return}const St=X(this,jt,ns).call(this),Ot=X(this,G,Pe).call(this);it(this,D,Math.max(R.AnnotationEditor.MIN_SIZE,St[2]-St[0])),it(this,j,Math.max(R.AnnotationEditor.MIN_SIZE,St[3]-St[1]));const Et=Math.ceil(Ot+t(this,D)*this.scaleFactor),p=Math.ceil(Ot+t(this,j)*this.scaleFactor),[a,k]=this.parentDimensions;this.width=Et/a,this.height=p/k,this.setAspectRatio(Et,p);const T=this.translationX,U=this.translationY;this.translationX=-St[0],this.translationY=-St[1],X(this,Ut,le).call(this),X(this,K,se).call(this),it(this,A,Et),it(this,n,p),this.setDims(Et,p);const Z=Q?Ot/this.scaleFactor/2:0;this.translate(T-this.translationX-Z,U-this.translationY-Z)},I(Nt,gt),I(Nt,Mt),I(Nt,Wt),Yt(Nt,"_defaultColor",null),Yt(Nt,"_defaultOpacity",1),Yt(Nt,"_defaultThickness",1),Yt(Nt,"_l10nPromise"),Yt(Nt,"_type","ink");let ut=Nt;o.InkEditor=ut},(ot,o,at)=>{var j,D,m,O,B,M,S,v,h,_,w,me,A,be,r,xe,f,rs,P,ni,W,ri,E,as,nt,ke,u,ai;Object.defineProperty(o,"__esModule",{value:!0}),o.StampEditor=void 0;var l=at(1),R=at(4),ht=at(6),q=at(29);const Y=class Y extends R.AnnotationEditor{constructor(d){super({...d,name:"stampEditor"});I(this,w);I(this,A);I(this,r);I(this,f);I(this,P);I(this,W);I(this,E);I(this,nt);I(this,u);I(this,j,null);I(this,D,null);I(this,m,null);I(this,O,null);I(this,B,null);I(this,M,null);I(this,S,null);I(this,v,null);I(this,h,!1);I(this,_,!1);it(this,O,d.bitmapUrl),it(this,B,d.bitmapFile)}static get supportedTypes(){const d=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,l.shadow)(this,"supportedTypes",d.map(e=>`image/${e}`))}static get supportedTypesStr(){return(0,l.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(d){return this.supportedTypes.includes(d)}static paste(d,e){e.pasteEditor(l.AnnotationEditorType.STAMP,{bitmapFile:d.getAsFile()})}remove(){var d,e;t(this,D)&&(it(this,j,null),this._uiManager.imageManager.deleteId(t(this,D)),(d=t(this,M))==null||d.remove(),it(this,M,null),(e=t(this,S))==null||e.disconnect(),it(this,S,null)),super.remove()}rebuild(){if(!this.parent){t(this,D)&&X(this,r,xe).call(this);return}super.rebuild(),this.div!==null&&(t(this,D)&&X(this,r,xe).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(t(this,m)||t(this,j)||t(this,O)||t(this,B))}get isResizable(){return!0}render(){if(this.div)return this.div;let d,e;if(this.width&&(d=this.x,e=this.y),super.render(),this.div.hidden=!0,t(this,j)?X(this,f,rs).call(this):X(this,r,xe).call(this),this.width){const[s,c]=this.parentDimensions;this.setAt(d*s,e*c,this.width*s,this.height*c)}return this.div}static deserialize(d,e,s){if(d instanceof q.StampAnnotationElement)return null;const c=super.deserialize(d,e,s),{rect:C,bitmapUrl:y,bitmapId:N,isSvg:H}=d;N&&s.imageManager.isValidId(N)?it(c,D,N):it(c,O,y),it(c,h,H);const[K,ft]=c.pageDimensions;return c.width=(C[2]-C[0])/K,c.height=(C[3]-C[1])/ft,c}serialize(d=!1,e=null){if(this.isEmpty())return null;const s={annotationType:l.AnnotationEditorType.STAMP,bitmapId:t(this,D),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:t(this,h)};if(d)return s.bitmapUrl=X(this,nt,ke).call(this,!0),s;if(e===null)return s;e.stamps||(e.stamps=new Map);const c=t(this,h)?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(!e.stamps.has(t(this,D)))e.stamps.set(t(this,D),{area:c,serialized:s}),s.bitmap=X(this,nt,ke).call(this,!1);else if(t(this,h)){const C=e.stamps.get(t(this,D));c>C.area&&(C.area=c,C.serialized.bitmap.close(),C.serialized.bitmap=X(this,nt,ke).call(this,!1))}return s}};j=new WeakMap,D=new WeakMap,m=new WeakMap,O=new WeakMap,B=new WeakMap,M=new WeakMap,S=new WeakMap,v=new WeakMap,h=new WeakMap,_=new WeakMap,w=new WeakSet,me=function(d,e=!1){if(!d){this.remove();return}it(this,j,d.bitmap),e||(it(this,D,d.id),it(this,h,d.isSvg)),X(this,f,rs).call(this)},A=new WeakSet,be=function(){it(this,m,null),this._uiManager.enableWaiting(!1),t(this,M)&&this.div.focus()},r=new WeakSet,xe=function(){if(t(this,D)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(t(this,D)).then(e=>X(this,w,me).call(this,e,!0)).finally(()=>X(this,A,be).call(this));return}if(t(this,O)){const e=t(this,O);it(this,O,null),this._uiManager.enableWaiting(!0),it(this,m,this._uiManager.imageManager.getFromUrl(e).then(s=>X(this,w,me).call(this,s)).finally(()=>X(this,A,be).call(this)));return}if(t(this,B)){const e=t(this,B);it(this,B,null),this._uiManager.enableWaiting(!0),it(this,m,this._uiManager.imageManager.getFromFile(e).then(s=>X(this,w,me).call(this,s)).finally(()=>X(this,A,be).call(this)));return}const d=document.createElement("input");d.type="file",d.accept=Y.supportedTypesStr,it(this,m,new Promise(e=>{d.addEventListener("change",async()=>{if(!d.files||d.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const s=await this._uiManager.imageManager.getFromFile(d.files[0]);X(this,w,me).call(this,s)}e()}),d.addEventListener("cancel",()=>{this.remove(),e()})}).finally(()=>X(this,A,be).call(this))),d.click()},f=new WeakSet,rs=function(){const{div:d}=this;let{width:e,height:s}=t(this,j);const[c,C]=this.pageDimensions,y=.75;if(this.width)e=this.width*c,s=this.height*C;else if(e>y*c||s>y*C){const ft=Math.min(y*c/e,y*C/s);e*=ft,s*=ft}const[N,H]=this.parentDimensions;this.setDims(e*N/c,s*H/C),this._uiManager.enableWaiting(!1);const K=it(this,M,document.createElement("canvas"));d.append(K),d.hidden=!1,X(this,E,as).call(this,e,s),X(this,u,ai).call(this),t(this,_)||(this.parent.addUndoableEditor(this),it(this,_,!0))},P=new WeakSet,ni=function(d,e){var y;const[s,c]=this.parentDimensions;this.width=d/s,this.height=e/c,this.setDims(d,e),(y=this._initialOptions)!=null&&y.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,t(this,v)!==null&&clearTimeout(t(this,v)),it(this,v,setTimeout(()=>{it(this,v,null),X(this,E,as).call(this,d,e)},200))},W=new WeakSet,ri=function(d,e){const{width:s,height:c}=t(this,j);let C=s,y=c,N=t(this,j);for(;C>2*d||y>2*e;){const H=C,K=y;C>2*d&&(C=C>=16384?Math.floor(C/2)-1:Math.ceil(C/2)),y>2*e&&(y=y>=16384?Math.floor(y/2)-1:Math.ceil(y/2));const ft=new OffscreenCanvas(C,y);ft.getContext("2d").drawImage(N,0,0,H,K,0,0,C,y),N=ft.transferToImageBitmap()}return N},E=new WeakSet,as=function(d,e){d=Math.ceil(d),e=Math.ceil(e);const s=t(this,M);if(!s||s.width===d&&s.height===e)return;s.width=d,s.height=e;const c=t(this,h)?t(this,j):X(this,W,ri).call(this,d,e),C=s.getContext("2d");C.filter=this._uiManager.hcmFilter,C.drawImage(c,0,0,c.width,c.height,0,0,d,e)},nt=new WeakSet,ke=function(d){if(d){if(t(this,h)){const c=this._uiManager.imageManager.getSvgUrl(t(this,D));if(c)return c}const e=document.createElement("canvas");return{width:e.width,height:e.height}=t(this,j),e.getContext("2d").drawImage(t(this,j),0,0),e.toDataURL()}if(t(this,h)){const[e,s]=this.pageDimensions,c=Math.round(this.width*e*ht.PixelsPerInch.PDF_TO_CSS_UNITS),C=Math.round(this.height*s*ht.PixelsPerInch.PDF_TO_CSS_UNITS),y=new OffscreenCanvas(c,C);return y.getContext("2d").drawImage(t(this,j),0,0,t(this,j).width,t(this,j).height,0,0,c,C),y.transferToImageBitmap()}return structuredClone(t(this,j))},u=new WeakSet,ai=function(){it(this,S,new ResizeObserver(d=>{const e=d[0].contentRect;e.width&&e.height&&X(this,P,ni).call(this,e.width,e.height)})),t(this,S).observe(this.div)},Yt(Y,"_type","stamp");let ut=Y;o.StampEditor=ut}],__webpack_module_cache__={};function __w_pdfjs_require__(ot){var o=__webpack_module_cache__[ot];if(o!==void 0)return o.exports;var at=__webpack_module_cache__[ot]={exports:{}};return __webpack_modules__[ot](at,at.exports,__w_pdfjs_require__),at.exports}var __webpack_exports__={};return(()=>{var ot=__webpack_exports__;Object.defineProperty(ot,"__esModule",{value:!0}),Object.defineProperty(ot,"AbortException",{enumerable:!0,get:function(){return o.AbortException}}),Object.defineProperty(ot,"AnnotationEditorLayer",{enumerable:!0,get:function(){return ht.AnnotationEditorLayer}}),Object.defineProperty(ot,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return o.AnnotationEditorParamsType}}),Object.defineProperty(ot,"AnnotationEditorType",{enumerable:!0,get:function(){return o.AnnotationEditorType}}),Object.defineProperty(ot,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return q.AnnotationEditorUIManager}}),Object.defineProperty(ot,"AnnotationLayer",{enumerable:!0,get:function(){return ut.AnnotationLayer}}),Object.defineProperty(ot,"AnnotationMode",{enumerable:!0,get:function(){return o.AnnotationMode}}),Object.defineProperty(ot,"CMapCompressionType",{enumerable:!0,get:function(){return o.CMapCompressionType}}),Object.defineProperty(ot,"FeatureTest",{enumerable:!0,get:function(){return o.FeatureTest}}),Object.defineProperty(ot,"GlobalWorkerOptions",{enumerable:!0,get:function(){return j.GlobalWorkerOptions}}),Object.defineProperty(ot,"ImageKind",{enumerable:!0,get:function(){return o.ImageKind}}),Object.defineProperty(ot,"InvalidPDFException",{enumerable:!0,get:function(){return o.InvalidPDFException}}),Object.defineProperty(ot,"MissingPDFException",{enumerable:!0,get:function(){return o.MissingPDFException}}),Object.defineProperty(ot,"OPS",{enumerable:!0,get:function(){return o.OPS}}),Object.defineProperty(ot,"PDFDataRangeTransport",{enumerable:!0,get:function(){return at.PDFDataRangeTransport}}),Object.defineProperty(ot,"PDFDateString",{enumerable:!0,get:function(){return l.PDFDateString}}),Object.defineProperty(ot,"PDFWorker",{enumerable:!0,get:function(){return at.PDFWorker}}),Object.defineProperty(ot,"PasswordResponses",{enumerable:!0,get:function(){return o.PasswordResponses}}),Object.defineProperty(ot,"PermissionFlag",{enumerable:!0,get:function(){return o.PermissionFlag}}),Object.defineProperty(ot,"PixelsPerInch",{enumerable:!0,get:function(){return l.PixelsPerInch}}),Object.defineProperty(ot,"PromiseCapability",{enumerable:!0,get:function(){return o.PromiseCapability}}),Object.defineProperty(ot,"RenderingCancelledException",{enumerable:!0,get:function(){return l.RenderingCancelledException}}),Object.defineProperty(ot,"SVGGraphics",{enumerable:!0,get:function(){return at.SVGGraphics}}),Object.defineProperty(ot,"UnexpectedResponseException",{enumerable:!0,get:function(){return o.UnexpectedResponseException}}),Object.defineProperty(ot,"Util",{enumerable:!0,get:function(){return o.Util}}),Object.defineProperty(ot,"VerbosityLevel",{enumerable:!0,get:function(){return o.VerbosityLevel}}),Object.defineProperty(ot,"XfaLayer",{enumerable:!0,get:function(){return D.XfaLayer}}),Object.defineProperty(ot,"build",{enumerable:!0,get:function(){return at.build}}),Object.defineProperty(ot,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return o.createValidAbsoluteUrl}}),Object.defineProperty(ot,"getDocument",{enumerable:!0,get:function(){return at.getDocument}}),Object.defineProperty(ot,"getFilenameFromUrl",{enumerable:!0,get:function(){return l.getFilenameFromUrl}}),Object.defineProperty(ot,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return l.getPdfFilenameFromUrl}}),Object.defineProperty(ot,"getXfaPageViewport",{enumerable:!0,get:function(){return l.getXfaPageViewport}}),Object.defineProperty(ot,"isDataScheme",{enumerable:!0,get:function(){return l.isDataScheme}}),Object.defineProperty(ot,"isPdfFile",{enumerable:!0,get:function(){return l.isPdfFile}}),Object.defineProperty(ot,"loadScript",{enumerable:!0,get:function(){return l.loadScript}}),Object.defineProperty(ot,"normalizeUnicode",{enumerable:!0,get:function(){return o.normalizeUnicode}}),Object.defineProperty(ot,"renderTextLayer",{enumerable:!0,get:function(){return R.renderTextLayer}}),Object.defineProperty(ot,"setLayerDimensions",{enumerable:!0,get:function(){return l.setLayerDimensions}}),Object.defineProperty(ot,"shadow",{enumerable:!0,get:function(){return o.shadow}}),Object.defineProperty(ot,"updateTextLayer",{enumerable:!0,get:function(){return R.updateTextLayer}}),Object.defineProperty(ot,"version",{enumerable:!0,get:function(){return at.version}});var o=__w_pdfjs_require__(1),at=__w_pdfjs_require__(2),l=__w_pdfjs_require__(6),R=__w_pdfjs_require__(26),ht=__w_pdfjs_require__(27),q=__w_pdfjs_require__(5),ut=__w_pdfjs_require__(29),j=__w_pdfjs_require__(14),D=__w_pdfjs_require__(32)})(),__webpack_exports__})())})(pdf);var pdfExports=pdf.exports;const _sfc_main=defineComponent({emits:{close:()=>!0},props:{pdfDisplayType:{default:"pagination",type:String},show:{required:!0,type:Boolean},src:{required:!1,type:String},type:{required:!0,type:String}},name:"sb-file-preview",components:{"sb-modal":Modal},data(){return{isLoading:!1,localPdf:{currentPage:1,pages:[],scale:1.5},localSrc:null}},computed:{angleLeft(){return angleLeft()},angleRight(){return angleRight()}},methods:{handleClose(){this.localSrc=null,this.$emit("close")},handleControlClick(ot){const o=this.localPdf.currentPage+ot;if(this.pdfDisplayType==="scroll"){const at=this.$refs[`pdf-img-${o-1}`];at[0]&&at[0].scrollIntoView({behavior:"smooth"})}else this.localPdf.currentPage=o},handleLoadSrc(){setTimeout(()=>{this.isLoading=!1},300)},async handlePDF(){const ot=this;await pdfExports.getDocument(this.localSrc).promise.then(async o=>{const at=ot.$refs["pdf-canvas"],l=o.numPages;if(at){const R=at.getContext("2d",{willReadFrequently:!0});for(let ht=0;ht<l;ht++)await o.getPage(ht+1).then(async q=>{const ut=q.getViewport({scale:ot.localPdf.scale});at.height=ut.height,at.width=ut.width,await q.render({canvasContext:R,viewport:ut}).promise.then(()=>{ot.localPdf.pages.push(at.toDataURL())})})}}).catch(o=>{this.isLoading=!1,console.error(o)})},handlePdfScroll(){const ot=[...this.localPdf.pages];for(let o=0;o<ot.length;o++){const at=this.$refs[`pdf-img-${o}`];if(this.isInViewPort(at))this.localPdf.currentPage=o+1;else break}},isInViewPort(ot){const o=this.$refs["pdf-images-wrapper"];if(ot[0]&&o){const at=ot[0].clientHeight,l=ot[0].offsetTop,R=o.scrollTop+o.clientHeight;return at*.55+l<=R}return!1}},watch:{show(ot){ot&&(this.isLoading=!0,this.localSrc=this.src,this.type==="pdf"&&(this.localPdf={currentPage:1,pages:[],scale:1.5},this.$nextTick(()=>this.handlePDF())))}},setup(){pdfExports.GlobalWorkerOptions.workerSrc=`//unpkg.com/pdfjs-dist@${pdfExports.version}/build/pdf.worker.min.js`}}),filePreview_vue_vue_type_style_index_0_lang="",_hoisted_1={key:0,class:"loading"},_hoisted_2=createBaseVNode("div",{class:"skeleton"},null,-1),_hoisted_3=[_hoisted_2],_hoisted_4=["src"],_hoisted_5=["src"],_hoisted_6={class:"sb-hidden",ref:"pdf-canvas"},_hoisted_7={class:"pdf-viewer"},_hoisted_8=["src"],_hoisted_9={class:"control"},_hoisted_10={class:"page-state"},_hoisted_11={class:"current"},_hoisted_12=createBaseVNode("span",null,"/",-1),_hoisted_13={class:"total"},_hoisted_14=["src"];function _sfc_render(ot,o,at,l,R,ht){const q=resolveComponent("sb-modal");return openBlock(),createBlock(q,mergeProps({container:"fit-content",id:"file-preview-modal",show:ot.show,onClose:ot.handleClose},{...ot.$attrs}),{default:withCtx(()=>[createBaseVNode("div",{class:normalizeClass(["file-preview-wrapper",[ot.type]])},[ot.isLoading?(openBlock(),createElementBlock("div",_hoisted_1,_hoisted_3)):createCommentVNode("",!0),ot.localSrc&&ot.localSrc!==""?(openBlock(),createElementBlock("div",{key:1,class:"content",style:normalizeStyle({display:ot.isLoading?"none":""})},[ot.type==="audio"?(openBlock(),createElementBlock("audio",{key:0,autoplay:"",controls:"",class:"iframe audio",src:ot.localSrc,onLoadeddata:o[0]||(o[0]=(...ut)=>ot.handleLoadSrc&&ot.handleLoadSrc(...ut))},null,40,_hoisted_4)):createCommentVNode("",!0),ot.type==="image"?(openBlock(),createElementBlock("img",{key:1,class:"sb-w-full",src:ot.localSrc,onLoad:o[1]||(o[1]=(...ut)=>ot.handleLoadSrc&&ot.handleLoadSrc(...ut))},null,40,_hoisted_5)):createCommentVNode("",!0),ot.type==="pdf"?(openBlock(),createElementBlock(Fragment,{key:2},[createBaseVNode("canvas",_hoisted_6,null,512),createBaseVNode("div",_hoisted_7,[createBaseVNode("div",mergeProps({class:"image-wrapper",ref:"pdf-images-wrapper"},{...ot.pdfDisplayType==="scroll"&&{onScroll:ot.handlePdfScroll}}),[(openBlock(!0),createElementBlock(Fragment,null,renderList(ot.localPdf.pages,(ut,j)=>(openBlock(),createElementBlock("img",mergeProps({key:`pdf-img-${j}`,ref_for:!0,ref:`pdf-img-${j}`,src:ut,style:{...ot.pdfDisplayType==="pagination"&&{display:ot.localPdf.currentPage-1!==j?"none":""}}},{...j===ot.localPdf.pages.length-1&&{onLoad:ot.handleLoadSrc}}),null,16,_hoisted_8))),128))],16),createBaseVNode("div",_hoisted_9,[(openBlock(),createBlock(resolveDynamicComponent(ot.angleLeft),{class:normalizeClass(["icon",{disabled:ot.localPdf.currentPage<2}]),onClick:o[2]||(o[2]=ut=>ot.handleControlClick(-1))},null,8,["class"])),createBaseVNode("div",_hoisted_10,[createBaseVNode("span",_hoisted_11,toDisplayString(ot.localPdf.currentPage),1),_hoisted_12,createBaseVNode("span",_hoisted_13,toDisplayString(ot.localPdf.pages.length),1)]),(openBlock(),createBlock(resolveDynamicComponent(ot.angleRight),{class:normalizeClass(["icon",{disabled:ot.localPdf.currentPage===ot.localPdf.pages.length}]),onClick:o[3]||(o[3]=ut=>ot.handleControlClick(1))},null,8,["class"]))])])],64)):createCommentVNode("",!0),ot.type==="video"?(openBlock(),createElementBlock("iframe",{key:3,allowfullscreen:"",allow:"autoplay; fullscreen; picture-in-picture; xr-spatial-tracking; clipboard-write",class:"iframe video",src:ot.localSrc,onLoad:o[4]||(o[4]=(...ut)=>ot.handleLoadSrc&&ot.handleLoadSrc(...ut))},null,40,_hoisted_14)):createCommentVNode("",!0)],4)):createCommentVNode("",!0)],2)]),_:1},16,["show","onClose"])}const FilePreview=_export_sfc(_sfc_main,[["render",_sfc_render]]);_sfc_main.__docgenInfo={displayName:"sb-file-preview",exportName:"default",description:"",tags:{},props:[{name:"pdfDisplayType",values:["pagination","scroll"],type:{name:"string"},defaultValue:{func:!1,value:"'pagination'"}},{name:"show",type:{name:"boolean"},required:!0},{name:"src",type:{name:"string"},required:!1},{name:"type",values:["image","pdf","video","audio"],type:{name:"string"},required:!0}],events:[{name:"close"}],sourceFiles:["/Users/edgar/Documents/private-projects/vue-base-lib/src/components/file-preview/file-preview.vue"]};const DummyPDF=""+new URL("dummy-0e6575ea.pdf",import.meta.url).href,{UPDATE_STORY_ARGS}=__STORYBOOK_MODULE_CORE_EVENTS__,meta={title:"Components/File Preview",component:FilePreview,tags:["autodocs"],argTypes:{onClose:{action:"click",control:!1,description:"Fired when Modal will close",table:{category:"events",type:{summary:"() => void"}},type:"function"},pdfDisplayType:{control:"select",description:"PDF Preview type",options:["pagination","scroll"]},show:{control:"boolean",description:"Show or Hide File Preview"},src:{control:"text",description:"File URI"},type:{control:"select",description:"File Type",options:["audio","image","pdf","video"]}},args:{show:!1},decorators:[(ot,o)=>(delete o.args.close,o.args.onClose=()=>{window.__STORYBOOK_ADDONS_CHANNEL__.emit(UPDATE_STORY_ARGS,{storyId:o.id,updatedArgs:{show:!1}})},ot())],parameters:{docs:{controls:{exclude:["close"],sort:"requiredFirst"}}},render:(ot,{id:o})=>({components:{Button,FilePreview},setup(){return{args:ot,onClickButton:()=>{window.__STORYBOOK_ADDONS_CHANNEL__.emit(UPDATE_STORY_ARGS,{storyId:o,updatedArgs:{show:!0}})}}},template:'<div style="height: 5rem; display: flex; justify-content: center; align-items: center;"><FilePreview v-bind="args" /><Button color="accent" @click="onClickButton">Show Modal</Button></div>'})},Audio={args:{src:"http://commondatastorage.googleapis.com/codeskulptor-demos/DDR_assets/Kangaroo_MusiQue_-_The_Neverwritten_Role_Playing_Game.mp3",type:"audio"}},Image$1={args:{src:"https://images.hdqwalls.com/wallpapers/vue-js-kk.jpg",type:"image"}},PDF={args:{src:DummyPDF,type:"pdf"}},PDFScroll={args:{pdfDisplayType:"scroll",src:DummyPDF,type:"pdf"}},Video={args:{src:"http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4",type:"video"}};var cs,hs,ds;Audio.parameters={...Audio.parameters,docs:{...(cs=Audio.parameters)==null?void 0:cs.docs,source:{originalSource:`{
  args: {
    src: 'http://commondatastorage.googleapis.com/codeskulptor-demos/DDR_assets/Kangaroo_MusiQue_-_The_Neverwritten_Role_Playing_Game.mp3',
    type: 'audio'
  }
}`,...(ds=(hs=Audio.parameters)==null?void 0:hs.docs)==null?void 0:ds.source}}};var us,fs,ps;Image$1.parameters={...Image$1.parameters,docs:{...(us=Image$1.parameters)==null?void 0:us.docs,source:{originalSource:`{
  args: {
    src: 'https://images.hdqwalls.com/wallpapers/vue-js-kk.jpg',
    type: 'image'
  }
}`,...(ps=(fs=Image$1.parameters)==null?void 0:fs.docs)==null?void 0:ps.source}}};var gs,ms,bs;PDF.parameters={...PDF.parameters,docs:{...(gs=PDF.parameters)==null?void 0:gs.docs,source:{originalSource:`{
  args: {
    src: DummyPDF,
    type: 'pdf'
  }
}`,...(bs=(ms=PDF.parameters)==null?void 0:ms.docs)==null?void 0:bs.source}}};var _s,As,ys;PDFScroll.parameters={...PDFScroll.parameters,docs:{...(_s=PDFScroll.parameters)==null?void 0:_s.docs,source:{originalSource:`{
  args: {
    pdfDisplayType: 'scroll',
    src: DummyPDF,
    type: 'pdf'
  }
}`,...(ys=(As=PDFScroll.parameters)==null?void 0:As.docs)==null?void 0:ys.source}}};var vs,Ss,Es;Video.parameters={...Video.parameters,docs:{...(vs=Video.parameters)==null?void 0:vs.docs,source:{originalSource:`{
  args: {
    src: 'http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4',
    type: 'video'
  }
}`,...(Es=(Ss=Video.parameters)==null?void 0:Ss.docs)==null?void 0:Es.source}}};const __namedExportsOrder=["Audio","Image","PDF","PDFScroll","Video"];export{Audio,Image$1 as Image,PDF,PDFScroll,Video,__namedExportsOrder,meta as default};

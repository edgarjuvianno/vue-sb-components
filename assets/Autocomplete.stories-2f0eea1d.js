import{e as V,o as r,g as i,F as v,G as U,n as R,k as M,j,m as p,v as K,s as g,H as O,t as H,q as y,f as S,u as z,T as G}from"./vue.esm-bundler-38397e95.js";import{P as Y}from"./progress-circular-90599950.js";import{T as J}from"./form-input-e5bf6945.js";import{_ as N}from"./_plugin-vue_export-helper-c27b6911.js";import{r as $}from"./helper-91f3687e.js";const W=V({emits:{select:e=>!0},props:{activeOption:{required:!0,type:Number},isLoading:{required:!1,type:Boolean},list:{required:!0,type:Object},loadingText:{default:"Loading...",type:String},term:{required:!0,type:String}},name:"sb-form-autocomplete-option",methods:{doSelect(e){this.isLoading||this.$emit("select",e.value)},renderOpt({label:e}){const t=e.toLowerCase(),o=this.term.toLowerCase(),s=t.indexOf(o),n=e.substring(s,s+o.length);return e.substring(0,s)+`<b>${n}</b>`+e.substring(s+o.length)}}}),Q=["onClick"],X=["innerHTML"],Z={key:1,class:"loading-text"};function x(e,t,o,s,n,l){return r(),i(v,null,[e.isLoading?p("",!0):(r(!0),i(v,{key:0},U(e.list,(d,c)=>(r(),i("div",{class:R(["option",{focus:e.activeOption===c}]),key:`opt-${c}-${d.value}`,onClick:M(b=>e.doSelect(d),["stop"])},[j("span",{innerHTML:e.renderOpt(d)},null,8,X)],10,Q))),128)),e.isLoading?(r(),i("div",Z,K(e.loadingText),1)):p("",!0)],64)}const ee=N(W,[["render",x]]);W.__docgenInfo={displayName:"sb-form-autocomplete-option",exportName:"default",description:"",tags:{},props:[{name:"activeOption",type:{name:"number"},required:!0},{name:"isLoading",type:{name:"boolean"},required:!1},{name:"list",type:{name:"IAutocompleteItem[]"},required:!0},{name:"loadingText",type:{name:"string"},defaultValue:{func:!1,value:"'Loading...'"}},{name:"term",type:{name:"string"},required:!0}],events:[{name:"select",type:{names:["undefined"]}}],sourceFiles:["/Users/edgar/Documents/private-projects/vue-base-lib/src/components/form-autocomplete/__option.vue"]};const _=V({emits:{"update:modelValue":e=>!0,change:e=>!0,input:e=>!0},props:{disabled:{required:!1,type:Boolean},errorMessage:{required:!1,type:[String,Function]},flat:{required:!1,type:Boolean},isError:{required:!1,type:Boolean},isLoading:{required:!1,type:Boolean},label:{required:!1,type:String},list:{required:!1,type:Object},loadingText:{default:"Loading...",type:String},modelValue:{required:!1,type:String},placeholder:{required:!1,type:String},readOnly:{required:!1,type:Boolean},required:{required:!1,type:Boolean},value:{required:!1,type:String}},name:"sb-form-autocomplete",components:{OptionComponent:ee,"sb-circular":Y,"sb-input":J},data(){return{activeOption:-1,elem:null,icon:{onClick:null,placement:"append"},isFocus:!1,isOpen:!1,localList:[],localTerm:"",optWrapperStyles:{left:"0",top:"0",width:"0"},parentWithScroll:null}},methods:{doSelect(e){this.isOpen=!1,this.handleRemoveFocus(),this.handleUpdateModel(e)},handleArrowEvent(e,t){if(this.isOpen){t.preventDefault();const o=document.querySelector(`[data-target="options-${this.$.uid}"]`);if(o){const s=o.children;let n=this.activeOption+e;this.activeOption<1&&n<0?n=s.length-1:this.activeOption===s.length-1&&n>s.length-1&&(n=0);const l=s.item(n);l==null||l.scrollIntoView(!1),this.activeOption=n}}},handleBackdropClick(){this.handleRemoveFocus(),this.isOpen=!1},handleFilterList(e){this.localTerm=e,e=e.replace(/^\s?|\s?$/g,"").toLowerCase(),this.localList=[...this.list||[]].filter(t=>t.label.toLowerCase().includes(e))},handleInput(e){const t=e.target.value;this.handleFilterList(t),this.handleUpdateModel(t),t!=null&&t.length?(this.$emit("input",t),this.handleOpen()):this.isOpen=!1},handleKeyEvent(e){if(e.key==="ArrowDown"||e.key==="ArrowUp"){const t=e.key==="ArrowDown"?1:-1;this.isOpen||this.handleOpen(),this.$nextTick(()=>this.handleArrowEvent(t,e))}else if(e.key==="Enter"){if(this.isOpen){e.preventDefault(),e.stopPropagation();const t=document.querySelectorAll(`[data-target="options-${this.$.uid}"] .option`),o=Array.from(t).findIndex(s=>s.classList.contains("focus")&&!s.classList.contains("selected"));o>-1&&this.doSelect(this.localList[o].value)}}else(e.key==="Escape"||e.key==="Tab")&&(this.isOpen=!1,this.handleRemoveFocus())},handleOpen(){!this.readOnly&&!this.disabled&&!this.isOpen&&(this.isOpen=!0,this.$nextTick(()=>{this.setOptionsPosition()}))},handleParentBlur(e){const t=e.target,o=e.relatedTarget;t.contains(o)||(this.isOpen=!1,this.handleRemoveFocus())},handleParentFocus(){const t=this.$el.getElementsByTagName("input");if((t==null?void 0:t.length)>0){const o=t.item(0);o==null||o.focus()}this.isFocus=!0},handleParentScroll(e){const t=$(this.$el);this.parentWithScroll&&this.parentWithScroll.removeEventListener("scroll",()=>{this.setOptionsPosition()}),t&&(e?t.addEventListener("scroll",()=>{this.setOptionsPosition()}):t.removeEventListener("scroll",()=>{this.setOptionsPosition()})),this.$nextTick(()=>{this.parentWithScroll=t})},handleRemoveFocus(){this.isFocus=!1;const e=this.$el;e.blur();const t=e.getElementsByTagName("input");if((t==null?void 0:t.length)>0){const o=t.item(0);o==null||o.blur()}},handleUpdateModel(e){this.$emit("update:modelValue",e),this.$emit("change",e)},setOptionsPosition(){var e;if(this.elem){const t=this.elem.getBoundingClientRect(),o=(e=this.$refs["options-wrapper"])==null?void 0:e.getBoundingClientRect();if(o)return document.body.getBoundingClientRect().height-(t.height+t.y)<=o.height?this.optWrapperStyles={left:`${t.x}px`,top:`${t.y-6-o.height}px`,width:`${t.width+1}px`}:this.optWrapperStyles={left:`${t.x}px`,top:`${t.y+t.height}px`,width:`${t.width+1}px`}}}},watch:{isOpen(e){this.handleParentScroll(e),e||(this.activeOption=-1,this.handleFilterList(""))},list:{deep:!0,handler(e){e&&(this.localList=[...e])},immediate:!0},localList:{deep:!0,handler(){this.$nextTick(()=>{this.setOptionsPosition()})}}},mounted(){const e=this.$refs["input-wrapper"].$el.children,t=Array.from(e).find(o=>o.classList.contains("input-group"));t&&(this.elem=t),this.elem&&this.setOptionsPosition(),this.parentWithScroll=$(this.$el)},unmounted(){this.parentWithScroll&&this.parentWithScroll.removeEventListener("scroll",()=>{this.setOptionsPosition()})}});const te=["data-target","tabindex"],oe=["data-target"];function se(e,t,o,s,n,l){const d=g("sb-circular"),c=g("sb-input"),b=g("OptionComponent");return r(),i("div",y({class:["autocomplete-wrapper",{expanded:e.isOpen,loading:e.isLoading}],"data-target":`autocomplete-${e.$.uid}`,tabindex:!e.disabled&&!e.readOnly?0:-1,ref:"autocomplete-wrapper"},{...e.$attrs},{onBlur:t[1]||(t[1]=(...a)=>e.handleParentBlur&&e.handleParentBlur(...a)),onFocus:t[2]||(t[2]=(...a)=>e.handleParentFocus&&e.handleParentFocus(...a)),onKeydown:t[3]||(t[3]=(...a)=>e.handleKeyEvent&&e.handleKeyEvent(...a))}),[O(c,y({"error-message":e.errorMessage,icon:e.icon,"is-error":e.isError,"is-focus":e.isFocus,label:e.label,placeholder:e.placeholder,required:e.required,variant:e.flat?"flat":"default",ref:"input-wrapper"},{disabled:e.disabled,modelValue:e.modelValue,readOnly:e.readOnly,value:e.value},{onBlur:e.handleRemoveFocus,onInput:e.handleInput}),{"icon-slot":H(()=>[e.isLoading?(r(),S(d,{key:0,indeterminate:"",size:20})):p("",!0)]),_:1},16,["error-message","icon","is-error","is-focus","label","placeholder","required","variant","onBlur","onInput"]),(r(),S(G,{to:"body"},[e.isOpen?(r(),i("div",{key:0,class:"sb-autocomplete-backdrop",onClick:t[0]||(t[0]=M((...a)=>e.handleBackdropClick&&e.handleBackdropClick(...a),["stop"]))})):p("",!0),e.isOpen?(r(),i("div",{key:1,class:R(["sb-autocomplete-result-wrapper",{expanded:e.isOpen}]),"data-target":`options-${e.$.uid}`,style:z(e.optWrapperStyles),ref:"options-wrapper"},[O(b,y({"active-option":e.activeOption,"is-loading":e.isLoading,list:e.localList,term:e.localTerm},{loadingText:e.loadingText},{onSelect:e.doSelect}),null,16,["active-option","is-loading","list","term","onSelect"])],14,oe)):p("",!0)]))],16,te)}const q=N(_,[["render",se]]);_.__docgenInfo={displayName:"sb-form-autocomplete",exportName:"default",description:"",tags:{},props:[{name:"disabled",type:{name:"boolean"},required:!1},{name:"errorMessage",type:{name:"string|func"},required:!1},{name:"flat",type:{name:"boolean"},required:!1},{name:"isError",type:{name:"boolean"},required:!1},{name:"isLoading",type:{name:"boolean"},required:!1},{name:"label",type:{name:"string"},required:!1},{name:"list",type:{name:"IAutocompleteItem[]"},required:!1},{name:"loadingText",type:{name:"string"},defaultValue:{func:!1,value:"'Loading...'"}},{name:"modelValue",type:{name:"String | null"},required:!1},{name:"placeholder",type:{name:"string"},required:!1},{name:"readOnly",type:{name:"boolean"},required:!1},{name:"required",type:{name:"boolean"},required:!1},{name:"value",type:{name:"String | null"},required:!1}],events:[{name:"update:modelValue",type:{names:["undefined"]}},{name:"change",type:{names:["undefined"]}},{name:"input",type:{names:["undefined"]}}],sourceFiles:["/Users/edgar/Documents/private-projects/vue-base-lib/src/components/form-autocomplete/form-autocomplete.vue"]};const{UPDATE_STORY_ARGS:ne}=__STORYBOOK_MODULE_CORE_EVENTS__,pe={title:"Forms/Autocomplete",component:q,tags:["autodocs"],argTypes:{"onUpdate:modelValue":{action:"change",control:!1,description:"This event fired when users finish typing",table:{category:"events",type:{summary:"(selected: any) => void"}},type:"function"},disabled:{control:"boolean",description:"Is Autocomplete disabled"},errorMessage:{control:"text",description:"Autocomplete error message"},flat:{control:"boolean",description:"Is Autocomplete type flat or not"},isError:{control:"boolean",description:"Is Autocomplete validation error"},isLoading:{control:"boolean",description:"Show loader"},label:{control:"text",description:"Autocomplete label"},list:{control:"object",description:"Autocomplete items"},loadingText:{control:"text",description:"Text to show when loading"},modelValue:{control:"object",description:"Autocomplete selected value"},onChange:{action:"change",control:!1,description:"This event fired when users finish typing",table:{category:"events",type:{summary:"(selected: any) => void"}},type:"function"},onInput:{action:"change",control:!1,description:"This event fired when users finish typing",table:{category:"events",type:{summary:"(selected: any) => void"}},type:"function"},placeholder:{control:"text",description:"Dropdown placeholder"},readOnly:{control:"boolean",description:"Is Dropdown read-only"},required:{control:"boolean",description:"Is Dropdown required"},value:{control:"object",description:"Autocomplete selected value"}},args:{label:"Some Autocomplete",list:[{label:"red",value:"red"},{label:"green",value:"green"},{label:"blue",value:"blue"},{label:"cyan",value:"cyan"},{label:"magenta",value:"magenta"},{label:"yellow",value:"yellow"},{label:"black",value:"black"}],modelValue:null},decorators:[(e,t)=>(delete t.args.onChange,delete t.args.onInput,delete t.args["onUpdate:modelValue"],t.args.onChange=o=>{window.__STORYBOOK_ADDONS_CHANNEL__.emit(ne,{storyId:t.id,updatedArgs:{modelValue:o}})},e())],parameters:{docs:{controls:{exclude:["change","input","update:modelValue"],sort:"requiredFirst"}}},render:e=>({components:{Autocomplete:q},setup(){return{args:e}},template:'<div style="height: 27rem; display: flex; justify-content: center; align-items: start;"><Autocomplete style="min-width: 15rem;" v-bind="args" /></div>'})},u={args:{}},m={args:{disabled:!0}},h={args:{readOnly:!0}},f={args:{errorMessage:"Some Error Message",isError:!0}};var w,L,T;u.parameters={...u.parameters,docs:{...(w=u.parameters)==null?void 0:w.docs,source:{originalSource:`{
  args: {}
}`,...(T=(L=u.parameters)==null?void 0:L.docs)==null?void 0:T.source}}};var k,E,A;m.parameters={...m.parameters,docs:{...(k=m.parameters)==null?void 0:k.docs,source:{originalSource:`{
  args: {
    disabled: true
  }
}`,...(A=(E=m.parameters)==null?void 0:E.docs)==null?void 0:A.source}}};var C,B,F;h.parameters={...h.parameters,docs:{...(C=h.parameters)==null?void 0:C.docs,source:{originalSource:`{
  args: {
    readOnly: true
  }
}`,...(F=(B=h.parameters)==null?void 0:B.docs)==null?void 0:F.source}}};var I,P,D;f.parameters={...f.parameters,docs:{...(I=f.parameters)==null?void 0:I.docs,source:{originalSource:`{
  args: {
    errorMessage: 'Some Error Message',
    isError: true
  }
}`,...(D=(P=f.parameters)==null?void 0:P.docs)==null?void 0:D.source}}};const ce=["Default","Disabled","ReadOnly","Error"];export{u as Default,m as Disabled,f as Error,h as ReadOnly,ce as __namedExportsOrder,pe as default};
